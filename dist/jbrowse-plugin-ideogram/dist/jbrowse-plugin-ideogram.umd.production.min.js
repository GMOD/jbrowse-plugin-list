!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("@material-ui/core/utils"),require("@jbrowse/core/Plugin"),require("@jbrowse/core/util"),require("@jbrowse/core/pluggableElementTypes/ViewType"),require("@jbrowse/core/pluggableElementTypes/WidgetType"),require("mobx-react"),require("@jbrowse/core/configuration"),require("@material-ui/core"),require("@jbrowse/core/ui"),require("@jbrowse/core/util/io"),require("@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail"),require("@jbrowse/core/util/types/mst"),require("mobx-state-tree"),require("@material-ui/lab"),require("@material-ui/core/SvgIcon")):"function"==typeof define&&define.amd?define(["exports","react","@material-ui/core/utils","@jbrowse/core/Plugin","@jbrowse/core/util","@jbrowse/core/pluggableElementTypes/ViewType","@jbrowse/core/pluggableElementTypes/WidgetType","mobx-react","@jbrowse/core/configuration","@material-ui/core","@jbrowse/core/ui","@jbrowse/core/util/io","@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail","@jbrowse/core/util/types/mst","mobx-state-tree","@material-ui/lab","@material-ui/core/SvgIcon"],e):e((t=t||self).JBrowsePluginIdeogram={},t.JBrowseExports.react,t.JBrowseExports["@material-ui/core/utils"],t.JBrowseExports["@jbrowse/core/Plugin"],t.JBrowseExports["@jbrowse/core/util"],t.JBrowseExports["@jbrowse/core/pluggableElementTypes/ViewType"],t.JBrowseExports["@jbrowse/core/pluggableElementTypes/WidgetType"],t.JBrowseExports["mobx-react"],t.JBrowseExports["@jbrowse/core/configuration"],t.JBrowseExports["@material-ui/core"],t.JBrowseExports["@jbrowse/core/ui"],t.JBrowseExports["@jbrowse/core/util/io"],t.JBrowseExports["@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail"],t.JBrowseExports["@jbrowse/core/util/types/mst"],t.JBrowseExports["mobx-state-tree"],t.JBrowseExports["@material-ui/lab"],t.JBrowseExports["@material-ui/core/SvgIcon"])}(this,(function(t,e,n,r,o,i,a,s,l,c,u,h,f,d,m,p,g){"use strict";var y="default"in e?e.default:e;n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;var v="default"in s?s.default:s,b="default"in l?l.default:l,w="default"in c?c.default:c;function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function A(t,e,n,r,o,i,a){try{var s=t[i](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function C(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){A(i,r,o,a,s,"next",t)}function s(t){A(i,r,o,a,s,"throw",t)}a(void 0)}))}}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E(t);if(e){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g;var I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function F(t,e){return t(e={exports:{}},e.exports),e.exports}var j=F((function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0}));O(j);var B=F((function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}));O(B);var D=F((function(t){var e=B.default;function n(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(n=function(t){return t?r:e})(t)}t.exports=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var o=n(r);if(o&&o.has(t))return o.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var l=a?Object.getOwnPropertyDescriptor(t,s):null;l&&(l.get||l.set)?Object.defineProperty(i,s,l):i[s]=t[s]}return i.default=t,o&&o.set(t,i),i},t.exports.default=t.exports,t.exports.__esModule=!0}));O(D);var R=F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return n.createSvgIcon}})}));O(R);var z=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}),"Pause");e.default=r}))),W=F((function(t){var e=function(t){var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=Object.create((e&&e.prototype instanceof h?e:h).prototype),i=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,i),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u={};function h(){}function f(){}function d(){}var m={};s(m,o,(function(){return this}));var p=Object.getPrototypeOf,g=p&&p(p(C([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=h.prototype=Object.create(m);function v(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,s){var l=c(t[o],t,i);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(l.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function C(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},v(b.prototype),s(b.prototype,i,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new b(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=C,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})),H="http://www.w3.org/1999/xhtml",G={svg:"http://www.w3.org/2000/svg",xhtml:H,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),G.hasOwnProperty(e)?{space:G[e],local:t}:t}function q(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===H&&e.documentElement.namespaceURI===H?e.createElement(t):e.createElementNS(n,t)}}function V(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Y(t){var e=$(t);return(e.local?V:q)(e)}function X(){}function U(t){return null==t?X:function(){return this.querySelector(t)}}function J(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Q(){return[]}function K(t){return null==t?Q:function(){return this.querySelectorAll(t)}}function Z(t){return function(){return this.matches(t)}}function tt(t){return function(e){return e.matches(t)}}var et=Array.prototype.find;function nt(){return this.firstElementChild}var rt=Array.prototype.filter;function ot(){return this.children}function it(t){return new Array(t.length)}function at(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function st(t){return function(){return t}}function lt(t,e,n,r,o,i){for(var a,s=0,l=e.length,c=i.length;s<c;++s)(a=e[s])?(a.__data__=i[s],r[s]=a):n[s]=new at(t,i[s]);for(;s<l;++s)(a=e[s])&&(o[s]=a)}function ct(t,e,n,r,o,i,a){var s,l,c,u=new Map,h=e.length,f=i.length,d=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(d[s]=c=a.call(l,l.__data__,s,e)+"",u.has(c)?o[s]=l:u.set(c,l));for(s=0;s<f;++s)c=a.call(t,i[s],s,i)+"",(l=u.get(c))?(r[s]=l,l.__data__=i[s],u.delete(c)):n[s]=new at(t,i[s]);for(s=0;s<h;++s)(l=e[s])&&u.get(d[s])===l&&(o[s]=l)}function ut(t){return t.__data__}function ht(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ft(t){return function(){this.removeAttribute(t)}}function dt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function mt(t,e){return function(){this.setAttribute(t,e)}}function pt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function gt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function yt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function vt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function bt(t){return function(){this.style.removeProperty(t)}}function wt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function xt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function _t(t,e){return t.style.getPropertyValue(e)||vt(t).getComputedStyle(t,null).getPropertyValue(e)}function At(t){return function(){delete this[t]}}function Ct(t,e){return function(){this[t]=e}}function kt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function St(t){return t.trim().split(/^|\s+/)}function Et(t){return t.classList||new Lt(t)}function Lt(t){this._node=t,this._names=St(t.getAttribute("class")||"")}function Tt(t,e){for(var n=Et(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function Mt(t,e){for(var n=Et(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function Pt(t){return function(){Tt(this,t)}}function Nt(t){return function(){Mt(this,t)}}function It(t,e){return function(){(e.apply(this,arguments)?Tt:Mt)(this,t)}}function Ot(){this.textContent=""}function Ft(t){return function(){this.textContent=t}}function jt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Bt(){this.innerHTML=""}function Dt(t){return function(){this.innerHTML=t}}function Rt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function zt(){this.nextSibling&&this.parentNode.appendChild(this)}function Wt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ht(){return null}function Gt(){var t=this.parentNode;t&&t.removeChild(this)}function $t(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Vt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Yt(t){return function(){var e=this.__on;if(e){for(var n,r=0,o=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?e.length=o:delete this.__on}}}function Xt(t,e,n){return function(){var r,o=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(o)for(var a=0,s=o.length;a<s;++a)if((r=o[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},o?o.push(r):this.__on=[r]}}function Ut(t,e,n){var r=vt(t),o=r.CustomEvent;"function"==typeof o?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Jt(t,e){return function(){return Ut(this,t,e)}}function Qt(t,e){return function(){return Ut(this,t,e.apply(this,arguments))}}at.prototype={constructor:at,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Lt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Kt=[null];function Zt(t,e){this._groups=t,this._parents=e}function te(){return new Zt([[document.documentElement]],Kt)}function ee(t){return"string"==typeof t?new Zt([[document.querySelector(t)]],[document.documentElement]):new Zt([[t]],Kt)}function ne(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}function re(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function oe(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}Zt.prototype=te.prototype={constructor:Zt,select:function(t){"function"!=typeof t&&(t=U(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,a,s=e[o],l=s.length,c=r[o]=new Array(l),u=0;u<l;++u)(i=s[u])&&(a=t.call(i,i.__data__,u,s))&&("__data__"in i&&(a.__data__=i.__data__),c[u]=a);return new Zt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:J(e)}}(t):K(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var a,s=e[i],l=s.length,c=0;c<l;++c)(a=s[c])&&(r.push(t.call(a,a.__data__,c,s)),o.push(a));return new Zt(r,o)},selectChild:function(t){return this.select(null==t?nt:function(t){return function(){return et.call(this.children,t)}}("function"==typeof t?t:tt(t)))},selectChildren:function(t){return this.selectAll(null==t?ot:function(t){return function(){return rt.call(this.children,t)}}("function"==typeof t?t:tt(t)))},filter:function(t){"function"!=typeof t&&(t=Z(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,a=e[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&t.call(i,i.__data__,c,a)&&l.push(i);return new Zt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,ut);var n=e?ct:lt,r=this._parents,o=this._groups;"function"!=typeof t&&(t=st(t));for(var i=o.length,a=new Array(i),s=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],h=o[c],f=h.length,d=J(t.call(u,u&&u.__data__,c,r)),m=d.length,p=s[c]=new Array(m),g=a[c]=new Array(m),y=l[c]=new Array(f);n(u,h,p,g,y,d,e);for(var v,b,w=0,x=0;w<m;++w)if(v=p[w]){for(w>=x&&(x=w+1);!(b=g[x])&&++x<m;);v._next=b||null}}return(a=new Zt(a,r))._enter=s,a._exit=l,a},enter:function(){return new Zt(this._enter||this._groups.map(it),this._parents)},exit:function(){return new Zt(this._exit||this._groups.map(it),this._parents)},join:function(t,e,n){var r=this.enter(),o=this,i=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(o=e(o)),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(t){if(!(t instanceof Zt))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,o=Math.min(r,n.length),i=new Array(r),a=0;a<o;++a)for(var s,l=e[a],c=n[a],u=l.length,h=i[a]=new Array(u),f=0;f<u;++f)(s=l[f]||c[f])&&(h[f]=s);for(;a<r;++a)i[a]=e[a];return new Zt(i,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,o=t[e],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=ht);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,s=n[i],l=s.length,c=o[i]=new Array(l),u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(e)}return new Zt(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,i=e[n],a=0,s=i.length;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this},attr:function(t,e){var n=$(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?dt:ft:"function"==typeof e?n.local?yt:gt:n.local?pt:mt)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?bt:"function"==typeof e?xt:wt)(t,e,null==n?"":n)):_t(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?At:"function"==typeof e?kt:Ct)(t,e)):this.node()[t]},classed:function(t,e){var n=St(t+"");if(arguments.length<2){for(var r=Et(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?It:e?Pt:Nt)(n,e))},text:function(t){return arguments.length?this.each(null==t?Ot:("function"==typeof t?jt:Ft)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Bt:("function"==typeof t?Rt:Dt)(t)):this.node().innerHTML},raise:function(){return this.each(zt)},lower:function(){return this.each(Wt)},append:function(t){var e="function"==typeof t?t:Y(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Y(t),r=null==e?Ht:"function"==typeof e?e:U(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Gt)},clone:function(t){return this.select(t?qt:$t)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,o,i=Vt(t+""),a=i.length;if(!(arguments.length<2)){for(s=e?Xt:Yt,r=0;r<a;++r)this.each(s(i[r],e,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<a;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Qt:Jt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,o=t[e],i=0,a=o.length;i<a;++i)(r=o[i])&&(yield r)}};var ie={},ae={};function se(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function le(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function ce(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function ue(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,o=[],i=t.length,a=0,s=0,l=i<=0,c=!1;function u(){if(l)return ae;if(c)return c=!1,ie;var e,r,o=a;if(34===t.charCodeAt(o)){for(;a++<i&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=i?l=!0:10===(r=t.charCodeAt(a++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(a)&&++a),t.slice(o+1,e-1).replace(/""/g,'"')}for(;a<i;){if(10===(r=t.charCodeAt(e=a++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(o,e)}return l=!0,t.slice(o,i)}for(10===t.charCodeAt(i-1)&&--i,13===t.charCodeAt(i-1)&&--i;(r=u())!==ae;){for(var h=[];r!==ie&&r!==ae;)h.push(r),r=u();e&&null==(h=e(h,s++))||o.push(h)}return o}function o(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function i(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?function(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+ce(-e,6):e>9999?"+"+ce(e,6):ce(e,4))+"-"+ce(t.getUTCMonth()+1,2)+"-"+ce(t.getUTCDate(),2)+(i?"T"+ce(n,2)+":"+ce(r,2)+":"+ce(o,2)+"."+ce(i,3)+"Z":o?"T"+ce(n,2)+":"+ce(r,2)+":"+ce(o,2)+"Z":r||n?"T"+ce(n,2)+":"+ce(r,2)+"Z":"")}(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,o,i=r(t,(function(t,r){if(n)return n(t,r-1);o=t,n=e?function(t,e){var n=se(t);return function(r,o){return e(n(r),o,t)}}(t,e):se(t)}));return i.columns=o||[],i},parseRows:r,format:function(e,n){return null==n&&(n=le(e)),[n.map(a).join(t)].concat(o(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=le(t)),o(t,e).join("\n")},formatRows:function(t){return t.map(i).join("\n")},formatRow:i,formatValue:a}}var he=ue(",").parse,fe=ue("\t").parse;function de(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function me(t,e){return fetch(t,e).then(de)}function pe(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),me(e,n).then((function(e){return t(e,r)}))}}function ge(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function ye(t){return(e,n)=>me(e,n).then(e=>(new DOMParser).parseFromString(e,t))}var ve={__proto__:null,blob:function(t,e){return fetch(t,e).then(re)},buffer:function(t,e){return fetch(t,e).then(oe)},dsv:function(t,e,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var o=ue(t);return me(e,n).then((function(t){return o.parse(t,r)}))},csv:pe(he),tsv:pe(fe),image:function(t,e){return new Promise((function(n,r){var o=new Image;for(var i in e)o[i]=e[i];o.onerror=r,o.onload=function(){n(o)},o.src=t}))},json:function(t,e){return fetch(t,e).then(ge)},text:me,xml:ye("application/xml"),html:ye("text/html"),svg:ye("image/svg+xml")},be={value:()=>{}};function we(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new xe(r)}function xe(t){this._=t}function _e(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Ae(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}function Ce(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=be,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}xe.prototype=we.prototype={constructor:xe,on:function(t,e){var n,r=this._,o=_e(t+"",r),i=-1,a=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<a;)if(n=(t=o[i]).type)r[n]=Ce(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ce(r[n],t.name,null);return this}for(;++i<a;)if((n=(t=o[i]).type)&&(n=Ae(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new xe(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};var ke={__proto__:null,dispatch:we};function Se(t){t.preventDefault(),t.stopImmediatePropagation()}function Ee(t){var e=t.document.documentElement,n=ee(t).on("dragstart.drag",Se,!0);"onselectstart"in e?n.on("selectstart.drag",Se,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Le(t,e){var n=t.document.documentElement,r=ee(t).on("dragstart.drag",null);e&&(r.on("click.drag",Se,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Te(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Me(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Pe(){}var Ne="\\s*([+-]?\\d+)\\s*",Ie="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Oe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fe=/^#([0-9a-f]{3,8})$/,je=new RegExp("^rgb\\("+[Ne,Ne,Ne]+"\\)$"),Be=new RegExp("^rgb\\("+[Oe,Oe,Oe]+"\\)$"),De=new RegExp("^rgba\\("+[Ne,Ne,Ne,Ie]+"\\)$"),Re=new RegExp("^rgba\\("+[Oe,Oe,Oe,Ie]+"\\)$"),ze=new RegExp("^hsl\\("+[Ie,Oe,Oe]+"\\)$"),We=new RegExp("^hsla\\("+[Ie,Oe,Oe,Ie]+"\\)$"),He={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ge(){return this.rgb().formatHex()}function $e(){return this.rgb().formatRgb()}function qe(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Fe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ve(e):3===n?new Je(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ye(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ye(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=je.exec(t))?new Je(e[1],e[2],e[3],1):(e=Be.exec(t))?new Je(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=De.exec(t))?Ye(e[1],e[2],e[3],e[4]):(e=Re.exec(t))?Ye(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ze.exec(t))?tn(e[1],e[2]/100,e[3]/100,1):(e=We.exec(t))?tn(e[1],e[2]/100,e[3]/100,e[4]):He.hasOwnProperty(t)?Ve(He[t]):"transparent"===t?new Je(NaN,NaN,NaN,0):null}function Ve(t){return new Je(t>>16&255,t>>8&255,255&t,1)}function Ye(t,e,n,r){return r<=0&&(t=e=n=NaN),new Je(t,e,n,r)}function Xe(t){return t instanceof Pe||(t=qe(t)),t?new Je((t=t.rgb()).r,t.g,t.b,t.opacity):new Je}function Ue(t,e,n,r){return 1===arguments.length?Xe(t):new Je(t,e,n,null==r?1:r)}function Je(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Qe(){return"#"+Ze(this.r)+Ze(this.g)+Ze(this.b)}function Ke(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ze(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function tn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nn(t,e,n,r)}function en(t){if(t instanceof nn)return new nn(t.h,t.s,t.l,t.opacity);if(t instanceof Pe||(t=qe(t)),!t)return new nn;if(t instanceof nn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),a=NaN,s=i-o,l=(i+o)/2;return s?(a=e===i?(n-r)/s+6*(n<r):n===i?(r-e)/s+2:(e-n)/s+4,s/=l<.5?i+o:2-i-o,a*=60):s=l>0&&l<1?0:a,new nn(a,s,l,t.opacity)}function nn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function rn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Te(Pe,qe,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ge,formatHex:Ge,formatHsl:function(){return en(this).formatHsl()},formatRgb:$e,toString:$e}),Te(Je,Ue,Me(Pe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Je(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Je(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qe,formatHex:Qe,formatRgb:Ke,toString:Ke})),Te(nn,(function(t,e,n,r){return 1===arguments.length?en(t):new nn(t,e,n,null==r?1:r)}),Me(Pe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new nn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new nn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new Je(rn(t>=240?t-240:t+120,o,r),rn(t,o,r),rn(t<120?t+240:t-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var on=t=>()=>t;function an(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):on(isNaN(t)?e:t)}var sn=function t(e){var n=function(t){return 1==(t=+t)?an:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):on(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Ue(t)).r,(e=Ue(e)).r),o=n(t.g,e.g),i=n(t.b,e.b),a=an(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=i(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function ln(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,o=e.slice();return function(i){for(n=0;n<r;++n)o[n]=t[n]*(1-i)+e[n]*i;return o}}function cn(t,e){var n,r=e?e.length:0,o=t?Math.min(r,t.length):0,i=new Array(o),a=new Array(r);for(n=0;n<o;++n)i[n]=gn(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<o;++n)a[n]=i[n](t);return a}}function un(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function hn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function fn(t,e){var n,r={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=gn(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}var dn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mn=new RegExp(dn.source,"g");function pn(t,e){var n,r,o,i=dn.lastIndex=mn.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=dn.exec(t))&&(r=mn.exec(e));)(o=r.index)>i&&(o=e.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:hn(n,r)})),i=mn.lastIndex;return i<e.length&&(o=e.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function gn(t,e){var n,r=typeof e;return null==e||"boolean"===r?on(e):("number"===r?hn:"string"===r?(n=qe(e))?(e=n,sn):pn:e instanceof qe?sn:e instanceof Date?un:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?ln:Array.isArray(e)?cn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?fn:hn)(t,e)}function yn(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var vn,bn=180/Math.PI,wn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xn(t,e,n,r,o,i){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*bn,skewX:Math.atan(l)*bn,scaleX:a,scaleY:s}}function _n(t,e,n,r){function o(t){return t.length?t.pop()+" ":""}return function(i,a){var s=[],l=[];return i=t(i),a=t(a),function(t,r,o,i,a,s){if(t!==o||r!==i){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:hn(t,o)},{i:l-2,x:hn(r,i)})}else(o||i)&&a.push("translate("+o+e+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,s,l),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:hn(t,e)})):e&&n.push(o(n)+"rotate("+e+r)}(i.rotate,a.rotate,s,l),function(t,e,n,i){t!==e?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:hn(t,e)}):e&&n.push(o(n)+"skewX("+e+r)}(i.skewX,a.skewX,s,l),function(t,e,n,r,i,a){if(t!==n||e!==r){var s=i.push(o(i)+"scale(",null,",",null,")");a.push({i:s-4,x:hn(t,n)},{i:s-2,x:hn(e,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,l),i=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var An,Cn,kn=_n((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?wn:xn(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Sn=_n((function(t){return null==t?wn:(vn||(vn=document.createElementNS("http://www.w3.org/2000/svg","g")),vn.setAttribute("transform",t),(t=vn.transform.baseVal.consolidate())?xn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):wn)}),", ",")",")"),En=0,Ln=0,Tn=0,Mn=0,Pn=0,Nn=0,In="object"==typeof performance&&performance.now?performance:Date,On="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Fn(){return Pn||(On(jn),Pn=In.now()+Nn)}function jn(){Pn=0}function Bn(){this._call=this._time=this._next=null}function Dn(t,e,n){var r=new Bn;return r.restart(t,e,n),r}function Rn(){Pn=(Mn=In.now())+Nn,En=Ln=0;try{!function(){Fn(),++En;for(var t,e=An;e;)(t=Pn-e._time)>=0&&e._call.call(null,t),e=e._next;--En}()}finally{En=0,function(){for(var t,e,n=An,r=Infinity;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:An=e);Cn=t,Wn(r)}(),Pn=0}}function zn(){var t=In.now(),e=t-Mn;e>1e3&&(Nn-=e,Mn=t)}function Wn(t){En||(Ln&&(Ln=clearTimeout(Ln)),t-Pn>24?(t<Infinity&&(Ln=setTimeout(Rn,t-In.now()-Nn)),Tn&&(Tn=clearInterval(Tn))):(Tn||(Mn=In.now(),Tn=setInterval(zn,1e3)),En=1,On(Rn)))}function Hn(t,e,n){var r=new Bn;return r.restart(n=>{r.stop(),t(n+e)},e=null==e?0:+e,n),r}Bn.prototype=Dn.prototype={constructor:Bn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Fn():+n)+(null==e?0:+e),this._next||Cn===this||(Cn?Cn._next=this:An=this,Cn=this),this._call=t,this._time=n,Wn()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Wn())}};var Gn=we("start","end","cancel","interrupt"),$n=[];function qn(t,e,n,r,o,i){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,o=t.__transition;function i(l){var c,u,h,f;if(1!==n.state)return s();for(c in o)if((f=o[c]).name===n.name){if(3===f.state)return Hn(i);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete o[c]):+c<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete o[c])}if(Hn((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=f);r.length=u+1}}function a(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),i=-1,a=r.length;++i<a;)r[i].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=Dn((function(t){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=t&&i(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:o,on:Gn,tween:$n,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function Vn(t,e){var n=Xn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Yn(t,e){var n=Xn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Xn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Un(t,e){var n,r,o,i=t.__transition,a=!0;if(i){for(o in e=null==e?null:e+"",i)(n=i[o]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[o]):a=!1;a&&delete t.__transition}}function Jn(t,e){var n,r;return function(){var o=Yn(this,t),i=o.tween;if(i!==n)for(var a=0,s=(r=n=i).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}o.tween=r}}function Qn(t,e,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var i=Yn(this,t),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:e,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=s;break}l===c&&o.push(s)}i.tween=o}}function Kn(t,e,n){var r=t._id;return t.each((function(){var t=Yn(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Xn(t,r).value[e]}}function Zn(t,e){var n;return("number"==typeof e?hn:e instanceof qe?sn:(n=qe(e))?(e=n,sn):pn)(t,e)}function tr(t){return function(){this.removeAttribute(t)}}function er(t){return function(){this.removeAttributeNS(t.space,t.local)}}function nr(t,e,n){var r,o,i=n+"";return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function rr(t,e,n){var r,o,i=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function or(t,e,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=e(r=a,l));this.removeAttribute(t)}}function ir(t,e,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function ar(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function sr(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function lr(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&sr(t,o)),n}return o._value=e,o}function cr(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&ar(t,o)),n}return o._value=e,o}function ur(t,e){return function(){Vn(this,t).delay=+e.apply(this,arguments)}}function hr(t,e){return e=+e,function(){Vn(this,t).delay=e}}function fr(t,e){return function(){Yn(this,t).duration=+e.apply(this,arguments)}}function dr(t,e){return e=+e,function(){Yn(this,t).duration=e}}function mr(t,e){if("function"!=typeof e)throw new Error;return function(){Yn(this,t).ease=e}}function pr(t,e,n){var r,o,i=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Vn:Yn;return function(){var a=i(this,t),s=a.on;s!==r&&(o=(r=s).copy()).on(e,n),a.on=o}}var gr=te.prototype.constructor;function yr(t){return function(){this.style.removeProperty(t)}}function vr(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function br(t,e,n){var r,o;function i(){var i=e.apply(this,arguments);return i!==o&&(r=(o=i)&&vr(t,i,n)),r}return i._value=e,i}function wr(t){return function(e){this.textContent=t.call(this,e)}}function xr(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&wr(r)),e}return r._value=t,r}var _r=0;function Ar(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Cr(){return++_r}var kr=te.prototype;Ar.prototype=function(t){return te().transition(t)}.prototype={constructor:Ar,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=U(t));for(var r=this._groups,o=r.length,i=new Array(o),a=0;a<o;++a)for(var s,l,c=r[a],u=c.length,h=i[a]=new Array(u),f=0;f<u;++f)(s=c[f])&&(l=t.call(s,s.__data__,f,c))&&("__data__"in s&&(l.__data__=s.__data__),h[f]=l,qn(h[f],e,n,f,h,Xn(s,n)));return new Ar(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=K(t));for(var r=this._groups,o=r.length,i=[],a=[],s=0;s<o;++s)for(var l,c=r[s],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var f,d=t.call(l,l.__data__,h,c),m=Xn(l,n),p=0,g=d.length;p<g;++p)(f=d[p])&&qn(f,e,n,p,d,m);i.push(d),a.push(l)}return new Ar(i,a,e,n)},filter:function(t){"function"!=typeof t&&(t=Z(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,a=e[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&t.call(i,i.__data__,c,a)&&l.push(i);return new Ar(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=Math.min(r,n.length),i=new Array(r),a=0;a<o;++a)for(var s,l=e[a],c=n[a],u=l.length,h=i[a]=new Array(u),f=0;f<u;++f)(s=l[f]||c[f])&&(h[f]=s);for(;a<r;++a)i[a]=e[a];return new Ar(i,this._parents,this._name,this._id)},selection:function(){return new gr(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Cr(),r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var u=Xn(a,e);qn(a,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ar(r,this._parents,t,n)},call:kr.call,nodes:kr.nodes,node:kr.node,size:kr.size,empty:kr.empty,each:kr.each,on:function(t,e){var n=this._id;return arguments.length<2?Xn(this.node(),n).on.on(t):this.each(pr(n,t,e))},attr:function(t,e){var n=$(t),r="transform"===n?Sn:Zn;return this.attrTween(t,"function"==typeof e?(n.local?ir:or)(n,r,Kn(this,"attr."+t,e)):null==e?(n.local?er:tr)(n):(n.local?rr:nr)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=$(t);return this.tween(n,(r.local?lr:cr)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?kn:Zn;return null==e?this.styleTween(t,function(t,e){var n,r,o;return function(){var i=_t(this,t),a=(this.style.removeProperty(t),_t(this,t));return i===a?null:i===n&&a===r?o:o=e(n=i,r=a)}}(t,r)).on("end.style."+t,yr(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,o,i;return function(){var a=_t(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=_t(this,t)),a===l?null:a===r&&l===o?i:(o=l,i=e(r=a,s))}}(t,r,Kn(this,"style."+t,e))).each(function(t,e){var n,r,o,i,a="style."+e,s="end."+a;return function(){var l=Yn(this,t),c=l.on,u=null==l.value[a]?i||(i=yr(e)):void 0;c===n&&o===u||(r=(n=c).copy()).on(s,o=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,o,i=n+"";return function(){var a=_t(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,br(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Kn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,xr(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,o=Xn(this.node(),n).tween,i=0,a=o.length;i<a;++i)if((r=o[i]).name===t)return r.value;return null}return this.each((null==e?Jn:Qn)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ur:hr)(e,t)):Xn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?fr:dr)(e,t)):Xn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(mr(e,t)):Xn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Yn(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,o=n.size();return new Promise((function(i,a){var s={value:a},l={value:function(){0==--o&&i()}};n.each((function(){var n=Yn(this,r),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===o&&i()}))},[Symbol.iterator]:kr[Symbol.iterator]};var Sr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Er(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}te.prototype.interrupt=function(t){return this.each((function(){Un(this,t)}))},te.prototype.transition=function(t){var e,n;t instanceof Ar?(e=t._id,t=t._name):(e=Cr(),(n=Sr).time=Fn(),t=null==t?null:t+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)(a=s[c])&&qn(a,t,e,c,s,n||Er(a,e));return new Ar(r,this._parents,t,e)};var Lr=t=>()=>t;function Tr(t,{sourceEvent:e,target:n,selection:r,mode:o,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:o,enumerable:!0,configurable:!0},_:{value:i}})}function Mr(t){t.stopImmediatePropagation()}function Pr(t){t.preventDefault(),t.stopImmediatePropagation()}var Nr={name:"drag"},Ir={name:"space"},Or={name:"handle"},Fr={name:"center"};const{abs:jr,max:Br,min:Dr}=Math;function Rr(t){return[+t[0],+t[1]]}function zr(t){return[Rr(t[0]),Rr(t[1])]}var Wr={name:"x",handles:["w","e"].map(Ur),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Hr={name:"y",handles:["n","s"].map(Ur),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Gr={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ur),input:function(t){return null==t?null:zr(t)},output:function(t){return t}},$r={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qr={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Vr={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Yr={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Xr={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ur(t){return{type:t}}function Jr(t){return!t.ctrlKey&&!t.button}function Qr(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Kr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zr(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function to(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function eo(t){var e,n=Qr,r=Jr,o=Kr,i=!0,a=we("start","brush","end"),s=6;function l(e){var n=e.property("__brush",p).selectAll(".overlay").data([Ur("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",$r.overlay).merge(n).each((function(){var t=Zr(this).extent;ee(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([Ur("selection")]).enter().append("rect").attr("class","selection").attr("cursor",$r.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return $r[t.type]})),e.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(o).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t=ee(this),e=Zr(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new h(t,e,n):r}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function f(n){if((!e||n.touches)&&r.apply(this,arguments)){var o,a,s,l,h,f,d,m,p,g,y,v=this,b=n.target.__data__.type,w="selection"===(i&&n.metaKey?b="overlay":b)?Nr:i&&n.altKey?Fr:Or,x=t===Hr?null:Yr[b],_=t===Wr?null:Xr[b],A=Zr(v),C=A.extent,k=A.selection,S=C[0][0],E=C[0][1],L=C[1][0],T=C[1][1],M=0,P=0,N=x&&_&&i&&n.shiftKey,I=Array.from(n.touches||[n],t=>{const e=t.identifier;return(t=ne(t,v)).point0=t.slice(),t.identifier=e,t});if("overlay"===b){k&&(p=!0);const e=[I[0],I[1]||I[0]];A.selection=k=[[o=t===Hr?S:Dr(e[0][0],e[1][0]),s=t===Wr?E:Dr(e[0][1],e[1][1])],[h=t===Hr?L:Br(e[0][0],e[1][0]),d=t===Wr?T:Br(e[0][1],e[1][1])]],I.length>1&&R()}else o=k[0][0],s=k[0][1],h=k[1][0],d=k[1][1];a=o,l=s,f=h,m=d;var O=ee(v).attr("pointer-events","none"),F=O.selectAll(".overlay").attr("cursor",$r[b]);Un(v);var j=u(v,arguments,!0).beforestart();if(n.touches)j.moved=D,j.ended=z;else{var B=ee(n.view).on("mousemove.brush",D,!0).on("mouseup.brush",z,!0);i&&B.on("keydown.brush",W,!0).on("keyup.brush",H,!0),Ee(n.view)}c.call(v),j.start(n,w.name)}function D(t){for(const e of t.changedTouches||[t])for(const t of I)t.identifier===e.identifier&&(t.cur=ne(e,v));if(N&&!g&&!y&&1===I.length){const t=I[0];jr(t.cur[0]-t[0])>jr(t.cur[1]-t[1])?y=!0:g=!0}for(const t of I)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);p=!0,Pr(t),R(t)}function R(t){const e=I[0],n=e.point0;var r;switch(M=e[0]-n[0],P=e[1]-n[1],w){case Ir:case Nr:x&&(M=Br(S-o,Dr(L-h,M)),a=o+M,f=h+M),_&&(P=Br(E-s,Dr(T-d,P)),l=s+P,m=d+P);break;case Or:I[1]?(x&&(a=Br(S,Dr(L,I[0][0])),f=Br(S,Dr(L,I[1][0])),x=1),_&&(l=Br(E,Dr(T,I[0][1])),m=Br(E,Dr(T,I[1][1])),_=1)):(x<0?(M=Br(S-o,Dr(L-o,M)),a=o+M,f=h):x>0&&(M=Br(S-h,Dr(L-h,M)),a=o,f=h+M),_<0?(P=Br(E-s,Dr(T-s,P)),l=s+P,m=d):_>0&&(P=Br(E-d,Dr(T-d,P)),l=s,m=d+P));break;case Fr:x&&(a=Br(S,Dr(L,o-M*x)),f=Br(S,Dr(L,h+M*x))),_&&(l=Br(E,Dr(T,s-P*_)),m=Br(E,Dr(T,d+P*_)))}f<a&&(x*=-1,r=o,o=h,h=r,r=a,a=f,f=r,b in qr&&F.attr("cursor",$r[b=qr[b]])),m<l&&(_*=-1,r=s,s=d,d=r,r=l,l=m,m=r,b in Vr&&F.attr("cursor",$r[b=Vr[b]])),A.selection&&(k=A.selection),g&&(a=k[0][0],f=k[1][0]),y&&(l=k[0][1],m=k[1][1]),k[0][0]===a&&k[0][1]===l&&k[1][0]===f&&k[1][1]===m||(A.selection=[[a,l],[f,m]],c.call(v),j.brush(t,w.name))}function z(t){if(Mr(t),t.touches){if(t.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else Le(t.view,p),B.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);O.attr("pointer-events","all"),F.attr("cursor",$r.overlay),A.selection&&(k=A.selection),to(k)&&(A.selection=null,c.call(v)),j.end(t,w.name)}function W(t){switch(t.keyCode){case 16:N=x&&_;break;case 18:w===Or&&(x&&(h=f-M*x,o=a+M*x),_&&(d=m-P*_,s=l+P*_),w=Fr,R());break;case 32:w!==Or&&w!==Fr||(x<0?h=f-M:x>0&&(o=a-M),_<0?d=m-P:_>0&&(s=l-P),w=Ir,F.attr("cursor",$r.selection),R());break;default:return}Pr(t)}function H(t){switch(t.keyCode){case 16:N&&(g=y=N=!1,R());break;case 18:w===Fr&&(x<0?h=f:x>0&&(o=a),_<0?d=m:_>0&&(s=l),w=Or,R());break;case 32:w===Ir&&(t.altKey?(x&&(h=f-M*x,o=a+M*x),_&&(d=m-P*_,s=l+P*_),w=Fr):(x<0?h=f:x>0&&(o=a),_<0?d=m:_>0&&(s=l),w=Or),F.attr("cursor",$r[b]),R());break;default:return}Pr(t)}}function d(t){u(this,arguments).moved(t)}function m(t){u(this,arguments).ended(t)}function p(){var e=this.__brush||{selection:null};return e.extent=zr(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.tween?e.on("start.brush",(function(t){u(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){u(this,arguments).end(t)})).tween("brush",(function(){var e=this,r=e.__brush,o=u(e,arguments),i=r.selection,a=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=gn(i,a);function l(t){r.selection=1===t&&null===a?null:s(t),c.call(e),o.brush()}return null!==i&&null!==a?l:l(1)})):e.each((function(){var e=this,r=arguments,o=e.__brush,i=t.input("function"==typeof n?n.apply(e,r):n,o.extent),a=u(e,r).beforestart();Un(e),o.selection=null===i?null:i,c.call(e),a.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,e){return this.starting?(this.starting=!1,this.emit("start",t,e)):this.emit("brush",t),this},brush:function(t,e){return this.emit("brush",t,e),this},end:function(t,e){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,e)),this},emit:function(e,n,r){var o=ee(this.that).datum();a.call(e,this.that,new Tr(e,{sourceEvent:n,target:l,selection:t.output(this.state.selection),mode:r,dispatch:a}),o)}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:Lr(zr(t)),l):n},l.filter=function(t){return arguments.length?(r="function"==typeof t?t:Lr(!!t),l):r},l.touchable=function(t){return arguments.length?(o="function"==typeof t?t:Lr(!!t),l):o},l.handleSize=function(t){return arguments.length?(s=+t,l):s},l.keyModifiers=function(t){return arguments.length?(i=!!t,l):i},l.on=function(){var t=a.on.apply(a,arguments);return t===a?l:t},l}var no={__proto__:null,brush:function(){return eo(Gr)},brushX:function(){return eo(Wr)},brushY:function(){return eo(Hr)},brushSelection:function(t){var e=t.__brush;return e?e.dim.output(e.selection):null}};function ro(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function oo(t){return(t=ro(Math.abs(t)))?t[1]:NaN}var io,ao=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function so(t){if(!(e=ao.exec(t)))throw new Error("invalid format: "+t);var e;return new lo({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function lo(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function co(t,e){var n=ro(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}so.prototype=lo.prototype,lo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var uo={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>co(100*t,e),r:co,s:function(t,e){var n=ro(t,e);if(!n)return t+"";var r=n[0],o=n[1],i=o-(io=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=r.length;return i===a?r:i>a?r+new Array(i-a+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+ro(t,Math.max(0,e+i-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ho(t){return t}var fo,mo,po,go=Array.prototype.map,yo=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function vo(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ho:(e=go.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var o=t.length,i=[],a=0,s=e[0],l=0;o>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),i.push(t.substring(o-=s,o+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return i.reverse().join(n)}),o=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?ho:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(go.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=so(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,m=t.width,p=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(p=!0,v="g"):uo[v]||(void 0===g&&(g=12),y=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var b="$"===f?o:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===f?i:/[%p]/.test(v)?l:"",x=uo[v],_=/[defgprs%]/.test(v);function A(t){var o,i,l,f=b,A=w;if("c"===v)A=x(t)+A,t="";else{var C=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,o=-1;r<n;++r)switch(t[r]){case".":o=e=r;break;case"0":0===o&&(o=r),e=r;break;default:if(!+t[r])break t;o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),C&&0==+t&&"+"!==h&&(C=!1),f=(C?"("===h?h:c:"-"===h||"("===h?"":h)+f,A=("s"===v?yo[8+io/3]:"")+A+(C&&"("===h?")":""),_)for(o=-1,i=t.length;++o<i;)if(48>(l=t.charCodeAt(o))||l>57){A=(46===l?a+t.slice(o+1):t.slice(o))+A,t=t.slice(0,o);break}}p&&!d&&(t=r(t,Infinity));var k=f.length+t.length+A.length,S=k<m?new Array(m-k+1).join(e):"";switch(p&&d&&(t=r(S+t,S.length?m-A.length:Infinity),S=""),n){case"<":t=f+t+A+S;break;case"=":t=f+S+t+A;break;case"^":t=S.slice(0,k=S.length>>1)+f+t+A+S.slice(k);break;default:t=S+f+t+A}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),A.toString=function(){return t+""},A}return{format:h,formatPrefix:function(t,e){var n=h(((t=so(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(oo(e)/3))),o=Math.pow(10,-r),i=yo[8+r/3];return function(t){return n(o*t)+i}}}}function bo(t){return fo=vo(t),mo=fo.format,po=fo.formatPrefix,fo}function wo(t){return Math.max(0,-oo(Math.abs(t)))}function xo(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(oo(e)/3)))-oo(Math.abs(t)))}function _o(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,oo(e)-oo(t))+1}bo({thousands:",",grouping:[3],currency:["$",""]});var Ao={__proto__:null,formatDefaultLocale:bo,get format(){return mo},get formatPrefix(){return po},formatLocale:vo,formatSpecifier:so,FormatSpecifier:lo,precisionFixed:wo,precisionPrefix:xo,precisionRound:_o};function Co(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ko(t){let e=t,n=t;function r(t,e,r,o){for(null==r&&(r=0),null==o&&(o=t.length);r<o;){const i=r+o>>>1;n(t[i],e)<0?r=i+1:o=i}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>Co(t(e),n)}(t)),{left:r,center:function(t,n,o,i){null==o&&(o=0),null==i&&(i=t.length);const a=r(t,n,o,i-1);return a>o&&e(t[a-1],n)>-e(t[a],n)?a-1:a},right:function(t,e,r,o){for(null==r&&(r=0),null==o&&(o=t.length);r<o;){const i=r+o>>>1;n(t[i],e)>0?o=i:r=i+1}return r}}}const So=ko(Co).right;ko((function(t){return null===t?NaN:+t}));var Eo=Math.sqrt(50),Lo=Math.sqrt(10),To=Math.sqrt(2);function Mo(t,e,n){var r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,o);return o>=0?(i>=Eo?10:i>=Lo?5:i>=To?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=Eo?10:i>=Lo?5:i>=To?2:1)}function Po(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function No(t){return+t}var Io=[0,1];function Oo(t){return t}function Fo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function jo(t,e,n){var r=t[0],o=t[1],i=e[0],a=e[1];return o<r?(r=Fo(o,r),i=n(a,i)):(r=Fo(r,o),i=n(i,a)),function(t){return i(r(t))}}function Bo(t,e,n){var r=Math.min(t.length,e.length)-1,o=new Array(r),i=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)o[a]=Fo(t[a],t[a+1]),i[a]=n(e[a],e[a+1]);return function(e){var n=So(t,e,1,r)-1;return i[n](o[n](e))}}function Do(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ro(){return function(){var t,e,n,r,o,i,a=Io,s=Io,l=gn,c=Oo;function u(){var t=Math.min(a.length,s.length);return c!==Oo&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(a[0],a[t-1])),r=t>2?Bo:jo,o=i=null,h}function h(e){return null==e||isNaN(e=+e)?n:(o||(o=r(a.map(t),s,l)))(t(c(e)))}return h.invert=function(n){return c(e((i||(i=r(s,a.map(t),hn)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,No),u()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),l=yn,u()},h.clamp=function(t){return arguments.length?(c=!!t||Oo,u()):c!==Oo},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,u()}}()(Oo,Oo)}function zo(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,o,i,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),0===(a=Mo(t,e,n))||!isFinite(a))return[];if(a>0){let n=Math.round(t/a),r=Math.round(e/a);for(n*a<t&&++n,r*a>e&&--r,i=new Array(o=r-n+1);++s<o;)i[s]=(n+s)*a}else{a=-a;let n=Math.round(t*a),r=Math.round(e*a);for(n/a<t&&++n,r/a>e&&--r,i=new Array(o=r-n+1);++s<o;)i[s]=(n+s)/a}return r&&i.reverse(),i}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var o,i=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/o;return i>=Eo?o*=10:i>=Lo?o*=5:i>=To&&(o*=2),e<t?-o:o}(t,e,n);switch((r=so(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(o=xo(i,a))||(r.precision=o),po(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=_o(i,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=wo(i))||(r.precision=o-2*("%"===r.type))}return mo(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,o,i=e(),a=0,s=i.length-1,l=i[a],c=i[s],u=10;for(c<l&&(o=l,l=c,c=o,o=a,a=s,s=o);u-- >0;){if((o=Mo(l,c,n))===r)return i[a]=l,i[s]=c,e(i);if(o>0)l=Math.floor(l/o)*o,c=Math.ceil(c/o)*o;else{if(!(o<0))break;l=Math.ceil(l*o)/o,c=Math.floor(c*o)/o}r=o}return t},t}var Wo,Ho={9606:{commonName:"Human",scientificName:"Homo sapiens",assemblies:{default:"GCF_000001405.26",GRCh38:"GCF_000001405.26",GRCh37:"GCF_000001405.13",NCBI36:"GCF_000001405.12"},hasGeneCache:!0},10090:{commonName:"Mouse",scientificName:"Mus musculus",assemblies:{default:"GCF_000001635.20",GRCm38:"GCF_000001635.20",MGSCv37:"GCF_000001635.18"}},9598:{commonName:"Chimpanzee",scientificName:"Pan troglodytes",assemblies:{default:"GCF_000001515.7","Pan_tro 3.0":"GCF_000001515.7"}},10116:{commonName:"Rat",scientificName:"Rattus norvegicus",assemblies:{default:"GCF_000001895.5","Rnor_6.0":"GCF_000001895.5"}},3702:{commonName:"Thale cress",scientificName:"Arabidopsis thaliana",assemblies:{default:"GCF_000001735.3",TAIR10:"GCF_000001735.3"}},4530:{commonName:"Rice",scientificName:"Oryza sativa",assemblies:{default:"GCA_001433935.1","IRGSP-1.0":"GCA_001433935.1"}},4577:{commonName:"Maize",scientificName:"Zea mays",assemblies:{default:"GCA_000005005.5","IRGSP-1.0":"GCA_001433935.1"}},4641:{commonName:"Banana",scientificName:"Musa acuminata",assemblies:{default:"mock"}},7227:{commonName:"Fly",scientificName:"Drosophila melanogaster",assemblies:{default:"GCA_000001215.4","Release 6 plus ISO1 MT":"GCA_000001215.4"}},7165:{commonName:"Mosquito",scientificName:"Anopheles gambiae",assemblies:{default:""}},746128:{commonName:"Aspergillis fumigatus",scientificName:"Aspergillis fumigatus",assemblies:{default:""}},227321:{commonName:"Aspergillus nidulans",scientificName:"",assemblies:{default:""}},5061:{commonName:"black mold",scientificName:"Aspergillus niger",assemblies:{default:""}},5062:{commonName:"koji",scientificName:"Aspergillus oryzae",assemblies:{default:""}},15368:{commonName:"",scientificName:"Brachypodium distachyon",assemblies:{default:""}},60711:{commonName:"",scientificName:"Chlorocebus sabaeus",assemblies:{default:""}},7719:{commonName:"Vase tunicate",scientificName:"Ciona intestinalis",assemblies:{default:""}},9685:{commonName:"Cat",scientificName:"Felis catus",assemblies:{default:""}},9031:{commonName:"Chicken",scientificName:"Gallus gallus",assemblies:{default:""}},9593:{commonName:"Gorilla",scientificName:"Gorilla gorilla",assemblies:{default:""}},4513:{commonName:"Barley",scientificName:"Hordeum vulgare",assemblies:{default:""}},9541:{commonName:"Crab-eating macaque",scientificName:"Macaca fascicularis",assemblies:{default:""}},9544:{commonName:"Rhesus macaque",scientificName:"Macaca mulatta",assemblies:{default:""}},9597:{commonName:"Bonobo",scientificName:"Pan paniscus",assemblies:{default:""}},9615:{commonName:"Dog",scientificName:"Canis lupus familiaris",assemblies:{default:""}},4932:{commonName:"Yeast",scientificName:"Saccharomyces cerevisiae",assemblies:{default:"GCA_000146045.2",R64:"GCA_000146045.2"}},5833:{commonName:"malaria parasite",scientificName:"Plasmodium falciparum",assemblies:{default:"GCA_000002765.3",GCA_000002765:"GCA_000002765.3"}},6239:{commonName:"worm",scientificName:"Caenorhabditis elegans",assemblies:{default:"GCF_000002985.6",GCA_000002765:"GCF_000002985.6"}}},Go=Object.assign({},ve,no,ke,Ao);function $o(){return"assembly"in this.config&&/(GCF_|GCA_)/.test(this.config.assembly)}function qo(t){var e,n,r,o=document.scripts,i=Ideogram.version;if(!1===location.pathname.includes("/examples/vanilla/"))return`https://cdn.jsdelivr.net/npm/ideogram@${i}/dist/data/${t}`;for(var a=0;a<o.length;a++)if(r=/ideogram/.test((e=o[a]).src.split("/").slice(-1)),"src"in e&&r)return(n=e.src.split("//"))[0]+"//"+(n="/"+n[1].split("/").slice(0,-2).join("/"))+"/data/"+t;return"../data/"+t}function Vo(t,e=!1){return fetch(t).then(n=>{if(n.ok)return n;if(!1===e)return Vo(t.replace(".json",""),!0);throw Error("Fetch failed for "+t)})}function Yo(){return qo("bands/native/")}function Xo(t){return Math.round(100*t)/100}function Uo(t){call(this.onDidRotateCallback,t)}function Jo(){return Go.select(this.selector).node()}function Qo(t,e){var n=this.config,r=new Headers;return n.accessToken&&(r=new Headers({Authorization:"Bearer "+n.accessToken})),"text"===e?Go.text(t,{headers:r}):Go.json(t,{headers:r})}function Ko(t){var e,n,r,o,i=this.organisms;for(n in t=ei(t),i)if(r=ei((e=i[n]).commonName),o=ei(e.scientificName),r===t||o===t)return n;return null}function Zo(t){return t in this.organisms?this.organisms[t].commonName:null}function ti(t){return t in this.organisms?this.organisms[t].scientificName:null}function ei(t){return t.toLowerCase().replace(/ /g,"-")}function ni(t){return/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/i.test(t)}function ri(t){var e={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1};return t.toUpperCase().split("").reduce((function(t,n,r,o){return e[n]<e[o[r+1]]?t-e[n]:t+e[n]}),0)}function oi(t){const e=t.config;let n="sans-serif";return e.fontFamily&&(n=e.fontFamily),"600 "+(e.annotLabelSize?e.annotLabelSize:13)+"px "+n}function ii(t,e){var n=oi(e),r=(ii.canvas||(ii.canvas=document.createElement("canvas"))).getContext("2d");r.font=n;var o=r.measureText(t),i=o.actualBoundingBoxRight;return{width:Math.abs(o.actualBoundingBoxLeft)+Math.abs(i),height:Math.abs(o.actualBoundingBoxAscent)+Math.abs(o.actualBoundingBoxDescent)}}Go.select=ee,Go.selectAll=function(t){return"string"==typeof t?new Zt([document.querySelectorAll(t)],[document.documentElement]):new Zt([null==t?[]:J(t)],Kt)},Go.scaleLinear=function t(){var e=Ro();return e.copy=function(){return Do(e,t())},Po.apply(e,arguments),zo(e)},Go.max=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let o of t)null!=(o=e(o,++r,t))&&(n<o||void 0===n&&o>=o)&&(n=o)}return n},Go.easeExpIn=function(t){return function(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}(1-+t)},Wo=[["gneg","#FFF","#FFF","#DDD"],["gpos25","#C8C8C8","#DDD","#BBB"],["gpos33","#BBB","#BBB","#AAA"],["gpos50","#999","#AAA","#888"],["gpos66","#888","#888","#666"],["gpos75","#777","#777","#444"],["gpos100","#444","#666","#000"],["acen","#FEE","#FEE","#FDD"],["noBands","#BBB","#BBB","#AAA"]];let ai='#_ideogram {padding-left: 5px;} #_ideogram .labeled {padding-left: 15px;} #_ideogram.labeledLeft {padding-left: 15px; padding-top: 15px;} #_ideogram text {font: 9px Tahoma; fill: #000;} #_ideogram .italic {font-style: italic;} #_ideogram .chromosome {cursor: pointer; fill: #AAA;}#_ideogram.no-rotate .chromosome {cursor: default;} #_ideogram .chrLabel, #_ideogram .annot {cursor: pointer;}#_ideogram .chrSetLabel {font-weight: bolder;}#_ideogram .ghost {opacity: 0.2;}#_ideogram .hidden {display: none;}#_ideogram .bandLabelStalk line {stroke: #AAA; stroke-width: 1;}#_ideogram .syntenyBorder {stroke:#AAA;stroke-width:1;}#_ideogram rect.cursor {  fill: #F00;  stroke: #F00;  fill-opacity: .3;  shape-rendering: crispEdges;}#_ideogram .brush .selection {  fill: #F00;  stroke: #F00;  fill-opacity: .3;  shape-rendering: crispEdges;}#_ideogram .noBands {fill: #AAA;}#_ideogram .gneg {fill: #FFF}#_ideogram .gpos25 {fill: #BBB}#_ideogram .gpos33 {fill: #AAA}#_ideogram .gpos50 {fill: #888}#_ideogram .gpos66 {fill: #666}#_ideogram .gpos75 {fill: #444}#_ideogram .gpos100 {fill: #000}#_ideogram .gpos {fill: #000}#_ideogram .acen {fill: #FDD}#_ideogram .stalk {fill: #CCE;}#_ideogram .gvar {fill: #DDF}#_ideogram.faint .gneg {fill: #FFF}#_ideogram.faint .gpos25 {fill: #EEE}#_ideogram.faint .gpos33 {fill: #EEE}#_ideogram.faint .gpos50 {fill: #EEE}#_ideogram.faint .gpos66 {fill: #EEE}#_ideogram.faint .gpos75 {fill: #EEE}#_ideogram.faint .gpos100 {fill: #DDD}#_ideogram.faint .gpos {fill: #DDD}#_ideogram.faint .acen {fill: #FEE}#_ideogram.faint .stalk {fill: #EEF;}#_ideogram.faint .gvar {fill: #EEF}#_ideogram .gneg {fill: url("#gneg")} #_ideogram .gpos25 {fill: url("#gpos25")} #_ideogram .gpos33 {fill: url("#gpos33")} #_ideogram .gpos50 {fill: url("#gpos50")} #_ideogram .gpos66 {fill: url("#gpos66")} #_ideogram .gpos75 {fill: url("#gpos75")} #_ideogram .gpos100 {fill: url("#gpos100")} #_ideogram .gpos {fill: url("#gpos100")} #_ideogram .acen {fill: url("#acen")} #_ideogram .stalk {fill: url("#stalk")} #_ideogram .gvar {fill: url("#gvar")} #_ideogram .noBands {fill: url("#noBands")} #_ideogram .chromosome {fill: url("#noBands")} ';function si(t){var e;this.config=JSON.parse(JSON.stringify(t)),(e=this).chromosomesArray=[],e.coordinateSystem="iscn",e.maxLength={bp:0,iscn:0},e.chromosomes={},e.numChromosomes=0,e.config.debug||(e.config.debug=!1),e.config.dataDir||(e.config.dataDir=e.getDataDir()),e.config.container||(e.config.container="body"),e.selector=e.config.container+" #_ideogram",e.config.resolution||(e.config.resolution=""),e.config.orientation||(e.config.orientation="vertical"),e.config.brush||(e.config.brush=null),e.config.rows||(e.config.rows=1),"showChromosomeLabels"in e.config==0&&(e.config.showChromosomeLabels=!0),e.config.showNonNuclearChromosomes||(e.config.showNonNuclearChromosomes=!1),e.config.chromosomeScale||(e.config.chromosomeScale="absolute"),e.config.showTools||(e.config.showTools=!1),function(t){t.config.ploidy||(t.config.ploidy=1),t.config.ploidy>1&&(t.sexChromosomes={},t.config.sex||(t.config.sex="male"),2!==t.config.ploidy||t.config.ancestors||(t.config.ancestors={M:"#ffb6c1",P:"#add8e6"},t.config.ploidyDesc="MP"))}(this),function(t){t.config.showBandLabels||(t.config.showBandLabels=!1),"showFullyBanded"in t.config==0&&(t.config.showFullyBanded=!0),t.bandsToShow=[],t.bandData={}}(this),function(t){var e,n,r;t.config.chrHeight||(e=t.config.container,n=document.querySelector(e).getBoundingClientRect(),r="vertical"===t.config.orientation?n.height:n.width,"body"!==e&&0!==r||(r=400),t.config.chrHeight=r)}(this),function(t){var e,n;t.config.chrWidth||(e=10,(n=t.config.chrHeight)<900&&n>500?e=Math.round(n/40):n>=900&&(e=Math.round(n/45)),t.config.chrWidth=e)}(this),function(t){t.config.geometry&&"collinear"===t.config.geometry?"chrMargin"in t.config==0&&(t.config.chrMargin=0):(t.config.chrMargin||(t.config.chrMargin=1===t.config.ploidy?10:Math.round(t.config.chrWidth/4)),t.config.showBandLabels&&(t.config.chrMargin+=20))}(this),function(t,e){t.onLoad&&(e.onLoadCallback=t.onLoad),t.onLoadAnnots&&(e.onLoadAnnotsCallback=t.onLoadAnnots),t.onDrawAnnots&&(e.onDrawAnnotsCallback=t.onDrawAnnots),t.onBrushMove&&(e.onBrushMoveCallback=t.onBrushMove),t.onBrushEnd&&(e.onBrushEndCallback=t.onBrushEnd),t.onCursorMove&&(e.onCursorMoveCallback=t.onCursorMove),t.onDidRotate&&(e.onDidRotateCallback=t.onDidRotate),t.onWillShowAnnotTooltip&&(e.onWillShowAnnotTooltipCallback=t.onWillShowAnnotTooltip),t.onClickAnnot&&(e.onClickAnnotCallback=t.onClickAnnot)}(t,this),function(t){t.organisms=Object.assign({},Ho),t.organismsWithBands=Object.assign({},t.organisms)}(this),function(t){t.bump=Math.round(t.config.chrHeight/125),t.adjustedBump=!1,t.config.chrHeight<200&&(t.adjustedBump=!0,t.bump=4)}(this),function(t,e){t.chromosome&&(e.config.chromosomes=[t.chromosome],"showBandLabels"in t==0&&(e.config.showBandLabels=!0),"rotatable"in t==0&&(e.config.rotatable=!1))}(t,this),function(t){const e=t.config;e.chrLabelSize||(t.config.chrLabelSize=9),e.chrLabelColor||(t.config.chrLabelColor="#000"),e.fontFamily||(t.config.fontFamily="");const n="font-family: "+e.fontFamily;ai+=`#_ideogram text {${n}; font-size: ${e.chrLabelSize}px; ${"fill: "+e.chrLabelColor};}`,ai+=`#_ideogramLabel text {${n};}`}(this),this.initAnnotSettings(),this.config.geometry&&"parallel"!==this.config.geometry||(this.config.chrMargin+=this.config.chrWidth,this.config.chrMargin+="heatmap"===this.config.annotationsLayout?this.config.annotTracksHeight:2*this.config.annotTracksHeight),this.init()}function li(t){var e,n,r,o,i=t.config;if(t.config.annotLabelHeight=12,"demarcateCollinearChromosomes"in t.config==0&&(t.config.demarcateCollinearChromosomes=!0),function(t,e,n,r){var o,i,a,s,l,c,u,h=r.config,f=h.chrLabelSize;for(o=0;o<t.length;o++){if(i=t[o],a=e[o]+23-f,c=r.chromosomesArray[o].id.split("-")[1],l=-40-200*(u=r.config.taxids.indexOf(c))-30,0===u?(s=-34,l+=2*r.config.chrWidth-16):s=2*r.config.chrWidth-24,h.showChromosomeLabels){const t=i.querySelector(".chrLabel > tspan");t.setAttribute("x",s),t.setAttribute("dy",f-8),i.querySelector(".chrLabel").setAttribute("text-anchor","start")}i.setAttribute("transform","rotate(90) translate("+a+","+l+")"),i.querySelector(".chromosome").setAttribute("transform","translate(-13, 10)")}!function(t){t.config.taxids.forEach((e,n)=>{var r=t.organisms[e].scientificName;Go.select(t.selector).append("text").attr("class","genomeLabel italic").attr("x",50+200*n).attr("y",10).text(r).attr("text-anchor","middle")})}(r)}(e=document.querySelectorAll(".chromosome-set"),n=function(t,e){var n,r,o,i,a,s,l={};for(n=[],r=0;r<t.length;r++)s=e.chromosomesArray[r].id.split("-")[1],i=e.chromosomesArray[o=0===r?r:r-1],0===r||s in l==0?(a=20,l[s]=1):a=n[o]+i.width+(e.config.showChromosomeLabels?0:2)+e.config.chrMargin,n.push(a);return n}(e,t),0,t),o=Math.round(n.slice(-1)[0]+70),i.multiorganism){r*=8;var a=0;n.forEach(t=>{t>a&&(a=t)}),r=a+30}else r=xOffsets.slice(-1)[0]+30;Go.select(t.selector).attr("height",r).attr("width",o),Go.select("#_ideogramTrackLabelContainer").remove(),Go.select("#_ideogramInnerWrap").insert("div",":first-child").attr("id","_ideogramTrackLabelContainer").style("position","absolute")}function ci(t){var e,n,r,o,i,a=t.config,s=a.annotationHeight||0;if("vertical"!==a.orientation){t.config.annotLabelHeight=12;var l=t.config.annotLabelHeight;if("demarcateCollinearChromosomes"in t.config==0&&(t.config.demarcateCollinearChromosomes=!0),e=document.querySelectorAll(".chromosome-set"),r=a.numAnnotTracks*(s+l+4)-a.chrWidth+1,function(t,e,n,r){var o,i,a,s,l,c,u,h=r.config,f=h.chrWidth,d=h.chrLabelSize;for(o=0;o<t.length;o++)i=t[o],s=e[o],a=r.chromosomesArray[o].id.split("-")[1],l=n+200*(c=h.taxids.indexOf(a)),0===c&&r.config.multiorganism?(u=d-4,l+=2*f+d):u=2*f+d+2,r.config.showChromosomeLabels&&(i.querySelector(".chrLabel").setAttribute("y",u),i.querySelector(".chrLabel").setAttribute("text-anchor","middle")),i.setAttribute("transform","translate("+s+","+l+")"),i.querySelector(".chromosome").setAttribute("transform","translate(-13, 10)");h.multiorganism&&function(t){t.config.taxids.forEach((e,n)=>{var r=t.config,o=t.organisms[e].scientificName;Go.select(t.selector).append("text").attr("class","genomeLabel italic").attr("x",5).attr("y",r.chrLabelSize+(200+3*r.chrWidth)*n).text(o)})}(r)}(e,n=function(t,e){var n,r,o,i,a,s,l={};for(n=[],r=0;r<t.length;r++)s=e.chromosomesArray[r].id.split("-")[1],i=e.chromosomesArray[o=0===r?r:r-1],0===r||s in l==0?(a=20,l[s]=1):a=n[o]+i.width+(e.config.showChromosomeLabels?0:2)+e.config.chrMargin,n.push(a);return n}(e,t),r,t),o=r+2*a.chrWidth+20,a.multiorganism){o*=8;var c=0;n.forEach(t=>{t>c&&(c=t)}),i=c+20}else i=n.slice(-1)[0]+20;Go.select(t.selector).attr("width",i).attr("height",o),Go.select("#_ideogramTrackLabelContainer").remove(),Go.select("#_ideogramInnerWrap").insert("div",":first-child").attr("id","_ideogramTrackLabelContainer").style("position","absolute")}else li(t)}function ui(t){void 0!==t.timeout&&window.clearTimeout(t.timeout),t.rawAnnots=t.setOriginalTrackIndexes(t.rawAnnots),t.config.annotationsDisplayedTracks?t.annots=t.updateDisplayedTracks(t.config.annotationsDisplayedTracks):(t.annots=t.processAnnotData(t.rawAnnots),t.config.filterable&&t.initCrossFilter(),t.drawProcessedAnnots(t.annots))}function hi(t){var e,n=(new Date).getTime(),r=this.config,o=r.annotations;this.initDrawChromosomes(),r.annotationsPath&&((e=this).rawAnnots?ui(e):function t(){e.timeout=setTimeout((function(){!e.rawAnnots||e.rawAnnots&&void 0!==e.rawAnnots.then?t():ui(e)}),50)}()),function(t,e){var n,r,o;if(!0===t.showBandLabels&&(r=(new Date).getTime(),e.hideUnshownBandLabels(),o=(new Date).getTime(),t.debug&&console.log("Time in showing bands: "+(o-r)+" ms"),"vertical"===t.orientation))for(n=0;n<e.chromosomesArray.length;n++)e.rotateChromosomeLabels(Go.select("#"+e.chromosomesArray[n].id),n);!0===t.showChromosomeLabels&&e.drawChromosomeLabels(e.chromosomes)}(r,this),r.brush?this.createBrush(r.brush):r.cursorPosition&&this.createClickCursor(r.cursorPosition),o&&(Array.isArray(o)?this.drawAnnots(o):(this.rawAnnots=o,this.afterRawAnnots(),ui(this))),function(t,e,n){var r=(new Date).getTime();t.debug&&console.log("Time in drawChromosome: "+(r-n)+" ms");var o=(new Date).getTime();t.debug&&console.log("Time constructing ideogram: "+(o-e)+" ms")}(r,t,n),this.setOverflowScroll(),"collinear"===r.geometry&&ci(this),this.onLoadCallback&&this.onLoadCallback()}class fi{constructor(t){this._config=t,this._description=this._normalize(this._config.ploidyDesc)}getChromosomesNumber(t){if(this._config.ploidyDesc){var e=this._config.ploidyDesc[t];return e instanceof Object?Object.keys(e)[0].length:e.length}return this._config.ploidy||1}_normalize(t){var e,n,r=[];if(!t)return t;for(e in t)"string"==typeof(n=t[e])?("vertical"===this._config.orientation&&(n=n.split("").reverse()),r.push({ancestors:n,existence:this._getexistenceArray(n.length)})):r.push({ancestors:Object.keys(n)[0],existence:n[Object.keys(n)[0]]});return r}_getexistenceArray(t){for(var e=[],n=0;n<t;n++)e.push("11");return e}getSetSize(t){return this._description?this._description[t].ancestors.length:1}getAncestor(t,e){return this._description?this._description[t].ancestors[e]:""}exists(t,e,n){return!this._description||Number(this._description[t].existence[e][n])>0}}class di{constructor(t){this._node=t}getLabel(){return Go.select(this._node.parentNode).select("text.chrLabel").text()}getSetLabel(){return Go.select(this._node.parentNode).select("text.chrSetLabel").text()}}class mi{constructor(t,e){this._config=t,this._ideo=e,this._ploidy=this._ideo._ploidy,this._translate=void 0,this.chrSetMargin="chrSetMargin"in t?t.chrSetMargin:this._config.ploidy>1?this._config.chrMargin:0,this._tickSize=8,this._isRotated=!1}_getLeftMargin(){return this.margin.left}_getYScale(){return 20/this._config.chrWidth}getChromosomeLabels(t){var e=new di(t),n=[];return this._ideo.config.ploidy>1&&n.push(e.getSetLabel()),n.push(e.getLabel()),n.filter((function(t){return t.length>0}))}getChromosomeBandLabelTranslate(t){var e,n,r,o=this._ideo,i=this._tickSize,a=o.config.orientation;return"vertical"===a?r="rotate(-90)translate("+(e=i)+","+(n=o.round(2+t.px.start+t.px.width/2))+")":"horizontal"===a&&(r="translate("+(e=o.round(-i+t.px.start+t.px.width/2))+","+(n=-10)+")"),{x:e,y:n,translate:r}}didRotate(t,e){var n,r,o,i,a,s,l,c,u;r=(n=this._ideo).config.taxid,o=e.id.split("-")[0].replace("chr",""),i=(a=n.chromosomes[r][o]).bands,c=(l=Go.select(e.parentNode)).attr("transform"),u=/scale\(.*\)/.exec(c),c=c.replace(u,""),l.attr("transform",c),s=a.width,(a=n.getChromosomeModel(i,o,r,t)).oldWidth=s,n.chromosomes[r][o]=a,n.drawChromosome(a),n.handleRotateOnClick(),n.rawAnnots&&(n.displayedTrackIndexes?n.updateDisplayedTracks(n.displayedTrackIndexes):(n.annots=n.processAnnotData(n.rawAnnots),n.drawProcessedAnnots(n.annots),n.config.filterable&&n.initCrossFilter())),!0===n.config.showBandLabels&&(n.drawBandLabels(n.chromosomes),n.hideUnshownBandLabels()),n.onDidRotateCallback&&n.onDidRotateCallback(a)}rotate(t,e,n){var r,o,i,a;a=(r=this._ideo).selector+" .chrSetLabel, "+r.selector+" .chrLabel",i=document.querySelector(r.selector).getBoundingClientRect(),o=Go.selectAll(r.selector+" g.chromosome").filter((function(){return this!==n})),this._isRotated?(this._isRotated=!1,r.config.chrHeight=r.config.chrHeightOriginal,r.config.chrWidth=r.config.chrWidthOriginal,r.config.annotationHeight=r.config.annotationHeightOriginal,this.rotateBack(t,e,n,(function(){o.style("display",null),Go.selectAll(a).style("display",null),r._layout.didRotate(e,n)}))):(this._isRotated=!0,o.style("display","none"),Go.selectAll(a).style("display","none"),this.rotateForward(t,e,n,(function(){var t,o,a;r.config.chrHeightOriginal=r.config.chrHeight,r.config.chrWidthOriginal=r.config.chrWidth,r.config.annotationHeightOriginal=r.config.annotationHeight,"VerticalLayout"===r._layout._class?(o=i.width-20,a=window.innerWidth-20):(o=i.height-10,a=window.innerHeight-10),t=a<o?a:o,r.config.chrHeight=t-=2*r.config.chrMargin,r.config.chrWidth*=2.3,r.config.annotationHeight*=1.7,r._layout.didRotate(e,n)})))}getChromosomeLabelClass(){return 1===this._config.ploidy?"chrLabel":"chrSetLabel"}_getAdditionalOffset(){var t=this._config;return(t.annotationHeight||0)*(t.annotationsNumTracks||t.numAnnotTracks||1)}_getChromosomeSetSize(t){return this._ploidy.getSetSize(t)*this._config.chrWidth*2+this.chrSetMargin}getChromosomeSetLabelAnchor(){return"middle"}getChromosomeLabelYPosition(){return-5.5}getChromosomeSetLabelYPosition(t){return 1===this._config.ploidy?this.getChromosomeLabelYPosition(t):-2*this._config.chrWidth}}class pi extends mi{constructor(t,e){super(t,e),this._class="VerticalLayout",this.margin={top:30,left:15}}rotateForward(t,e,n,r){var o="translate(20, 25) "+this.getChromosomeScale(n);Go.select(n.parentNode).transition().attr("transform",o).on("end",r);var i=this.getChromosomeLabels(n),a=1.3*(20+this._config.chrWidth);Go.select(this._ideo.getSvg()).append("g").attr("class","tmp").selectAll("text").data(i).enter().append("text").attr("class",(function(t,e){return 0===e&&2===i.length?"chrSetLabel":null})).attr("x",0).attr("y",a).style("opacity",0).text(String).transition().style("opacity",1),this._ideo.config.orientation="horizontal"}rotateBack(t,e,n,r){var o=this.getChromosomeScaleBack(n),i=this.getChromosomeSetTranslate(t);Go.select(n.parentNode).transition().attr("transform",i+" "+o).on("end",r),Go.selectAll(this._ideo.selector+" g.tmp").style("opacity",0).remove(),this._ideo.config.orientation="vertical"}getHeight(){return this._config.chrHeight+1.5*this.margin.top}getWidth(){return"97%"}getChromosomeBandTickY1(){return 2}getChromosomeBandTickY2(){return 10}getChromosomeSetLabelTranslate(){return"rotate(-90)"}getChromosomeBandLabelAnchor(){return null}getChromosomeScale(t){var e,n;return e=Go.select(this._ideo.selector).node().getBoundingClientRect(),n=t.getBoundingClientRect(),"scale("+e.width/n.height*.97+", "+this._getYScale()+")"}getChromosomeScaleBack(t){var e,n,r;return n=(r=this._ideo.config).taxid,e=t.id.split("-")[0].replace("chr",""),"scale("+this._ideo.chromosomes[n][e].oldWidth/(3*r.chrHeight)*.97+", "+1/this._getYScale()+")"}getChromosomeSetTranslate(t){return"rotate(90) translate("+this.margin.top+", -"+this.getChromosomeSetYTranslate(t)+")"}getChromosomeSetYTranslate(t){var e,n=this._getAdditionalOffset(),r=this._config,o=r.chrMargin,i=r.chrWidth;if(!r.ploidyDesc)return"histogram"===r.annotationsLayout?o+t*(o+i+3)+2*r.barWidth:(e=i+t*(o+i)+2*n+("legendPad"in r?r.legendPad:0),n>0?e:e+4+2*t);if(!this._translate){this._translate=[this._ploidy.getSetSize(0)*i*2];for(var a=1;a<this._config.ploidyDesc.length;a++)this._translate[a]=this._translate[a-1]+this._getChromosomeSetSize(a-1)}return this._translate[t]}getChromosomeSetLabelXPosition(){return this._config.chrWidth*this._config.ploidy/-2}getChromosomeLabelXPosition(){return this._config.chrWidth/-2}}class gi extends mi{constructor(t,e){super(t,e),this._class="HorizontalLayout",this.margin={left:20,top:30}}_getLeftMargin(){var t=mi.prototype._getLeftMargin.call(this);return this._config.ploidy>1&&(t*=1.8),t}rotateForward(t,e,n,r){var o;Go.select(n.parentNode).transition().attr("transform","rotate(90) translate(30, -37.5) ").on("end",r),o=this.getChromosomeLabels(n),Go.select(this._ideo.getSvg()).append("g").attr("class","tmp").selectAll("text").data(o).enter().append("text").attr("class",(function(t,e){return 0===e&&2===o.length?"chrSetLabel":null})).attr("x",26).attr("y",(function(t,e){return 12*(e+1+o.length%2)})).style("text-anchor","middle").style("opacity",0).text(String).transition().style("opacity",1),this._ideo.config.orientation="vertical"}rotateBack(t,e,n,r){var o=this.getChromosomeSetTranslate(t);Go.select(n.parentNode).transition().attr("transform",o).on("end",r),Go.selectAll(this._ideo.selector+" g.tmp").style("opacity",0).remove(),this._ideo.config.orientation="horizontal"}getHeight(t){void 0===t&&(t=this._config.taxids[0]);var e=this._config.chromosomes[t].length,n=this.getChromosomeSetYTranslate(e-1);return(n+=this._getChromosomeSetSize(e-1))+2*this._getAdditionalOffset()}getWidth(){return this._config.chrHeight+1.5*this.margin.top}getChromosomeSetLabelAnchor(){return"end"}getChromosomeBandLabelAnchor(){return null}getChromosomeBandTickY1(){return 2}getChromosomeBandTickY2(){return 10}getChromosomeSetLabelTranslate(){return null}getChromosomeSetTranslate(t){return"translate("+this._getLeftMargin()+", "+this.getChromosomeSetYTranslate(t)+")"}getChromosomeSetYTranslate(t){if(!this._config.ploidyDesc)return this._config.chrMargin*(t+1);if(!this._translate){this._translate=[1];for(var e=1;e<this._config.ploidyDesc.length;e++)this._translate[e]=this._translate[e-1]+this._getChromosomeSetSize(e-1)}return this._translate[t]}getChromosomeSetLabelXPosition(t){return 1===this._config.ploidy?this.getChromosomeLabelXPosition(t):-20}getChromosomeSetLabelYPosition(t){var e=this._ploidy.getSetSize(t),n=this._config;return 1===n.ploidy?n.chrWidth/2+3:e*n.chrMargin/2}getChromosomeLabelXPosition(){return-8}getChromosomeLabelYPosition(){return this._config.chrWidth}}class yi extends mi{constructor(t,e){super(t,e),this._class="PairedLayout",this.margin={left:30}}getHeight(){return this._config.chrHeight+1.5*this.margin.left}getWidth(){return"97%"}getChromosomeBandTickY1(t){return t%2?this._config.chrWidth:2*this._config.chrWidth}getChromosomeBandTickY2(t){var e=this._config.chrWidth;return t%2?e-this._tickSize:2*e+this._tickSize}getChromosomeBandLabelAnchor(t){return t%2?null:"end"}getChromosomeBandLabelTranslate(t,e){var n=e%2?10:-this._config.chrWidth-10,r=this._ideo.round(t.px.start+t.px.width/2)+3;return{x:r,y:r,translate:"rotate(-90) translate("+n+", "+r+")"}}getChromosomeLabelXPosition(){return-this._tickSize}getChromosomeSetLabelXPosition(){return this._config.chrWidth/-2}getChromosomeSetLabelTranslate(){return"rotate(-90)"}getChromosomeSetTranslate(t){var e=this.getChromosomeSetYTranslate(t);return"rotate(90) translate("+this.margin.left+", -"+e+")"}getChromosomeSetYTranslate(t){return 200*(t+1)}}class vi extends mi{constructor(t,e){super(t,e),this._class="SmallLayout",this.margin={left:36.5,top:10};var n=this._ideo.getTaxid(this._ideo.config.organism);this.chrs=t.chromosomes[n],this.chrsPerRow=Math.ceil(this.chrs.length/t.rows)}getHeight(){return this._config.rows*(1.25*this._config.chrHeight+this.margin.top)}getWidth(){return"97%"}getChromosomeBandLabelTranslate(){}getChromosomeSetLabelTranslate(){return"rotate(-90)"}getChromosomeSetTranslate(t){var e,n;return t>this.chrsPerRow-1?(e=this.margin.left+1.3*this._config.chrHeight,n=this.getChromosomeSetYTranslate(t-this.chrsPerRow)):(e=this.margin.left,n=this.getChromosomeSetYTranslate(t)),"rotate(90) translate("+e+", -"+n+")"}getChromosomeSetYTranslate(t){var e=.3*this._getAdditionalOffset();return this.margin.left*t+this._config.chrWidth+2*e+e*t}getChromosomeSetLabelXPosition(t){return(this._ploidy.getSetSize(t)*this._config.chrWidth+20)/-2+(this._config.ploidy>1?0:this._config.chrWidth)}getChromosomeLabelXPosition(){return this._config.chrWidth/-2}}function bi(t){this.config.annotationsPath&&this.fetchAnnots(this.config.annotationsPath),function(t){if("ploidyDesc"in t.config&&"string"==typeof t.config.ploidyDesc){for(var e=[],n=0;n<t.numChromosomes;n++)e.push(t.config.ploidyDesc);t.config.ploidyDesc=e}t._ploidy=new fi(t.config)}(this),this._layout=function(t){var e=t.config;return"perspective"in e&&"comparative"===e.perspective?new yi(e,t):"rows"in e&&e.rows>1?new vi(e,t):"vertical"===e.orientation?new pi(e,t):"horizontal"===e.orientation?new gi(e,t):new pi(e,t)}(this),Go.selectAll(this.config.container+" #_ideogramOuterWrap").remove(),Go.select(this.config.container).append("div").attr("id","_ideogramOuterWrap").append("div").attr("id","_ideogramTrackLabelContainer").style("position","absolute"),Go.select(this.config.container+" #_ideogramOuterWrap").append("div").attr("id","_ideogramMiddleWrap").style("position","relative").style("overflow-x","auto").style("transform","translateZ(0)").append("div").attr("id","_ideogramInnerWrap").append("svg").attr("id","_ideogram").attr("class",function(t){var e="";return t.config.showChromosomeLabels&&(e+="horizontal"===t.config.orientation?"labeledLeft ":"labeled "),!1===t.config.rotatable&&(e+="no-rotate "),t.config.annotationsLayout&&"overlay"===t.config.annotationsLayout&&(e+="faint"),e}(this)).attr("width",this._layout.getWidth()).attr("height",this._layout.getHeight()).html(this.getBandColorGradients()),this.isOnlyIdeogram=1===document.querySelectorAll("#_ideogram").length,function(t){Go.select(t.config.container+" #_ideogramOuterWrap").append("div").attr("class","_ideogramTooltip").attr("id","_ideogramTooltip").style("opacity",0).style("position","fixed").style("text-align","center").style("padding","4px").style("font","12px sans-serif").style("background","white").style("border","1px solid black").style("border-radius","5px").style("z-index","1000")}(this),this.finishInit(t)}var wi="";function xi(t,e,n){return n.config.dataDir+t[e]}function _i(t,e,n){return"sex"in n.config&&(2===n.config.ploidy&&n.sexChromosomes.index+1===e||"female"===n.config.sex&&"Y"===t.name)}function Ai(t,e,n,r){var o,i,a,s,l;for(o=0;o<e.length;o++)a=e[o],void 0!==t&&(i=t[o]),l=o+r.config.taxids.indexOf(n),s=r.getChromosomeModel(i,a,n,l),"string"!=typeof a&&(a=a.name.split(" ").slice(-1)[0].replace("chr","")),r.chromosomes[n][a]=s,r.chromosomesArray.push(s),_i(s,o,r)||r.drawChromosome(s)}function Ci(t,e){"undefined"!=typeof chrBands&&t.length>=chrBands.length/2&&(e.coordinateSystem="bp")}function ki(){var t,e,n,r,o=this.config.taxids;for(e=0;e<o.length;e++)n=this.config.chromosomes[t=o[e]],r=this.bandsArray[t],this.config.showNonNuclearChromosomes||(n=n.filter(t=>"MT"!==t),void 0!==r&&(r=r.filter(t=>"MT"!==t[0].chr))),Ci(n,this),this.chromosomes[t]={},this.setSexChromosomes(n),Ai(r,n,t,this),this.config.showBandLabels&&this.drawBandLabels(this.chromosomes),this.handleRotateOnClick(),this._gotChrModels=!0}function Si(){var t=this;"rotatable"in t.config&&!1===t.config.rotatable?Go.selectAll(t.selector).style("cursor","default"):Go.selectAll(t.selector+" .chromosome-set").on("click",(function(){t.rotateAndToggleDisplay(this.children[1])}))}function Ei(){call(this.onLoadCallback)}function Li(t,e,n){var r=n.organisms[t],o=[ei(r.scientificName)],i=r.assemblies,a=n.config.resolution;return e!==i.default&&o.push(e),"9606"===t&&(e in i==="false"&&Object.values(i).includes(config.assembly)||""!==a&&850!==a)&&o.push(a),o=o.join("-"),["9606","10090","10116"].includes(t)&&!n.config.showFullyBanded&&(o+="-no-bands"),o+".json"}function Ti(t,e,n){var r,o,i,a=n.config;return r=n.organisms[t],a.assembly||(n.config.assembly="default"),o=r.assemblies,i=Li(t,n.assemblyIsAccession()?a.assembly:o[a.assembly],n),(t in n.organismsWithBands||"-1"===t)&&(e[t]=i),e}function Mi(t,e,n,r){return function(t,e,n){var r=xi(t,e,n);return(!(void 0!==window.chrBands&&""===wi)||wi!==r)&&function(t){return"assembly"in t.config&&!1===/(GCA_)/.test(t.config.assembly)}(n)&&e in t}(e,t,r)?function(t,e,n,r){var o=xi(t,e,r);return r.numBandDataResponses||(r.numBandDataResponses=0),Vo(o).then((function(e){return e.json().then((function(n){wi=o,delete window.chrBands,window.chrBands=n.chrBands,function(t,e,n,r){var o,i,a;for(o in e)t.includes(a=e[o])&&""!==a&&(i=o);r.bandData[i]=n}(e.url,t,chrBands,r)}))}))}(e,t,0,r).then((function(){return r.processBandData(t)})):new Promise((function(e){r.processBandData(t),e([t,void 0])}))}var Pi={},Ni={},Ii={};function Oi(t){var e=(t=t||this).config.container;Ii[e]?(Ni[e]=!0,Pi[e]=t):(Ii[e]=!0,function(t){return new Promise((function(e){var n=t.config.organism;"number"==typeof n?t.getOrganismFromEutils(n,(function(){t.getTaxids(e)})):t.getTaxids(e)}))}(t).then((function(n){t.config.taxid=n[0],t.config.taxids=n,t.organismScientificName=t.getScientificName(t.config.taxid),function(t,e,n){var r,o,i,a=[];for(i in r={},Ho)r[i]="";for(o=0;o<t.length;o++)r=Ti(i=String(t[o]),r,n),a.push(Mi(i,r,0,n));Promise.all(a).then((function(t){var r,i,a;for(o=0;o<t.length;o++)i=(r=t[o])[0],a=r[1],"bandsArray"in n==0&&(n.bandsArray={}),n.bandsArray[i]=a;n.writeContainer(e)}))}(n,(new Date).getTime(),t),Ii[e]=!1,Ni[e]&&(Ni[e]=!1,Oi(Pi[e]))})))}class Fi{constructor(t,e){this.rawAnnots=this.parseBed(t,e)}static componentToHex(t){var e=parseInt(t,10).toString(16);return 1===e.length?"0"+e:e}static rgbToHex(t,e,n){return"#"+Fi.componentToHex(t)+Fi.componentToHex(e)+Fi.componentToHex(n)}parseGenomicCoordinates(t,e){var n,r,o,i;return n=t[0],r=parseInt(t[1],10),i=(o=parseInt(t[2],10))-r,e&&(n=n.slice(3)),[n,r,o,i]}parseAnnotFromTsvLine(t,e,n){var r,o,i,a,s,l,c=t.split(/\s/g);return[i,a,stop,length]=this.parseGenomicCoordinates(c,n),-1===(o=e.indexOf(i))?[null,null]:(r=["",a,length,0],c.length>=4&&(r[0]=c[3]),c.length>=8&&(s=c[8].split(","),l=Fi.rgbToHex(s[0],s[1],s[2]),r.push(l)),[o,r])}parseRawAnnots(t,e,n,r){var o,i,a,s,l,c;for(c=!0,!1===isNaN(parseInt(n[e],10))&&(c=!1),o=e;o<n.length;o++)i=n[o],[a,s]=this.parseAnnotFromTsvLine(i,r,c),null!==a&&t[a].annots.push(s);return l=["name","start","length","trackIndex"],n[e].length>=8&&l.push("color"),{keys:l,annots:t}}parseBed(t,e){var n,r,o,i=[],a=t.split(/\r\n|\n/);for(r=Object.keys(e.chromosomes[e.config.taxid]),n=0;n<r.length;n++)i.push({chr:r[n],annots:[]});return o=0,("chr"===a[0].slice(0,3)||isNaN(parseInt(a[0],10)))&&(o=1),this.parseRawAnnots(i,o,a,r)}}class ji{constructor(t,e){this.rawAnnots=this.parseTsv(t,e)}parseGenomicCoordinates(t){var e,n;return[t[1],e=parseInt(t[2],10),e+(n=parseInt(t[3],10)),n]}getValueColumnIndex(t,e){let n;return e.split(/\t/g).forEach((e,r)=>{e.includes(t)&&(n=r)}),n}parseAnnotFromTsvLine(t,e,n){var r,o,i,a,s,l=t.split(/\t/g);return[i,a,stop,length]=this.parseGenomicCoordinates(l),-1===(o=n.indexOf(i))?[null,null]:(r=[l[0],a,length,0],e.includes("color")&&(s=this.getValueColumnIndex("color",e),r.push(l[s])),e.includes("full_name")&&(s=this.getValueColumnIndex("full_name",e),r.push(l[s])),e.includes("citations")&&(s=this.getValueColumnIndex("citations",e),r.push(l[s])),e.includes("significance")&&(s=this.getValueColumnIndex("significance",e),r.push(l[s])),[o,r])}parseRawAnnots(t,e,n,r){var o,i,a,s,l;const c=n[0];for(o=e;o<n.length;o++)0!==(i=n[o]).length&&([a,s]=this.parseAnnotFromTsvLine(i,c,r),null!==a&&t[a].annots.push(s));return l=["name","start","length","trackIndex"],c.includes("color")&&l.push("color"),c.includes("full_name")&&l.push("fullName"),c.includes("citations")&&l.push("citations"),c.includes("significance")&&l.push("significance"),{keys:l,annots:t}}parseTsv(t,e){var n,r,o,i,a=[],s=t.split(/\r\n|\n/);for(r=Object.keys(e.chromosomes[e.config.taxid]),n=0;n<r.length;n++)a.push({chr:r[n],annots:[]});if(o=0,("chr"===s[0].slice(0,3)||isNaN(parseInt(s[0],10)))&&(o=1),i=this.parseRawAnnots(a,o,s,r),1===o&&s[0].includes("citations")){const t=s[0].split("\t"),e=6,n=t[e].split("citations_")[1];i.annots=i.annots.map(t=>(t.annots=t.annots.map(t=>(t[e]=t[e]+" citations "+n.replace(/_/g," "),t)),t))}return i}}var Bi=["name","start","length","trackIndex","trackIndexOriginal","color"],Di={3:["00B","DDD","F00"],5:["00D","66D","DDD","F88","F00"],17:["00D","00D","00D","00D","00D","44D","44D","DDD","DDD","DDD","DDD","F88","F66","F22","F22","F00","F00","F00"]};function Ri(t){var e,n,r;if(t.rawAnnots.metadata&&t.rawAnnots.metadata.trackLabels)e=t.rawAnnots.metadata.trackLabels;else if(t.config.heatmaps)for(e=[],n=t.config.heatmaps,r=0;r<n.length;r++)e.push(n[r].key);else e=t.rawAnnots.keys.slice(0).filter(t=>!Bi.includes(t));return t.displayedTrackIndexes&&(e=e.filter((function(e,n){return t.displayedTrackIndexes.includes(n+1)}))),e}function zi(t){var e,n,r=t.rawAnnots;if(!r.metadata||r.metadata.heatmapThresholds||t.config.heatmapThresholds)return n=Di[(e=t.config.heatmapThresholds?t.config.heatmapThresholds:t.rawAnnots.metadata.heatmapThresholds).length+1],(e=e.map((t,e)=>[t,"#"+n[e]])).push(["+","#"+n.slice(-1)[0]]),e}function Wi(t,e,n,r,o){return t===e&&"+"===o&&n>r||n===o||0!==t&&t!==e&&n<=o&&n>r||0===t&&n<=o}function Hi(t,e){var n,r,o,i,a,s,l,c;for(n=0;n<t.length;n++)r=t.length-1,i=(o=t[n])[0],a=parseFloat(i),!1===isNaN(a)&&(i=a),0!==n&&(l=parseFloat(t[n-1][0])),s=o[1],Wi(n,r,e,l,i)&&(c=s);return c}function Gi(t,e,n){var r,o,i,a,s,l=t.width,c=[],u=n.config.annotLabelHeight,h=n.config.numAnnotTracks;for(r=0;r<h;r++)i=n.config.annotationHeight+u+4,s=t.id+"-canvas-"+r,o=e,t.chrIndex>0&&(o+=n.config.chrMargin*t.chrIndex-1),a=Go.select(n.config.container+" #_ideogramInnerWrap").append("canvas").attr("id",s).attr("width",l+1).attr("height",i).style("position","absolute").style("left",o+"px").style("top",i*r+1+"px").nodes()[0].getContext("2d"),c.push([a,t]);return c}function $i(t,e,n){var r,o,i,a,s=n.config.annotLabelHeight,l=n.config.annotationHeight,c=n.config.demarcateCollinearChromosomes,u=l+s+4;for(r=0;r<t.length;r++)if(a=e[(o=t[r]).trackIndex][1],(i=e[o.trackIndex][0]).fillStyle=o.color,c){if(o.startPx<1||o.startPx>a.width-1)continue;i.fillRect(o.startPx,1,.5,u)}else i.fillRect(o.startPx,s+1,.5,l);if(c)for(r=0;r<e.length;r++)a=e[r][1],(i=e[r][0]).fillStyle="#555",0===a.chrIndex&&i.fillRect(0,0,1,u),i.fillRect(a.width-1,0,1.1,u),i.fillRect(0,0,a.width+1,1),n.config.chrMargin&&i.fillRect(0,0,1.1,u)}function qi(t,e,n){var r,o,i=n.config.annotationHeight,a=n._layout.margin.top;for(o=t.values,r=0;r<o.length;r++)e.fillStyle=o[r],e.fillRect((r-1)*i,t.startPx+a,i,2)}function Vi(t,e,n,r,o,i,a){var s,l,c,u,h,f,d,m=a.config.heatmapThresholds;for(s=0;s<n.annots.length;s++){for(u=n.annots[s],(c={}).values=[],l=0;l<3;l++)c[i[l]]=u[l];for(l=3;l<i.length;l++)d=Hi(m,u[l]),c.values.push(d);h=c.start+c.length,c.chr=n.chr,c.chrIndex=o,c.startPx=a.convertBpToPx(r,c.start),f=a.convertBpToPx(r,h),c.px=Math.round((c.startPx+f)/2),t.push(c)}return t.shift(),[t,e]}function Yi(t){!1!==t.config.showTrackLabel&&(t.hideTrackLabelTimeout=window.setTimeout((function(){Go.select(t.config.container+" #_ideogramTrackLabel").transition().duration(500).style("opacity",0)}),250))}function Xi(t,e,n,r){var o,i,a,s,l,c=[],u=r.config.numAnnotTracks;for(o=0;o<u;o++)l=t.id+"-canvas-"+o,i=e-(a=r.config.annotationHeight)*(u-o)-7,s=Go.select(r.config.container+" #_ideogramInnerWrap").append("canvas").attr("id",l).attr("width",a).attr("height",n).style("position","absolute").style("left",i+"px").nodes()[0].getContext("2d"),c.push(s);return c}function Ui(t,e,n,r){var o,i,a;for(o=0;o<t.length;o++)(a=e[(i=t[o]).trackIndex]).fillStyle=i.color,a.fillRect(i.trackIndex-1,i.startPx+r,n,.5)}function Ji(t){var e,n,r=this,o=r.config,i=r._layout.margin.top,a=o.chrHeight+i;if("collinear"===o.geometry)return function(t,e){var n,r,o=0,i=e.config.showChromosomesLabels?2:-.1;for(Go.select(e.selector).classed("labeledLeft",!1),Go.selectAll(e.config.container+" canvas").remove(),r=0;r<t.length;r++)0===r?n=12:(n=o+e.chromosomesArray[r-1].width+14,o+=e.chromosomesArray[r-1].width+i),$i(t[r].annots,Gi(e.chromosomesArray[r],n,e),e);(function(t){!function(t,e){var n,r,o,i,a=e.config.annotLabelHeight;for(i=e.config.demarcateCollinearChromosomes?2:0,(o=Go.select(e.config.container+" #_ideogramTrackLabelContainer")).html(""),r=e.config.annotationHeight+a+4,n=0;n<t.length;n++)o.style("position","absolute").append("div").attr("class","_ideogramTrackLabel").style("opacity",1).style("position","absolute").style("text-align","center").style("padding","1px").style("font","11px sans-serif").style("background","white").style("line-height","10px").style("z-index","5").style("left",11+i+"px").style("top",r*n+i+"px").style("width","max-content").style("transform-origin","bottom left").style("text-align","left").html(t[n])}(Ri(t),t)})(e),e.onDrawAnnotsCallback&&e.onDrawAnnotsCallback()}(t,r);if("heatmap-2d"===o.annotationsLayout)return function(t,e){var n,r,o=e.config.container,i=e.config.chrHeight+e._layout.margin.top,a=e.config.annotationHeight*t[0].values.length;for(Go.selectAll(o+" canvas").remove(),Go.select(o+" #_ideogramInnerWrap").style("max-width",a+"px"),Go.select(o+" #_ideogram").attr("width",a),n=function(t,e,n,r){var o,i;return i=t.id+"-canvas",o=2*r.config.chrWidth+r.config.annotationHeight-.5,Go.select(r.config.container+" #_ideogramInnerWrap").append("canvas").attr("id",i).attr("width",n).attr("height",e).style("position","absolute").style("left",o+"px").style("top","0px").nodes()[0].getContext("2d")}(e.chromosomesArray[0],i,a,e),r=0;r<t.length;r++)qi(t[r],n,e);e.onDrawAnnotsCallback&&e.onDrawAnnotsCallback()}(t,r);for(Go.selectAll(r.config.container+" canvas").remove(),function(t){Go.select(t.config.container+" #_ideogramTrackLabelContainer").append("div").attr("id","_ideogramTrackLabel").style("opacity",0).style("position","absolute").style("text-align","center").style("padding","1px").style("font","11px sans-serif").style("background","white").style("line-height","10px").style("z-index","9000")}(r),n=0;n<t.length;n++)e=r.config.chrWidth,Ui(t[n].annots,Xi(r.chromosomesArray[n],r._layout.getChromosomeSetYTranslate(n),a,r),e,i);Go.selectAll(r.config.container+" canvas").on("mouseover",(function(){!function(t,e){var n,r,o;clearTimeout(e.hideTrackLabelTimeout),n=(n=Ri(e)).join("<br>"),Go.select(e.config.container+" #_ideogramTrackLabel").interrupt().style("top","").style("left","").style("transform",null).style("transform","rotate(-90deg)").html(n),[r,o]=function(t,e,n){var r,o,i,a,s;return r=e.id.split("-").slice(0,-1).join("-")+"-0",o=Go.select(n.config.container+" #"+r).nodes()[0].getBoundingClientRect(),i=Go.select(n.config.container+" #_ideogramTrackLabel").nodes()[0].getBoundingClientRect(),a=Go.select(n.config.container).nodes()[0].getBoundingClientRect(),s=Math.round(o.left+i.width)-o.width-1,[s-=a.left-7,-(t.split("<br>").length-2)*o.width+2]}(n,t,e),function(t,e,n){Go.select(n.config.container+" #_ideogramTrackLabel").style("opacity",1).style("left",e+"px").style("top",t+"px").style("width","max-content").style("transform-origin","bottom left").style("text-align","left").on("mouseover",(function(){clearTimeout(n.hideTrackLabelTimeout)})).on("mouseout",(function(){Yi(n)}))}(o,r,e)}(this,r)})).on("mouseout",(function(){Yi(r)})),r.onDrawAnnotsCallback&&r.onDrawAnnotsCallback()}function Qi(t,e,n){var r,o,i,a,s,l,c=[];for(r=0;r<e.length;r++)for(i=e[r],o=0;o<t.length;o++)a=i.slice(0,3),l=Hi(n.config.heatmaps[o].thresholds,s=i[t[o]]),a.push(o,l,s),c.push(a);return c}function Ki(t){var e,n,r,o=(new Date).getTime(),i=t.keys,a=t.annots;for(n=[],r=0;r<this.config.heatmaps.length;r++)n.push(i.indexOf(this.config.heatmaps[r].key));e=function(t,e,n){var r,o,i,a,s=[];for(a=0;a<e.length;a++)o=(r=e[a]).chr,i=Qi(t,r.annots,n),s.push({chr:o,annots:i});return s}(n,a,this),i.splice(3,0,"trackIndex"),i.splice(4,0,"color"),this.rawAnnots.keys=i,this.rawAnnots.annots=e,function(t,e){var n=(new Date).getTime();e.config.debug&&console.log("Time in deserializeAnnotsForHeatmap: "+(n-t)+" ms")}(o,this)}function Zi(){call(this.onLoadAnnotsCallback)}function ta(){call(this.onDrawAnnotsCallback)}function ea(){!1!==this.config.showAnnotTooltip&&(this.hideAnnotTooltipTimeout=window.setTimeout((function(){Go.select("._ideogramTooltip").transition().duration(500).style("opacity",0).style("pointer-events","none")}),250))}function na(t){call(this.onWillShowAnnotTooltipCallback,t)}function ra(t){this.onClickAnnotCallback(t)}function oa(t,e){var n,r,o,i,a=Number(e.getAttribute("cx")),s=Number(e.getAttribute("cy"));!1!==this.config.showAnnotTooltip&&(clearTimeout(this.hideAnnotTooltipTimeout),this.onWillShowAnnotTooltipCallback&&(t=this.onWillShowAnnotTooltipCallback(t)),(i=Go.select("._ideogramTooltip")).interrupt(),n=e.getScreenCTM().translate(a,s),[r,o]=function(t){var e,n,r;return r="chr"+t.chr+":"+t.start.toLocaleString(),t.length>0&&(r+="-"+t.stop.toLocaleString()),e=r,n=24,t.name&&(e=(t.displayName?t.displayName:t.name)+"<br/>"+e,n+=8),[e,n]}(t),function(t,e,n,r,o){t.html(e).style("opacity",1).style("left",n.e+"px").style("top",n.f-r+"px").style("font-family",o.config.fontFamily).style("pointer-events",null).on("mouseover",(function(){clearTimeout(o.hideAnnotTooltipTimeout)})).on("mouseout",(function(){o.startHideAnnotTooltipTimeout()}))}(i,r,n,o,this))}function ia(t){return"ideogramLabel_"+t.domId}function aa(t,e,n){Go.selectAll("._ideoActive").classed("_ideoActive",!1),Go.select("#"+e).attr("class","_ideogramLabel "+t),Go.select("#"+n+" > path").attr("class",t)}function sa(t,e){let n,r;const o=t.target,i=t.type;if(Array.from(o.classList).includes("_ideogramLabel"))n=o.id,r=o.id.split("ideogramLabel_")[1],Go.select("#"+r+" path").dispatch(i);else{const t=o.parentElement;n="ideogramLabel_"+t.id,r=t.id}"mouseout"===i&&(e.time.prevTooltipOff=performance.now(),e.time.prevTooltipAnnotDomId=r),"mouseover"===i?(clearTimeout(window._ideoActiveTimeout),aa("_ideoActive",n,r)):window._ideoActiveTimeout=window.setTimeout((function(){aa("",n,r)}),250)}function la(t,e){var n,r=!1;return e.annots.forEach(e=>{r||e.annots.forEach(e=>{r||e.name===t&&(n=e,r=!0)})}),n}function ca(t,e){var n,r,o,i,a,s,l,c=e.config;return null===(n=document.querySelector("#"+t.domId))?null:(r=n.getBoundingClientRect(),o=document.querySelector("#_ideogram").getBoundingClientRect(),i=ii(t.name,e).width,{top:s=r.top-o.top+(a=c.annotLabelSize?c.annotLabelSize:13)-1,bottom:s+a,right:(l=r.left-o.left-(i+=c.fontFamily?9:7))+i,left:l,width:i,height:a})}function ua(t,e,n){var r;const o=ca(r=la(t,this),this);null!==o&&function(t,e,n){n.didSetLabelStyle||(document.querySelector("#_ideogramInnerWrap").insertAdjacentHTML("afterbegin","\n  <style>\n    #_ideogram .annot path, ._ideogramLabel {\n      cursor: pointer;\n    }\n\n    #_ideogram .annot path {\n      stroke-width: 1px;\n      stroke: white;\n      stroke-linejoin: bevel;\n    }\n\n    #_ideogram ._ideogramLabel._ideoActive {\n      fill: #77F !important;\n      stroke: #F0F0FF !important;\n    }\n\n    #_ideogram .annot > ._ideoActive {\n      stroke: #D0D0DD !important;\n      stroke-width: 1.5px;\n    }\n\n    #_ideogram ._ideogramLabel {\n      stroke: white;\n      stroke-width: 5px;\n      stroke-linejoin: round;\n      paint-order: stroke fill;\n      text-align: center;\n    }\n  </style>\n  "),n.didSetLabelStyle=!0);const r=ia(t),o=oi(n),i="pink"===t.color?"#CF406B":t.color;Go.select("#_ideogram").append("text").attr("id",r).attr("class","_ideogramLabel").attr("x",e.left).attr("y",e.top).style("font",o).style("fill",i).style("pointer-events",null).html(t.name)}(r,Object.assign(o,{backgroundColor:e,borderColor:n}),this)}function ha(t=[]){const e=this;t=t.slice(),e.clearAnnotLabels();const n=[],r=[];0===t.length&&(t=e.flattenAnnots()),t.forEach((t,o)=>{const i=ca(t,e);null!==i&&(r.length>1&&r.some((t,e)=>t.left<=i.right&&t.right>=i.left&&(t.top<i.bottom&&t.bottom>i.top||i.top<t.bottom&&i.bottom>t.bottom))||(n.push(t),r.push(i)))}),n.reverse(),n.forEach(t=>{e.addAnnotLabel(t.name)}),Go.selectAll("._ideogramLabel, .annot").on("mouseover",t=>sa(t)).on("mouseout",t=>sa(t,e)).on("click",t=>sa(t))}function fa(t){const e=ia(la(t,this));document.querySelector("#"+e).remove()}function da(){document.querySelectorAll("._ideogramLabel").forEach(t=>{t.remove()})}function ma(t){var e,n,r=!1,o=(new Date).getTime();return e=this.chromosomes[this.config.taxid],"histogramScaling"in this.config==0&&(this.config.histogramScaling="absolute"),void 0===this.maxAnnotsPerBar&&(this.maxAnnotsPerBar={},r=!0),function(t,e,n){var r,o,i,a,s,l,c;if(e||"relative"===n.config.histogramScaling){for(r=0,o=0;o<t.length;o++){for(i=0,a=t[o].annots,s=t[o].chr,l=0;l<a.length;l++)(c=a[l].count)>i&&(i=c),c>r&&(r=c);n.maxAnnotsPerBar[s]=i}n.maxAnnotsPerBarAllChrs=r}}(n=function(t,e,n,r){var o,i,a,s,l,c,u,h,f,d,m=r.config.barWidth;for(s=0;s<t.length;s++)for(o=t[s].annots,a=e[(i=n[t[s].chr]).chrIndex].annots,l=0;l<o.length;l++)for(u=(c=o[l]).px-r.bump,h=0;h<a.length;h++)if(d=(f=a[h].px)+m,h===a.length-1&&(d+=m),u>=f&&u<d){e[i.chrIndex].annots[h].count+=1,e[i.chrIndex].annots[h].annots.push(c);break}return e}(t,n=function(t,e){var n,r,o,i,a,s,l,c=e.config.barWidth,u=[];for(a=0;a<e.chromosomesArray.length;a++){for(r=t[n=e.chromosomesArray[a].name],o=Math.round(r.bands[r.bands.length-1].px.stop/c),i={chr:n,annots:[]},s=0;s<o;s++)i.annots.push({bp:e.convertPxToBp(r,(l=s*c-e.bump)+e.bump),px:l,count:0,chrIndex:r.chrIndex,chrName:n,color:e.config.annotationsColor,annots:[]});u.push(i)}return u}(e,this),e,this),r,this),n=function(t,e){var n,r,o,i,a,s,l,c=e._layout._isRotated;for(n=0;n<t.length;n++)for(r=t[n].annots,o=t[n].chr,i=0;i<r.length;i++)a=r[i].count,s="relative"===e.config.histogramScaling?a/e.maxAnnotsPerBar[o]:a/e.maxAnnotsPerBarAllChrs,l=!1===c?s*e.config.chrMargin:s*e.config.chrHeightOriginal*3,isNaN(l)&&(l=0),t[n].annots[i].height=l;return t}(n,this),function(t,e){var n=(new Date).getTime();e.config.debug&&console.log("Time spent in getHistogramBars: "+(n-t)+" ms")}(o,this),this.bars=n,n}var pa="#_ideogramLegend {font: 12px Arial; overflow: auto;} #_ideogramLegend svg {float: left;} #_ideogramLegend ul {position: relative; left: -14px; list-style: none; float: left; padding-left: 10px; margin: 0 0 1em 0; width: auto; border: none;} #_ideogramLegend li {float: none; margin: 0;}#_ideogramLegend ul span {position: relative; left: -15px;} ";function ga(t,e){var n,r='fill="'+t.color+'" style="stroke: #AAA;"',o=t.shape;if("shape"in t&&["circle","triangle"].includes(o)){if("circle"===o)n='<path d="m2,9a 4.5,4.5 0 1,0 9,0a 4.5,4.5 0 1,0 -9,0" '+r+"></path>";else if("triangle"===o){var i="";"vertical"===e.config.orientation&&(i=' transform="rotate(90, 7, 7)"'),n='<path d="m7,3 l -5 9 l 9 0 z"'+i+" "+r+"></path>"}}else n='<rect height="10" width="10"  y="3" '+r+"/>";return n}function ya(t,e,n,r,o){var i,a,s,l=va(o);for(i=0;i<n.rows.length;i++)t+="<li>"+(s=n.rows[i]).name+"</li>",a=l*(i-1)+r+1,"name"in n&&(a+=l),e+='<g transform="translate(0, '+a+')">'+ga(s,o)+"</g>";return[t,e]}function va(t){return 2*Xo(ii("A",t).height)+.5}function ba(t){var e,n,r,o,i,a,s=t.config,l=va(t);for(Go.select(s.container+" #_ideogramLegend").remove(),n=s.legend,a="",e=0;e<n.length;e++){const s=(i=n[e]).nameHeight?i.nameHeight:0,c=s?` style="height: ${s}px;"`:"";"name"in i&&(o=`<div${c}>`+i.name+"</div>"),r='<svg id="_ideogramLegendSvg" width="'+l+'">',[o,r]=ya(o,r,i,s,t),a+=(r+="</svg>")+"<ul>"+o+"</ul>"}var c=`font-family: ${s.fontFamily};`,u=`line-height: ${va(t)}px;`;pa+=`#_ideogramLegend {${c} ${u}}`;var h=Go.select(s.container+" #_ideogramOuterWrap");h.append("style").html(pa),h.append("div").attr("id","_ideogramLegend").html(a)}function wa(t){var e,n,r=[],o=this.chromosomes[this.config.taxid];if("annots"in t[0]||"values"in t[0])return this.drawProcessedAnnots(t);for(n in o)r.push({chr:n,annots:[]});r=function(t,e){var n,r,o,i;for(n=0;n<t.length;n++)for(o=t[n],r=0;r<e.length;r++)if(o.chr===e[r].chr){i=[o.name,o.start,o.stop-o.start],"color"in o&&i.push(o.color),"shape"in o&&i.push(o.shape),e[r].annots.push(i);break}return e}(t,r),e=function(t){var e=["name","start","length"];return"color"in t[0]&&e.push("color"),"shape"in t[0]&&e.push("shape"),e}(t),this.rawAnnots={keys:e,annots:r},this.annots=this.processAnnotData(this.rawAnnots),this.drawProcessedAnnots(this.annots)}function xa(t){var e;Go.selectAll(this.selector+" .annot").remove(),e="tracks",this.config.annotationsLayout&&(e=this.config.annotationsLayout),"legend"in this.config&&ba(this),/heatmap/.test(e)?this.drawHeatmaps(t):(function(t,e,n){var r;!function(t,e){var n,r;if(!/heatmap/.test(t)&&"histogram"!==t){for(r=0,n=0;n<e.length;n++)r+=e[n].annots.length;r>2e3&&console.warn('Rendering more than 2000 annotations in Ideogram?\nTry setting "annotationsLayout" to "heatmap" or "histogram" in your Ideogram configuration object for better layout and performance.')}}(t,e),"histogram"===t&&(e=n.getHistogramBars(e)),r=function(t,e){return Go.selectAll(e.selector+" .chromosome").data(t).selectAll("path.annot").data((function(t){return t.annots})).enter()}(n.fillAnnots(e),n),"tracks"===t?function(t,e){var n,r=e.config.annotationHeight;n=function(t){var e;return{triangle:"m0,0 l -"+t+" "+2*t+" l "+2*t+" 0 z",circle:"m -"+(e=t)+", "+e+"a "+e+","+e+" 0 1,0 "+2*e+",0a "+e+","+e+" 0 1,0 -"+2*e+",0",rectangle:"m0,0 l 0 "+2*t+"l "+t+" 0l 0 -"+2*t+"z"}}(r),t.append("g").attr("id",(function(t){return t.domId})).attr("class","annot").attr("transform",(function(t){return"translate("+t.px+","+(e.config.chrWidth+t.trackIndex*r*2)+")"})).append("path").attr("d",(function(t){return function(t,e){return t.shape&&"triangle"!==t.shape?"circle"===t.shape?e.circle:"rectangle"===t.shape?e.rectangle:t.shape:e.triangle}(t,n)})).attr("fill",(function(t){return t.color})).on("mouseover",(function(t,n){e.showAnnotTooltip(n,this)})).on("mouseout",(function(){e.startHideAnnotTooltipTimeout()})).on("click",(function(t,n){e.onClickAnnot(n)}))}(r,n):"overlay"===t?function(t,e){t.append("polygon").attr("id",(function(t){return t.id})).attr("class","annot").attr("points",(function(t){var n,r,o=e.config.chrWidth;return t.stopPx-t.startPx>1?(n=t.startPx,r=t.stopPx):(n=t.px-.5,r=t.px+.5),n+","+o+" "+r+","+o+" "+r+",0 "+n+",0"})).attr("fill",(function(t){return t.color})).on("mouseover",(function(t,n){e.showAnnotTooltip(n,this)})).on("mouseout",(function(){e.startHideAnnotTooltipTimeout()}))}(r,n):"histogram"===t&&function(t,e){var n,r,o={},i=e.config.chrWidth;for(r in n=e.chromosomes[e.config.taxid])o[r]=n[r];t.append("polygon").attr("class","annot").attr("points",(function(t){return function(t,e,n,r){var o,i,a,s,l=n[t.chr];return(i=t.px+r.config.barWidth+r.bump)>l&&(i=l),(o=t.px+r.bump)+","+(a=e)+" "+i+","+a+" "+i+","+(s=e+t.height)+" "+o+","+s}(t,i,o,e)})).attr("fill",(function(t){return t.color}))}(r,n)}(e,t,this),this.onDrawAnnotsCallback&&this.onDrawAnnotsCallback())}function _a(t,e,n){return t.append("g").attr("class","syntenicRegion").attr("id",e).on("click",(function(){var t=this,e=Go.selectAll(n.selector+" .syntenicRegion").filter((function(){return this!==t}));e.classed("hidden",!e.classed("hidden"))})).on("mouseover",(function(){var t=this;Go.selectAll(n.selector+" .syntenicRegion").filter((function(){return this!==t})).classed("ghost",!0)})).on("mouseout",(function(){Go.selectAll(n.selector+" .syntenicRegion").classed("ghost",!1)}))}function Aa(t,e,n,r,o,i){var a,s;a="color"in i?i.color:"#CFC",s="opacity"in i?i.opacity:1,t.append("polygon").attr("points",e+", "+r.startPx+" "+e+", "+r.stopPx+" "+n+", "+o.stopPx+" "+n+", "+o.startPx).style("fill",a).style("fill-opacity",s)}function Ca(t,e,n,r,o,i){var a,s;a="color"in i?i.color:"#CFC",s="opacity"in i?i.opacity:1,t.append("polygon").attr("points",r.startPx-15+", "+e+" "+(r.stopPx-15)+", "+e+" "+(o.stopPx-15)+", "+n+" "+(o.startPx-15)+", "+n).style("fill",a).style("fill-opacity",s)}function ka(t,e,n=null){var r,o,i,a;if(o=t.r2,"string"==typeof(r=t.r1).chr){const t=e.config.taxids;e.config.multiorganism?(r.chr=e.chromosomes[t[0]][r.chr],o.chr=e.chromosomes[t[1]][o.chr]):(r.chr=e.chromosomes[t[0]][r.chr],o.chr=e.chromosomes[t[0]][o.chr])}var s=document.querySelector("#"+r.chr.id+"-chromosome-set"),l=s.getCTM().e,c=s.getCTM().f,u=document.querySelector("#"+o.chr.id+"-chromosome-set"),h=u.getCTM().e,f=u.getCTM().f;return null===n?"vertical"===e.config.orientation?(i=c-12,a=f-12):(i=l,a=h):(i=n,a=n),r.startPx=e.convertBpToPx(r.chr,r.start)+i,r.stopPx=e.convertBpToPx(r.chr,r.stop)+i,o.startPx=e.convertBpToPx(o.chr,o.start)+a,o.stopPx=e.convertBpToPx(o.chr,o.stop)+a,[r,o]}function Sa(t,e,n,r,o){t.append("line").attr("class","syntenyBorder").attr("x1",e).attr("x2",n).attr("y1",r.startPx).attr("y2",o.startPx),t.append("line").attr("class","syntenyBorder").attr("x1",e).attr("x2",n).attr("y1",r.stopPx).attr("y2",o.stopPx)}function Ea(t,e,n,r,o){t.append("line").attr("class","syntenyBorder").attr("x1",r.startPx-15).attr("x2",o.startPx-15).attr("y1",e).attr("y2",n),t.append("line").attr("class","syntenyBorder").attr("x1",r.stopPx-15).attr("x2",o.stopPx-15).attr("y1",e).attr("y2",n)}function La(t,e,n,r,o,i){var a,s;Math.abs(r.startPx-r.startPx)<2&&Math.abs(r.stopPx-r.stopPx)<2?(a=i.color,s=i.width):(a="",s=""),t.append("line").attr("class","syntenyBorder").attr("x1",e).attr("x2",n).attr("y1",r.startPx).attr("y2",o.startPx).style("stroke",a).style("stroke-width",s),t.append("line").attr("class","syntenyBorder").attr("x1",e).attr("x2",n).attr("y1",r.stopPx).attr("y2",o.stopPx).style("stroke",a).style("stroke-width",a)}function Ta(t,e,n,r,o,i){var a=i.split("__").map(t=>"label_"+t);if("name"in r){t.append("text").attr("id",a[0]).attr("y",r.startPx+3).text(r.name);var s=document.querySelector("#"+a[0]).getBoundingClientRect().width;Go.select("#"+a[0]).attr("x",e-15-s)}"name"in o&&t.append("text").attr("id",a[1]).text(o.name).attr("x",n+15).attr("y",o.startPx+3).text(o.name)}function Ma(t){var e=(new Date).getTime(),n=this.config;if(n.multiorganism&&"collinear"===n.geometry)return"vertical"===n.orientation?function(t,e){var n=(new Date).getTime();(function(t,e,n){var r,o,i,a,s,l,c,u;for(r=0;r<t.length;r++)o=t[r],[i,a]=ka(o,n),Aa(s=_a(e,i.chr.id+"_"+i.start+"_"+i.stop+"___"+a.chr.id+"_"+a.start+"_"+a.stop,n),c=(l=n.config.chrWidth)+46,u=l+240,i,a,o),Sa(s,c,u,i,a)})(t,Go.select(e.selector).insert("g",":first-child").attr("class","synteny"),e),function(t,e){var n=(new Date).getTime();e.config.debug&&console.log("Time in drawSyntenicRegions: "+(n-t)+" ms")}(n,e)}(t,this):function(t,e){var n=(new Date).getTime();(function(t,e,n){var r,o,i,a,s,l,c,u;for(r=0;r<t.length;r++)o=t[r],[i,a]=ka(o,n),Ca(s=_a(e,i.chr.id+"_"+i.start+"_"+i.stop+"___"+a.chr.id+"_"+a.start+"_"+a.stop,n),c=(l=n.config.chrWidth)+31,u=l+191,i,a,o),Ea(s,c,u,i,a)})(t,Go.select(e.selector).insert("g",":first-child").attr("class","synteny"),e),function(t,e){var n=(new Date).getTime();e.config.debug&&console.log("Time in drawSyntenicRegions: "+(n-t)+" ms")}(n,e)}(t,this);(function(t,e,n,r){var o,i,a,s,l,c,u,h,f;for(o=0;o<t.length;o++)i=t[o],[a,s]=ka(i,r,n),c=_a(e,l=a.chr.id+"_"+a.start+"_"+a.stop+"___"+s.chr.id+"_"+s.start+"_"+s.stop,r),u=r.config.chrWidth,Aa(c,h=r._layout.getChromosomeSetYTranslate(0),f=r._layout.getChromosomeSetYTranslate(1)-u,a,s,i),La(c,h,f,a,s,i),Ta(c,h,f,a,s,l)})(t,Go.select(this.selector).insert("g",":first-child").attr("class","synteny"),this._layout.margin.left,this),function(t,e){var n=(new Date).getTime();e.config.debug&&console.log("Time in drawSyntenicRegions: "+(n-t)+" ms")}(e,this)}function Pa(){this.config.numAnnotTracks=this.config.annotationsNumTracks,Go.selectAll(this.selector+" .annot").remove(),this.drawAnnots(this.processAnnotData(this.rawAnnots))}function Na(t){var e,n,r,o=this.rawAnnots.annots;return this.config.numAnnotTracks=t.length,e=function(t,e){var n,r,o,i,a,s,l;for(r=[],i=0;i<t.length;i++){for(o=t[i],a=[],s=0;s<o.annots.length;s++)n=o.annots[s].slice(),e.includes(l=n[3]+1)&&(n[3]=e.indexOf(l),a.push(n));r.push({chr:o.chr,annots:a})}return r}(o,t),r={keys:this.rawAnnots.keys,annots:e},"collinear"===this.config.geometry&&ci(this),n=this.processAnnotData(r),Go.selectAll(this.selector+" .annot").remove(),this.displayedTrackIndexes=t,this.drawAnnots(n),n}function Ia(t){var e,n;return(e=t.keys).length<4||"trackIndex"!==e[3]||"trackIndexOriginal"===e[4]||(n=function(t,e){var n,r,o,i,a,s,l,c=[];for(l=1,n=0;n<t.length;n++){for(o=t[n],a=[],r=0;r<o.annots.length;r++)(s=(i=o.annots[r].slice())[3])+1>l&&(l=s+1),i.splice(4,0,s),a.push(i);c.push({chr:o.chr,annots:a})}return e.numAvailTracks=l,c}(t.annots,this),e.splice(4,0,"trackIndexOriginal"),t={keys:e,annots:n},this.rawAnnots.metadata&&(t.metadata=this.rawAnnots.metadata)),t}var Oa=[["F00"],["F00","88F"],["F00","CCC","88F"],["F00","FA0","0AF","88F"],["F00","FA0","CCC","0AF","88F"],["F00","FA0","875","578","0AF","88F"],["F00","FA0","875","CCC","578","0AF","88F"],["F00","FA0","7A0","875","0A7","578","0AF","88F"],["F00","FA0","7A0","875","CCC","0A7","578","0AF","88F"],["F00","FA0","7A0","875","552","255","0A7","578","0AF","88F"]];function Fa(t,e,n,r,o,i,a){return a.config.annotationTracks?o=function(t,e,n,r,o){var i;return e.trackIndex=n[3],(i=o.config.annotationTracks[e.trackIndex]).color&&(e.color=i.color),i.shape&&(e.shape=i.shape),t[r].annots.push(e),t}(o,t,n,i,a):"trackIndex"===e[3]&&1!==a.numAvailTracks?[o,r]=function(t,e,n,r,o,i){var a=Oa[i.numAvailTracks-1];return t.trackIndex=e[3],t.trackIndexOriginal=e[4],t.color="#"+a[t.trackIndexOriginal],t.trackIndex>i.config.numTracks-1?(t.trackIndex in n?n[t.trackIndex].push(t):n[t.trackIndex]=[t],[r,n]):(r[o].annots.push(t),[r,n])}(t,n,r,o,i,a):o=function(t,e,n,r){return e.trackIndex=0,e.color||(e.color=r.config.annotationsColor),e.shape||(e.shape="triangle"),t[n].annots.push(e),t}(o,t,i,a),[o,r]}function ja(t,e){return"_c"+t+"_a"+e}function Ba(t,e,n,r,o,i,a){var s,l,c,u;const h=!a.config.annotationsLayout||"tracks"===a.config.annotationsLayout;for(h&&n.annots.sort(a.annotSortFunction?(t,e)=>-a.annotSortFunction(t,e):(t,e)=>t[1]-e[1]),s=0;s<n.annots.length;s++){for(u=n.annots[s],c={},l=0;l<i.length;l++)c[i[l]]=u[l];c.stop=c.start+c.length,c.chr=n.chr,c.chrIndex=o,c.startPx=a.convertBpToPx(r,c.start),c.stopPx=a.convertBpToPx(r,c.stop),c.px=Math.round((c.startPx+c.stopPx)/2),h&&(c.domId=ja(o,s)),[t,e]=Fa(c,i,u,e,t,o,a)}return[t,e]}function Da(t){console.warn('Chromosome "'+t.chr+'" undefined in ideogram; '+t.annots.length+" annotations not shown")}function Ra(t){var e,n,r;return e=t.keys,t=t.annots,[n,r]=function(t,e,n){var r,o,i,a,s=[],l={};for(r=-1,o=0;o<t.length;o++)void 0!==(a=n.chromosomes[n.config.taxid][(i=t[o]).chr])?(r++,s.push({chr:i.chr,annots:[]}),[s,l]="heatmap-2d"!==n.config.annotationsLayout?Ba(s,l,i,a,r,e,n):Vi(s,l,i,a,r,e,n)):Da(i);return[s,l]}(t,e,this),n=function(t,e){var n,r,o,i,a,s;for(n=t,t=[],s=e.chromosomesArray,r=0;r<s.length;r++)for(a=s[r].name,o=0;o<n.length;o++)(i=n[o]).chr===a&&t.push(i);return t}(n,this),function(t,e){var n,r=e.config.numAnnotTracks;!/heatmap/.test(e.config.annotationsLayout)&&r>10&&console.error("Ideogram only displays up to 10 tracks at a time.  You specified "+r+" tracks.  Perhaps consider a different way to visualize your data."),(n=Object.keys(t).length)&&console.warn("Ideogram configuration specified "+r+" tracks, but loaded annotations contain "+n+" extra tracks.")}(r,this),n}class za{constructor(t,e){this.matrix=t,this.ideo=e}setRawAnnots(){var t,e,n;return t=this,e=this.ideo,n=this.matrix,new Promise((function(r){t.rawAnnots=t.fetchCoordinates(e).then((function(o){t.coordinates=o,r(t.parseExpressionMatrix(n,e))}))}))}fetchCoordinates(t){var e={};if("human"===t.config.organism){var n=t.config.dataDir+"../../annotations/Homo_sapiens,_Ensembl_80.tsv";return new Promise((function(r){t.fetch(n,"text").then((function(t){var n,o,i,a,s,l,c;for(n=t.split(/\r\n|\n/).slice(1),o=0;o<n.length;o++)[i,a,s,c,l]=n[o].split(/\s/g),i=parseInt(i),a=parseInt(a),e[s]=[l,i,a-i];r(e)}))}))}throw Error("Expression matrix parsing is only supported for human")}parseAnnotFromTsvLine(t,e){var n,r,o,i,a,s=t.split(/\s/g);return(i=s[0])in this.coordinates==0?[null,null]:(a=s.slice(1).map(t=>parseFloat(t)),[r,o,length]=this.coordinates[i],-1===(n=e.indexOf(r))?[null,null]:[n,[i,o,length].concat(a)])}parseExpressionMatrix(t,e){var n,r,o,i,a,s,l=[],c=t.split(/\r\n|\n/);for(r=Object.keys(e.chromosomes[e.config.taxid]),n=0;n<r.length;n++)l.push({chr:r[n],annots:[]});for(n=1;n<c.length;n++)i=c[n],[a,s]=this.parseAnnotFromTsvLine(i,r),null!==a&&l[a].annots.push(s);return o=c[0].split(/\s/g),{keys:["name","start","length"].concat(o),annots:l}}}function Wa(){const t=this,e={};t.annots.forEach(n=>{n.annots.forEach(n=>{const r=t.annotDescriptions.annots[n.name];e[n.name]=[n.name,r.ensemblId,n.chr,n.start,n.stop,n.length,r.type]})});const n=[["# Gene name","Ensembl ID","Chromosome","Start","Stop","Length","Type"]].concat(Object.values(e)),r=t.annotDescriptions.headers+"\n#\n"+n.map(t=>t.join("\t")).join("\n"),o="data:text/plain;charset=utf-8,"+encodeURIComponent(r);var i=new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}),a=document.createElement("a");a.setAttribute("download","ideogram.tsv"),a.setAttribute("href",o),a.setAttribute("target","_blank"),a.setAttribute("id","_ideo-undisplayed-dl-annots-link"),a.setAttribute("style","display: none;"),document.body.appendChild(a),a.dispatchEvent(i)}function Ha(){var t=this.config;!function(t){var e,n=t.config;n.annotationHeight||("heatmap"===n.annotationsLayout?e=n.chrWidth-1:(e=Math.round(n.chrHeight/100))<3&&(e=3),t.config.annotationHeight=e)}(this),t.annotationsPath||t.localAnnotationsPath||this.annots||t.annotations?function(t,e){t.config.numAnnotTracks=e.annotationTracks?e.annotationTracks.length:e.annotationsNumTracks?e.annotationsNumTracks:1,t.config.annotTracksHeight=e.annotationHeight*e.numAnnotTracks,void 0===e.barWidth&&(t.config.barWidth=3)}(this,t):(this.config.annotTracksHeight=0,this.config.numAnnotTracks=0),void 0===t.annotationsColor&&(this.config.annotationsColor="#F00"),t.onClickAnnot&&(this.onClickAnnotCallback=t.onClickAnnot),function(t,e){!1!==e.showAnnotTooltip&&(t.config.showAnnotTooltip=!0),e.onWillShowAnnotTooltip&&(t.onWillShowAnnotTooltipCallback=e.onWillShowAnnotTooltip)}(this,t),function(t,e){!1!==e.addAnnotLabel&&(t.config.addAnnotLabel=!0),e.onWillAddAnnotLabel&&(t.onWillAddAnnotLabelCallback=e.onWillAddAnnotLabel)}(this,t)}function Ga(){var t=this.config;this.rawAnnots.annots=this.rawAnnots.annots.sort(Ideogram.sortChromosomes),this.onLoadAnnotsCallback&&this.onLoadAnnotsCallback(),("heatmapThresholds"in t||"metadata"in this.rawAnnots&&"heatmapThresholds"in this.rawAnnots.metadata)&&("heatmap"===t.annotationsLayout?function(t){var e,n,r,o,i,a,s=t.config.heatmapThresholds;for(r=[],n=(i=t.rawAnnots).keys.slice(3),o=[],a=[],!i.metadata&&isNaN(s[0])||(s=zi(t)),e=0;e<n.length;e++)r.push({key:n[e],thresholds:s}),o.push({id:n[e]}),a.push(e+1);t.config.annotationsNumTracks=n.length,t.config.annotationsDisplayedTracks=a,t.config.heatmaps=r,t.config.annotationTracks=o}(this):"heatmap-2d"===t.annotationsLayout&&(this.config.heatmapThresholds=zi(this))),t.heatmaps&&this.deserializeAnnotsForHeatmap(this.rawAnnots),function(t){const e={},n=[],r=t.rawAnnots.annots.map(t=>t.chr);if(r.forEach(t=>{t in e&&n.push(t),e[t]=1}),n.length>0)throw Error(`Duplicate chromosomes detected.\nChromosome list: ${r}.  Duplicates: ${n}.\nTo fix this, edit your raw annotations JSON data to remove redundant chromosomes.`)}(this)}function $a(){return this.annots.reduce((t,e)=>[...t,...e.annots],[])}function qa(t){var e,n=this;e="heatmap-2d"===n.config.annotationsLayout;var r=function(t){var e,n;return e=t.split("?")[0].split("."),!1===["bed","json","tsv"].includes(n=e[e.length-1])?(n=n.toUpperCase(),void alert("Ideogram.js only supports BED and Ideogram JSON and TSV at the moment.  Sorry, check back soon for "+n+" support!")):n}(t);"http"===t.slice(0,4)||e||"tsv"===r?(r=e?"":r,n.fetch(t,"text").then((function(t){n.rawAnnotsResponse=t,e?new za(t,n).setRawAnnots().then((function(t){n.rawAnnots=t,n.afterRawAnnots()})):(n.rawAnnots="tsv"===r?new ji(t,n).rawAnnots:"bed"===r?new Fi(t,n).rawAnnots:JSON.parse(t),n.afterRawAnnots())}))):n.fetch(t).then((function(t){n.rawAnnotsResponse=t,n.rawAnnots=t,n.afterRawAnnots()}))}function Va(t){var e,n,r,o,i,a,s;for(e=[],n=[],r=this.chromosomesArray,o=0;o<r.length;o++)n.push(i=r[o].name),e.push({chr:i,annots:[]});for(o=0;o<t.length;o++)-1!==(s=n.indexOf((a=t[o]).chr))&&(e[s]=a);return e}function Ya(t,e="red"){const n=this,r=n.config.taxid,o=t.map(t=>{const o=n.chromosomes[r][t].id,i=document.querySelector(`${n.selector} #${o}-chromosome-set`),a=i.getBoundingClientRect();return`<rect class="ideo-highlight" id="ideo-highlight-${o}" style="\n      stroke-width: 1px;\n      stroke: ${e};\n      fill: ${e};\n      fill-opacity: 0.05;\n      position: absolute;\n      rx: 4;\n      ry: 4;\n      height: ${a.width+15}px;\n      width: ${a.height+15}px" transform="rotate(90) translate(10, ${i.transform.baseVal[1].matrix.f-7.5})"/>`}).join();document.querySelector(n.selector).insertAdjacentHTML("afterBegin",o)}function Xa(t){const e=this;let n=e.selector+" .ideo-highlight";if(void 0!==t){const r=e.config.taxid;n=t.map(t=>`${e.selector} #ideo-highlight-${e.chromosomes[r][t].id}`)}document.querySelectorAll(n).forEach(t=>{t.remove()})}function Ua(t,e){return Go.json(e.esearch+"&db=taxonomy&term="+t).then((function(e){if(0===e.esearchresult.idlist.length)throw'Organism "'+t+"\" is generally unknown; it was not found in the NCBI Taxonomy database.  If you did not intend to specify a novel or custom taxon, then try using the organism's scientific name, e.g. Homo sapiens or Arabidopsis thaliana.";return[t,e.esearchresult.idlist[0]]}))}function Ja(t,e){var n,r=this;Go.json(r.esummary+"&db=taxonomy&id="+(t=r.config.organism)).then((function(o){return n=o.result[String(t)].commonname,r.config.organism=n,e(n)}))}function Qa(t,e,n){var r,o,i,a,s,l=n.config;(function(t,e){var n,r,o;if(e.assemblyIsAccession())return new Promise((function(n){e.coordinateSystem="bp",e.getAssemblyAndChromosomesFromEutils(t,n)}));n=e.config.dataDir,r=ei(e.organisms[t].scientificName),o=[t],["9606","10090","10116"].includes(t)&&!e.config.showFullyBanded&&(r+="-no-bands");var i=n+r+".json";return new Promise((t,e)=>Vo(i).then(e=>e.json().then((function(e){t(e.chrBands)}))).catch(t=>{e(t)})).then((function(n){var r,i,a,s,l=[""],c=[],u={};e.bandData[t]=n;for(var h=0;h<n.length;h++)r=(a=n[h].split(" "))[0],s=a.slice(-1)[0],r in u||(c.push({name:r,type:"nuclear",length:s}),u[r]=1);return c=c.sort(Ideogram.sortChromosomes),i={bp:0,iscn:0},c.forEach(t=>{t.length>i.bp&&(i.bp=t.length)}),e.maxLength[t]=i,l.push(c),l.push(o),l}),(function(){return new Promise((function(n){e.coordinateSystem="bp",e.getAssemblyAndChromosomesFromEutils(t,n)}))}))})(t,n).then((function(c){r=c[0],o=c[1],"chromosomes"in l==0||null===l.chromosomes?(n.config.chromosomes={},n.config.chromosomes[t]=o):(l.multiorganism?t in l.chromosomes?i=l.chromosomes[t]:(a=ei(n.getScientificName(t)),n.config.chromosomes[t]=l.chromosomes[a].slice(),i=n.config.chromosomes[t]):i=l.chromosomes,s=o.filter(t=>i.includes(t.name)),n.config.chromosomes[t]=s),n.chromosomes[t]=n.config.chromosomes[t].slice(),n.organisms[t].assemblies={default:r},e()}))}function Ka(t,e){var n,r;for(n in e.organisms)if(r=e.organisms[n],n===ei(t)||ei(r.commonName)===ei(t)||ei(r.scientificName)===ei(t))return!0;return!1}function Za(t){var e;if(this.config.multiorganism=function(t,e){return"organism"in e.config&&e.config.organism instanceof Array||t&&e.config.taxid instanceof Array}(e="taxid"in this.config,this),this.config.multiorganism&&(this.coordinateSystem="bp"),"organism"in this.config){const e=this.config.organism;"string"==typeof e&&(this.config.organism=ei(e.toLowerCase())),function(t,e){(function(t){var e,n,r,o,i,a=t.config;return e=[],n={},function(t,e){var n,r,o,i=[],a={};for(o=0;o<t.length;o++)r=!1===Ka(n=t[o],e)?Ua(n,e).then((function(t){var n,r,o=t[1];r=(n=t[0].replace("-"," "))[0].toUpperCase()+n.slice(1),a[o]={scientificName:r,commonName:"",assemblies:{default:""}},Object.assign(e.organisms,a)}),(function(t){console.warn(t);var r={scientificName:n,commonName:n,assemblies:{default:""}};e.organisms[-1]=r,a[-1]=r})):new Promise((function(t){var r=e.getTaxid(n);a[r]=e.organisms[r],t()})),i.push(r);return Promise.all(i).then((function(){return a}))}(a.multiorganism?a.organism:[a.organism],t).then((function(t){var s=t[o];for(o in t)s=t[o],e.push(o),a.multiorganism&&(void 0!==a.chromosomes?((i=Object.keys(a.chromosomes).map(t=>ei(t))).includes(ei(s.scientificName))?r=s.scientificName:i.includes(ei(s.commonName))&&(r=s.commonName),n[o]=ei(r)in a.chromosomes?a.chromosomes[ei(r)]:a.chromosomes[r.toLowerCase()]):n=null);return[n,e]}))})(e).then((function([n,r]){var o,i,a,s,l,c=e.config,u=[];for(o=0;o<r.length;o++)s=e.organisms[i=r[o]].assemblies,l=Object.values(s),""===s.default||e.assemblyIsAccession()&&!l.includes(c.assembly)?a=new Promise((function(t){Qa(i,t,e)})):(e.config.taxids=r,e.config.multiorganism&&(e.config.chromosomes=n),a=new Promise((function(t){t()}))),u.push(a);Promise.all(u).then((function(){return r=function(t){var e,n,r;if(e=t.config.organism,n=[],Array.isArray(e))for(r=0;r<e.length;r++)n.push(t.getTaxid(e[r]));else n.push(t.getTaxid(e));return n}(e),e.config.taxids=r,t(r)}))}))}(t,this)}else!function(t,e,n){var r;n.config.multiorganism?t&&(r=n.config.taxid):(t&&(r=[n.config.taxid]),n.config.taxids=r),e(r)}(e,t,this)}function ts(t,e){var n,r;return[n,r]=function(t,e){var n=t.genome;return"mitochondrion"===n?function(t,e){var n,r;return e.config.showNonNuclearChromosomes?(n=t.genome,[-1===(r=t.subtype.split("|").indexOf("plasmid"))?"MT":t.subname.split("|")[r],n]):[null,null]}(t,e):"chloroplast"===n||"plastid"===n?function(t){return t.config.showNonNuclearChromosomes?["CP","chloroplast"]:[null,null]}(e):"apicoplast"===n?function(t){return t.config.showNonNuclearChromosomes?["AP","apicoplast"]:[null,null]}(e):function(t){var e,n;return e=t.subtype.split("|").indexOf("chromosome"),void 0!==(n=t.subname.split("|")[e])&&"chr"===n.substr(0,3)&&(n=n.substr(3)),[n,"nuclear"]}(t)}(t,e),{name:n,length:t.slen,type:r}}function es(t,e){var n,r=this,o=function(t,e){var n;return n=e.assemblyIsAccession()?e.config.assembly+"%22[Assembly%20Accession]":t+"%22[taxid]AND%20(%22latest%20refseq%22[filter])%20",e.esearch+"&db=assembly&term=%22"+n+"AND%20(%22chromosome%20level%22[filter]%20OR%20%22complete%20genome%22[filter])"}(t,r);Go.json(o).then((function(t){return function(t,e){return Go.json(e.esummary+"&db=assembly&id="+t.esearchresult.idlist[0])}(t,r)})).then((function(t){var e=t.result.uids[0];return n=t.result[e],function(t,e){return Go.json(e.elink+"&db=nuccore&dbfrom=assembly&linkname=assembly_nuccore&cmd=neighbor_history&from_uid="+t).then((function(t){return e.esearch+"&db=nuccore&term=%231+AND+%28sequence_from_chromosome[Properties]+OR+sequence_from_plastid[Properties]+OR+sequence_from_mitochondrion[Properties]%29&WebEnv="+t.linksets[0].webenv+"&usehistory=y&retmax=1000"}))}(e,r)})).then((function(t){return Go.json(t)})).then((function(t){return function(t,e){var n;return n=t.esearchresult.idlist.join(","),Go.json(e.esummary+"&db=nucleotide&id="+n)}(t,r)})).then((function(o){var i=function(t,e,n){var r,o,i,a,s={},l=[];for(r in t)"uids"!==r&&(i=(o=ts(t[r],n)).name+"_"+o.length,null!==o.type&&i in s==0&&l.push(o),s[i]=1);return l=l.sort(Ideogram.sortChromosomes),a={bp:0,iscn:0},l.forEach(t=>{t.length>a.bp&&(a.bp=t.length)}),a.bp>n.maxLength.bp&&(n.maxLength.bp=a.bp),n.maxLength[e]=a,n.coordinateSystem="bp",l}(o.result,t,r);return e([n,i])}),(function(t){console.warn(t)}))}function ns(){var t=this.bandsToShow.join(",");0!==this.bandsToShow.length&&(Go.selectAll(this.selector+" .bandLabel, .bandLabelStalk").style("display","none"),Go.selectAll(t).style("display",""))}function rs(t,e,n,r,o){return e!==n&&(t=r[o.id][n]+36),t}function os(t,e,n,r,o,i,a){var s,l;return n<r+(a?e:o)?(e=o,s=i,l=a):t.push(i),[t,e,s,l]}function is(t,e){var n,r,o,i,a,s=[],l=t[e.id].length,c=0;for(n=0;n<l;n++)o=t[e.id][n],[s,c,r,a]=os(s,c,o,5,i,n,!0),a||(i=rs(i,r,n,t,e),[s,c,r,a]=os(s,c,o,5,i,n,!1));return s}function as(t,e){var n,r,o,i,a,s;for(this.bandsToShow=[],n=0;n<t.length;n++){for(a=[],s=(o=is(e,i=t[n])).length,r=0;r<s;r++)a.push("#"+i.id+" .bsbsl-"+o[r]);this.bandsToShow=this.bandsToShow.concat(a)}}function ss(t,e,n,r){var o=this,i=o._layout,a=n.chrIndex;return t.selectAll("text").data(e).enter().append("g").attr("class",(function(t,e){return"bandLabel bsbsl-"+e})).attr("transform",(function(t){var e=i.getChromosomeBandLabelTranslate(t,a);return r[n.id].push("horizontal"===o.config.orientation?e.x+13:e.y+6),e.translate})).append("text").attr("text-anchor",i.getChromosomeBandLabelAnchor(a)).text((function(t){return t.name})),r}function ls(t,e,n,r){var o=this;t.selectAll("line.bandLabelStalk").data(e).enter().append("g").attr("class",(function(t,e){return"bandLabelStalk bsbsl-"+e})).attr("transform",(function(t){var e;return e=o.round(t.px.start+t.px.width/2),r[n.id].push(e+13),"translate("+e+",-10)"})).append("line").attr("x1",0).attr("y1",o._layout.getChromosomeBandTickY1(n.chrIndex)).attr("x2",0).attr("y2",o._layout.getChromosomeBandTickY2(n.chrIndex))}function cs(t){var e,n,r,o,i,a={};for(o=function(t){var e,n,r=[];for(e in t)for(n in t[e])r.push(t[e][n]);return r}(t),e=0;e<o.length;e++)n=Go.select(this.selector+" #"+(r=o[e]).id),a[r.id]=[],i=r.bands.filter(t=>"pter"!==t.name),a=this.drawBandLabelText(n,i,r,a),this.drawBandLabelStalk(n,i,r,a);this.setBandsToShow(o,a)}function us(t,e){return[e[t][0],e[t][1],e[t][2],e[t][3]]}function hs(){var t="";return t=function(t){var e,n,r,o,i,a="";for(e=0;e<t.length;e++)[n,r,o,i]=us(e,t),a+='<linearGradient id="'+n+'" x1="0%" y1="0%" x2="0%" y2="100%">',a+="gneg"===n?'<stop offset="70%" stop-color="'+o+'" /><stop offset="95%" stop-color="'+i+'" /><stop offset="100%" stop-color="'+r+'" />':'<stop offset="5%" stop-color="'+r+'" /><stop offset="15%" stop-color="'+o+'" /><stop offset="60%" stop-color="'+i+'" />',a+="</linearGradient>";return a}(Wo),`<style>${ai}</style><defs>`+(t+='<pattern id="stalk" width="2" height="1" patternUnits="userSpaceOnUse" patternTransform="rotate(30 0 0)"><rect x="0" y="0" width="10" height="2" fill="#CCE" /> <line x1="0" y1="0" x2="0" y2="100%" style="stroke:#88B; stroke-width:0.7;" /></pattern><pattern id="gvar" width="2" height="1" patternUnits="userSpaceOnUse" patternTransform="rotate(-30 0 0)"><rect x="0" y="0" width="10" height="2" fill="#DDF" /> <line x1="0" y1="0" x2="0" y2="100%" style="stroke:#99C; stroke-width:0.7;" /></pattern>')+"</defs>"}function fs(t,e,n){var r,o;return(r=e[0])in t==0&&(t[r]=[]),o=function(t,e,n,r){return{chr:t,bp:{start:parseInt(e[5],10),stop:parseInt(e[6],10)},iscn:{start:parseInt(e[3],10),stop:parseInt(e[4],10)},px:{start:-1,stop:-1,width:-1},name:e[1]+e[2],stain:n,taxid:r}}(r,e,function(t){var e=t[7];return t[8]&&(e+=t[8]),e}(e),n),t[r].push(o),t}function ds(t,e,n,r){var o,i,a=r.config.multiorganism;return null!=t&&(i=(o=Array.isArray(t))&&-1===t.indexOf(e),!(!o||"object"==typeof t||!i)||(n in t!=0||!a)&&(a?"string"==typeof t[n][0]?!1===t[n].includes(e):0===t[n].filter(t=>t.name===e).length:0===t.filter(t=>t===e).length))}function ms(t,e,n,r){var o,i,a=[];return a.push(o=e[t]),i={iscn:o[o.length-1].iscn.stop,bp:o[o.length-1].bp.stop},n in r.maxLength==0&&(r.maxLength[n]={bp:0,iscn:0}),i.iscn>r.maxLength[n].iscn&&(r.maxLength[n].iscn=i.iscn,i.iscn>r.maxLength.iscn&&(r.maxLength.iscn=i.iscn)),i.bp>r.maxLength[n].bp&&(r.maxLength[n].bp=i.bp,i.bp>r.maxLength.bp&&(r.maxLength.bp=i.bp)),a}function ps(t){var e,n,r=this.config,o=(new Date).getTime();return e=[],"chromosomes"in r&&(n=r.multiorganism?r.chromosomes:t in r.chromosomes?r.chromosomes[t].slice():r.chromosomes.slice()),e=function(t,e,n,r){var o,i;if(t in r.bandData||t in Ho&&!1===r.assemblyIsAccession())n=function(t,e,n,r){var o,i,a;o=function(t,e,n){var r,o,i,a,s,l,c={};l=n.bandData[t],Array.isArray(l)&&(s="native"),e=function(t){var e,n;if(t instanceof Array&&"object"==typeof t[0]){for(e=[],n=0;n<t.length;n++)e.push(t[n].name);t=e}return t}(e);var u=function(t,e){var n,r,o;return"undefined"==typeof chrBands&&"native"!==t?(n=/\t/,r=e.split(/\r\n|\n/),o=1):(n=/ /,r=e,o=0),[n,r,o]}(s,l);for(r=u[0],o=u[1],a=u[2];a<o.length;a++)ds(e,(i=o[a].split(r))[0],t,n)||(c=fs(c,i,t));return c}(t,e,r),e=Object.keys(o).sort(Ideogram.sortChromosomes),"chromosomes"in r.config!=0&&null!==r.config.chromosomes||(r.config.chromosomes={}),e.length>0&&(r.config.chromosomes[t]=e.slice()),r.numChromosomes+=r.config.chromosomes[t].length;for(i=0;i<e.length;i++)a=ms(e[i],o,t,r),n=n.concat(a);return n}(t,e,n,r);else for(r.numChromosomes+=e.length,i=0;i<e.length;i++)(o=e[i]).length>r.maxLength.bp&&(r.maxLength.bp=o.length);return n}(t,n,e,this),function(t,e){var n=(new Date).getTime();e.config.debug&&console.log("Time in processBandData: "+(n-t)+" ms")}(o,this),[t,e]}function gs(){call(this.onBrushMoveCallback)}function ys(){call(this.onBrushEndCallback)}function vs(t,e,n){var r,o,i,a,s=this.config.chrWidth+6.5,l=this._layout.margin.left;[t,e,n]=function(t,e,n){var r,o;return r=t.split(":"),o=t.split("-"),r.length>1&&o.length>1&&(t=r[0].replace("chr",""),o=r[1].split("-"),e=parseInt(o[0]),n=parseInt(o[1]-1)),[t,e,n]}(t,e,n),r=function(t,e){var n,r;for(n=0;n<e.chromosomesArray.length;n++)if((r=e.chromosomesArray[n]).name===t)return r}(t,this),[o,i]=function(t,e){var n,r,o=[1],i=[1],a=t.bands.slice(-1)[0];for(r=0;r<t.bands.length;r++)o.push((n=t.bands[r]).bp.start),i.push(n.px.start+e);return o.push(a.bp.stop-1),i.push(a.px.stop+e),[o,i]}(r,l),a=r.bands.slice(-1)[0],void 0===e&&(e=Math.floor(a.bp.stop/10)),void 0===n&&(n=Math.ceil(2*e)),function(t,e,n,r,o){var i,a=o.config.chrHeight;i=Go.scaleLinear().domain(t).range(e),o.brush=Go.brushX().extent([[n,0],[a+n,r]]).on("brush",(function({selection:t}){var e=t.map(i.invert),n=Math.floor(e[0]),r=Math.ceil(e[1]);o.selectedRegion={from:n,to:r,extent:r-n},o.onBrushMoveCallback&&o.onBrushMoveCallback()})).on("end",(function({}){o.onBrushEndCallback&&o.onBrushEndCallback()}))}(o,i,l,s,this),function(t,e,n){n.selectedRegion={from:t,to:e,extent:e-t+1}}(e,n,this),function(t,e,n,r,o,i){var a,s,l;a=i.convertBpToPx(t,e)+r,s=i.convertBpToPx(t,n)+r,l=i._layout.getChromosomeSetYTranslate(0)+(i.config.chrWidth-o)/2,Go.select(i.selector).append("g").attr("class","brush").attr("transform","translate(0, "+l+")").call(i.brush).call(i.brush.move,[a,s])}(r,e,n,l,s,this)}function bs(){call(this.onCursorMoveCallback)}function ws(t){var e,n,r,o=this.config.chrWidth+6.5,i=this._layout.margin.left;if(void 0===t)return!1;e=function(t,e){var n,r;for(n=0;n<e.chromosomesArray.length;n++)if((r=e.chromosomesArray[n]).name===t)return r}(this.config.chromosome,this),[n,r]=function(t,e){var n,r,o=[1],i=[1],a=t.bands.slice(-1)[0];for(r=0;r<t.bands.length;r++)o.push((n=t.bands[r]).bp.start),i.push(n.px.start+e);return o.push(a.bp.stop-1),i.push(a.px.stop+e),[o,i]}(e,i),function(t,e,n,r,o,i){var a;a=Go.scaleLinear().domain(e).range(n),"rotatable"in i.config&&!1===i.config.rotatable||console.warn("Using the cursor with rotate is not supported.");var s=i._layout.getChromosomeSetYTranslate(0)+(i.config.chrWidth-o)/2,l=Go.select(i.selector).append("g").attr("class","brush").attr("transform","translate(0, "+s+")").append("rect").attr("class","cursor").attr("x",a(t)).attr("y",0).attr("width",1).attr("height",30);i.onCursorMove&&i.onCursorMoveCallback(t),i.setCursorPosition||(i.setCursorPosition=function(t){l.attr("x",a(t)),i.onCursorMove&&i.onCursorMoveCallback(t)}),Go.selectAll(i.selector+" .chromosome").on("click",(function(t){var e=t.offsetX;l.attr("x",e-=6);var n=Math.floor(a.invert(e));i.onCursorMove&&i.onCursorMoveCallback(n)}))}(t,n,r,0,o,this)}function xs(t,e){var n,r,o,i,a,s,l,c;for(n=this.bandsArray,o=this.config.chromosomes[r=this.config.taxid],a=(i="male"===this.config.sex?[1,0]:[0,0]).length,c=0;c<a;c++)s=this.getChromosomeModel(n[r][l=i[c]+e],o[l],r,l),this.appendHomolog(s,e,c,t)}function _s(t){var e,n,r={X:1,Y:1};if(2===this.config.ploidy&&this.config.sex)for(this.sexChromosomes.list=[],n=0;n<t.length;n++)e=t[n],"male"===this.config.sex&&e in r?(this.sexChromosomes.list.push(e),this.sexChromosomes.index||(this.sexChromosomes.index=n)):"X"===e&&(this.sexChromosomes.list.push(e,e),this.sexChromosomes.index=n)}function As(t,e){var n,r;if(t.bands.length>1||"MT"===t.name){if([r,n]=function(t,e){var n,r,o,i,a,s;for(n=0;n<t.bands.length;n++)if(s=(r=t.bands[n]).bp.stop,i=r.iscn.stop-(o=r.iscn.start),e>=(a=r.bp.start)&&e<=s)return[r.px.start+r.px.width*(o+i/(s-a)*(e-a)-o)/i,r];return[null,r]}(t,e),null!==r)return r}else if(e>=1&&e<=t.length)return t.scale.bp*e;!function(t,e,n){throw new Error("Base pair out of range.  bp: "+t+"; length of chr"+e.name+": "+n.bp.stop)}(e,t,n)}function Cs(t,e,n,r,o,i,a){return a=t-e,Math.round(i.bp.start+(i.bp.stop-i.bp.start)*(e+a/(r-o)*(n-o)-e)/a)}function ks(t,e){var n,r,o,i;for(0===e&&(e=t.bands[0].px.start),n=0;n<t.bands.length;n++)if(i=(r=t.bands[n]).px.stop,e>=(o=r.px.start)&&e<=i)return Cs(r.iscn.stop,r.iscn.start,e,i,o,r,void 0);!function(t,e,n){throw new Error("Pixel out of range.  px: "+t+"; length of chr"+e.name+": "+n)}(e,t,i)}let Ss=Ps,Es=Ps,Ls=Ps,Ts=Ns,Ms=Is;function Ps(t){for(var e=new Array(t),n=-1;++n<t;)e[n]=0;return e}function Ns(t,e){for(var n=t.length;n<e;)t[n++]=0;return t}function Is(t,e){if(e>32)throw new Error("invalid array width!");return t}function Os(t){this.length=t,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=Ss(t)}"undefined"!=typeof Uint8Array&&(Ss=function(t){return new Uint8Array(t)},Es=function(t){return new Uint16Array(t)},Ls=function(t){return new Uint32Array(t)},Ts=function(t,e){if(t.length>=e)return t;var n=new t.constructor(e);return n.set(t),n},Ms=function(t,e){var n;switch(e){case 16:n=Es(t.length);break;case 32:n=Ls(t.length);break;default:throw new Error("invalid array width!")}return n.set(t),n}),Os.prototype.lengthen=function(t){var e,n;for(e=0,n=this.subarrays;e<n;++e)this[e]=Ts(this[e],t);this.length=t},Os.prototype.add=function(){var t,e,n,r,o;for(r=0,o=this.subarrays;r<o;++r)if(n=(~(t=this.masks[r])&t+1)>>>0,!((e=this.width-32*r)>=32)||n)return e<32&&n&1<<e&&(this[r]=Ms(this[r],e<<=1),this.width=32*r+e),this.masks[r]|=n,{offset:r,one:n};return this[this.subarrays]=Ss(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},Os.prototype.copy=function(t,e){var n,r;for(n=0,r=this.subarrays;n<r;++n)this[n][t]=this[n][e]},Os.prototype.truncate=function(t){var e,n;for(e=0,n=this.subarrays;e<n;++e)for(var r=this.length-1;r>=t;r--)this[e][r]=0;this.length=t},Os.prototype.zero=function(t){var e,n;for(e=0,n=this.subarrays;e<n;++e)if(this[e][t])return!1;return!0},Os.prototype.zeroExcept=function(t,e,n){var r,o;for(r=0,o=this.subarrays;r<o;++r)if(r===e?this[r][t]&n:this[r][t])return!1;return!0},Os.prototype.zeroExceptMask=function(t,e){var n,r;for(n=0,r=this.subarrays;n<r;++n)if(this[n][t]&e[n])return!1;return!0},Os.prototype.only=function(t,e,n){var r,o;for(r=0,o=this.subarrays;r<o;++r)if(this[r][t]!=(r===e?n:0))return!1;return!0},Os.prototype.onlyExcept=function(t,e,n,r,o){var i,a,s;for(a=0,s=this.subarrays;a<s;++a)if(i=this[a][t],a===e&&(i&=n),i!=(a===r?o:0))return!1;return!0};var Fs={array8:Ps,array16:Ps,array32:Ps,arrayLengthen:Ns,arrayWiden:Is,bitarray:Os},js=(t,e)=>function(n){var r=n.length;return[t.left(n,e,0,r),t.right(n,e,0,r)]},Bs=(t,e)=>{var n=e[0],r=e[1];return function(e){var o=e.length;return[t.left(e,n,0,o),t.left(e,r,0,o)]}},Ds=t=>[0,t.length],Rs=t=>t,zs=()=>null,Ws=()=>0;function Hs(t){function e(t,e,r){for(var o=r-e,i=1+(o>>>1);--i>0;)n(t,i,o,e);return t}function n(e,n,r,o){for(var i,a=e[--o+n],s=t(a);(i=n<<1)<=r&&(i<r&&t(e[o+i])>t(e[o+i+1])&&i++,!(s<=t(e[o+i])));)e[o+n]=e[o+i],n=i;e[o+n]=a}return e.sort=function(t,e,r){for(var o,i=r-e;--i>0;)o=t[e],t[e]=t[e+i],t[e+i]=o,n(t,1,i,e);return t},e}const Gs=Hs(Rs);function $s(t){var e=Gs.by(t);return function(n,r,o,i){var a,s,l,c=new Array(i=Math.min(o-r,i));for(s=0;s<i;++s)c[s]=n[r++];if(e(c,0,i),r<o){a=t(c[0]);do{t(l=n[r])>a&&(c[0]=l,a=t(e(c,0,i)[0]))}while(++r<o)}return c}}Gs.by=Hs;const qs=$s(Rs);function Vs(t){function e(e,n,r,o){for(;r<o;){var i=r+o>>>1;n<t(e[i])?o=i:r=i+1}return r}return e.right=e,e.left=function(e,n,r,o){for(;r<o;){var i=r+o>>>1;t(e[i])<n?r=i+1:o=i}return r},e}qs.by=$s;const Ys=Vs(Rs);Ys.by=Vs;var Xs=(t,e,n)=>{for(var r=0,o=e.length,i=n?JSON.parse(JSON.stringify(t)):new Array(o);r<o;++r)i[r]=t[e[r]];return i},Us=t=>t+1,Js=t=>t-1,Qs=t=>function(e,n){return e+ +t(n)},Ks=t=>function(e,n){return e-t(n)};const Zs=(t,e)=>{const n=t[e];return"function"==typeof n?n.call(t):n},tl=/\[([\w\d]+)\]/g;var el=(t,e)=>function(t,e,n,r,o){for(o in r=(n=n.split(".")).splice(-1,1),n)e=e[n[o]]=e[n[o]]||{};return t(e,r)}(Zs,t,e.replace(tl,".$1"));function nl(){var t,e={add:l,remove:c,dimension:f,groupAll:d,size:m,all:p,allFiltered:g,onChange:y,isElementFiltered:h},n=[],r=0,o=[],i=[],a=[],s=[];function l(o){var a=r,s=o.length;return s&&(n=n.concat(o),t.lengthen(r+=s),i.forEach((function(t){t(o,a,s)})),v("dataAdded")),e}function c(e){for(var i=new Array(r),s=[],l="function"==typeof e,c=function(r){return l?e(n[r],r):t.zero(r)},u=0,h=0;u<r;++u)c(u)?(s.push(u),i[u]=-1):i[u]=h++;o.forEach((function(t){t(-1,-1,[],s,!0)})),a.forEach((function(t){t(i)}));for(var f=0,d=0;f<r;++f)-1!==i[f]&&(f!==d&&(t.copy(d,f),n[d]=n[f]),++d);n.length=r=d,t.truncate(d),v("dataRemoved")}function u(e){var n,r,o,i,a=Array(t.subarrays);for(n=0;n<t.subarrays;n++)a[n]=-1;for(r=0,o=e.length;r<o;r++)a[(i=e[r].id())>>7]&=~(1<<(63&i));return a}function h(e,n){var r=u(n||[]);return t.zeroExceptMask(e,r)}function f(e,s){if("string"==typeof e){var l=e;e=function(t){return el(t,l)}}var c,u,h,f,d,m,p,g,y,b,w,x,_,A,C={filter:function(t){return null==t?z():Array.isArray(t)?R(t):"function"==typeof t?W(t):D(t)},filterExact:D,filterRange:R,filterFunction:W,filterAll:z,currentFilter:function(){return x},hasCurrentFilter:function(){return _},top:function(e,r){var o,i=[],a=P,l=0;for(r&&r>0&&(l=r);--a>=M&&e>0;)t.zero(o=m[a])&&(l>0?--l:(i.push(n[o]),--e));if(s)for(a=0;a<k.length&&e>0;a++)t.zero(o=k[a])&&(l>0?--l:(i.push(n[o]),--e));return i},bottom:function(e,r){var o,i,a=[],l=0;if(r&&r>0&&(l=r),s)for(o=0;o<k.length&&e>0;o++)t.zero(i=k[o])&&(l>0?--l:(a.push(n[i]),--e));for(o=M;o<P&&e>0;)t.zero(i=m[o])&&(l>0?--l:(a.push(n[i]),--e)),o++;return a},group:G,groupAll:function(){var t=G(zs),e=t.all;return delete t.all,delete t.top,delete t.order,delete t.orderNatural,delete t.size,t.value=function(){return e()[0].value},t},dispose:$,remove:$,accessor:e,id:function(){return f}},k=[],S=function(t){return ol(t).sort((function(t,e){var n=p[t],r=p[e];return n<r?-1:n>r?1:t-e}))},E=Ds,L=[],T=[],M=0,P=0,N=0;i.unshift(O),i.push(F),a.push(j);var I=t.add();function O(n,o,i){var a,l;if(s){N=0,H=0,A=[];for(var u=0;u<n.length;u++)for(H=0,A=e(n[u]);H<A.length;H++)N++;p=[],a=ol(n.length),l=rl(N,1);for(var f=ol(N),v=0,x=0;x<n.length;x++)if((A=e(n[x])).length)for(a[x]=A.length,H=0;H<A.length;H++)p.push(A[H]),f[v]=x,v++;else a[x]=0,k.push(x+o);var _=S(N);p=Xs(p,_),g=Xs(f,_)}else p=n.map(e),g=S(i),p=Xs(p,g);var C,L,T,I=E(p),O=I[0],F=I[1];if(s)if(i=N,w)for(C=0;C<i;++C)w(p[C],C)||(0==--a[g[C]]&&(t[h][g[C]+o]|=c),l[C]=1);else{for(L=0;L<O;++L)0==--a[g[L]]&&(t[h][g[L]+o]|=c),l[L]=1;for(T=F;T<i;++T)0==--a[g[T]]&&(t[h][g[T]+o]|=c),l[T]=1}else if(w)for(C=0;C<i;++C)w(p[C],C)||(t[h][g[C]+o]|=c);else{for(L=0;L<O;++L)t[h][g[L]+o]|=c;for(T=F;T<i;++T)t[h][g[T]+o]|=c}if(!o)return d=p,m=g,y=a,b=l,M=O,void(P=F);var j,B=d,D=m,R=b,z=0;if(u=0,s&&(j=o,o=B.length,i=N),d=new Array(s?o+i:r),m=s?new Array(o+i):rl(r,r),s&&(b=rl(o+i,1)),s){var W=y.length;y=Fs.arrayLengthen(y,r);for(var H=0;H+W<r;H++)y[H+W]=a[H]}for(var G=0;u<o&&z<i;++G)B[u]<p[z]?(d[G]=B[u],s&&(b[G]=R[u]),m[G]=D[u++]):(d[G]=p[z],s&&(b[G]=l[z]),m[G]=g[z++]+(s?j:o));for(;u<o;++u,++G)d[G]=B[u],s&&(b[G]=R[u]),m[G]=D[u];for(;z<i;++z,++G)d[G]=p[z],s&&(b[G]=l[z]),m[G]=g[z]+(s?j:o);I=E(d),M=I[0],P=I[1]}function F(t,e,n){L.forEach((function(t){t(p,g,e,n)})),p=g=null}function j(t){if(s){for(var e=0,n=0;e<k.length;e++)-1!==t[k[e]]&&(k[n]=t[k[e]],n++);for(k.length=n,e=0,n=0;e<r;e++)-1!==t[e]&&(n!==e&&(y[n]=y[e]),n++);y=y.slice(0,n)}for(var o,i=d.length,a=0,l=0;a<i;++a)-1!==t[o=m[a]]&&(a!==l&&(d[l]=d[a]),m[l]=t[o],s&&(b[l]=b[a]),++l);for(d.length=l,s&&(b=b.slice(0,l));l<i;)m[l++]=0;var c=E(d);M=c[0],P=c[1]}function B(e){var n=e[0],r=e[1];if(w)return w=null,H((function(t,e){return n<=e&&e<r}),0===e[0]&&e[1]===d.length),M=n,P=r,C;var i,a,l,u=[],f=[],p=[],g=[];if(n<M)for(i=n,a=Math.min(M,r);i<a;++i)u.push(m[i]),p.push(i);else if(n>M)for(i=M,a=Math.min(n,P);i<a;++i)f.push(m[i]),g.push(i);if(r>P)for(i=Math.max(n,P),a=r;i<a;++i)u.push(m[i]),p.push(i);else if(r<P)for(i=Math.max(M,r),a=P;i<a;++i)f.push(m[i]),g.push(i);if(s){var x=[],_=[];for(i=0;i<u.length;i++)y[u[i]]++,b[p[i]]=0,1===y[u[i]]&&(t[h][u[i]]^=c,x.push(u[i]));for(i=0;i<f.length;i++)y[f[i]]--,b[g[i]]=1,0===y[f[i]]&&(t[h][f[i]]^=c,_.push(f[i]));if(u=x,f=_,E===Ds)for(i=0;i<k.length;i++)t[h][l=k[i]]&c&&(t[h][l]^=c,u.push(l));else for(i=0;i<k.length;i++)t[h][l=k[i]]&c||(t[h][l]^=c,f.push(l))}else{for(i=0;i<u.length;i++)t[h][u[i]]^=c;for(i=0;i<f.length;i++)t[h][f[i]]^=c}return M=n,P=r,o.forEach((function(t){t(c,h,u,f)})),v("filtered"),C}function D(t){return x=t,_=!0,B((E=js(Ys,t))(d))}function R(t){return x=t,_=!0,B((E=Bs(Ys,t))(d))}function z(){return x=void 0,_=!1,B((E=Ds)(d))}function W(t){x=t,_=!0,w=t,E=Ds,H(t,!1);var e=E(d);return M=e[0],P=e[1],C}function H(e,n){var r,i,a,l=[],f=[],p=[],g=[],w=d.length;if(!s)for(r=0;r<w;++r)!(t[h][i=m[r]]&c)^!!(a=e(d[r],r))&&(a?l.push(i):f.push(i));if(s)for(r=0;r<w;++r)e(d[r],r)?(l.push(m[r]),p.push(r)):(f.push(m[r]),g.push(r));if(s){var x=[],_=[];for(r=0;r<l.length;r++)1===b[p[r]]&&(y[l[r]]++,b[p[r]]=0,1===y[l[r]]&&(t[h][l[r]]^=c,x.push(l[r])));for(r=0;r<f.length;r++)0===b[g[r]]&&(y[f[r]]--,b[g[r]]=1,0===y[f[r]]&&(t[h][f[r]]^=c,_.push(f[r])));if(l=x,f=_,n)for(r=0;r<k.length;r++)t[h][i=k[r]]&c&&(t[h][i]^=c,l.push(i));else for(r=0;r<k.length;r++)t[h][i=k[r]]&c||(t[h][i]^=c,f.push(i))}else{for(r=0;r<l.length;r++)t[h][l[r]]&c&&(t[h][l[r]]&=u);for(r=0;r<f.length;r++)t[h][f[r]]&c||(t[h][f[r]]|=c)}o.forEach((function(t){t(c,h,l,f)})),v("filtered")}function G(e){var i={top:B,all:j,reduce:D,reduceCount:R,reduceSum:z,order:W,orderNatural:H,size:G,dispose:$,remove:$};T.push(i);var l,f,p,g,y,v,b,w,x=8,_=il(x),A=0,C=zs,k=zs,S=!0,E=e===zs;function M(i,a,c,m){s&&(w=c,c=d.length-i.length,m=i.length);var p,g,L,T,M,P,j=l,B=s?[]:rl(A,_),D=y,R=v,z=b,W=A,H=0,G=0;for(S&&(D=z=zs),S&&(R=z=zs),l=new Array(A),A=0,f=s?W?f:[]:W>1?Fs.arrayLengthen(f,r):rl(r,_),W&&(L=(g=j[0]).key);G<m&&!((T=e(i[G]))>=T);)++G;for(;G<m;){for(g&&L<=T?(M=g,P=L,B[H]=A,(g=j[++H])&&(L=g.key)):(M={key:T,value:z()},P=T),l[A]=M;T<=P&&(p=a[G]+(s?w:c),s?f[p]?f[p].push(A):f[p]=[A]:f[p]=A,M.value=D(M.value,n[p],!0),t.zeroExcept(p,h,u)||(M.value=R(M.value,n[p],!1)),!(++G>=m));)T=e(i[G]);q()}for(;H<W;)l[B[H]=A]=j[H++],q();if(s)for(var $=0;$<r;$++)f[$]||(f[$]=[]);if(A>H)if(s)for(H=0;H<w;++H)for($=0;$<f[H].length;$++)f[H][$]=B[f[H][$]];else for(H=0;H<c;++H)f[H]=B[f[H]];function q(){s?A++:++A===_&&(B=Fs.arrayWiden(B,x<<=1),f=Fs.arrayWiden(f,x),_=il(x))}p=o.indexOf(C),A>1||s?(C=N,k=O):(!A&&E&&(A=1,l=[{key:null,value:z()}]),1===A?(C=I,k=F):(C=zs,k=zs),f=null),o[p]=C}function P(t){if(A>1||s){var e,n,i,a=A,c=l,u=rl(a,a);if(s){for(e=0,i=0;e<r;++e)if(-1!==t[e]){for(f[i]=f[e],n=0;n<f[i].length;n++)u[f[i][n]]=1;++i}}else for(e=0,i=0;e<r;++e)-1!==t[e]&&(u[f[i]=f[e]]=1,++i);for(l=[],A=0,e=0;e<a;++e)u[e]&&(u[e]=A++,l.push(c[e]));if(A>1||s)if(s)for(e=0;e<i;++e)for(n=0;n<f[e].length;++n)f[e][n]=u[f[e][n]];else for(e=0;e<i;++e)f[e]=u[f[e]];else f=null;o[o.indexOf(C)]=A>1||s?(k=O,C=N):1===A?(k=F,C=I):k=C=zs}else if(1===A){if(E)return;for(var h=0;h<r;++h)if(-1!==t[h])return;l=[],A=0,o[o.indexOf(C)]=C=k=zs}}function N(e,r,o,i,a){var d,m,p,g,b;if(!(e===c&&r===h||S))if(s){for(d=0,g=o.length;d<g;++d)if(t.zeroExcept(p=o[d],h,u))for(m=0;m<f[p].length;m++)(b=l[f[p][m]]).value=y(b.value,n[p],!1,m);for(d=0,g=i.length;d<g;++d)if(t.onlyExcept(p=i[d],h,u,r,e))for(m=0;m<f[p].length;m++)(b=l[f[p][m]]).value=v(b.value,n[p],a,m)}else{for(d=0,g=o.length;d<g;++d)t.zeroExcept(p=o[d],h,u)&&((b=l[f[p]]).value=y(b.value,n[p],!1));for(d=0,g=i.length;d<g;++d)t.onlyExcept(p=i[d],h,u,r,e)&&((b=l[f[p]]).value=v(b.value,n[p],a))}}function I(e,r,o,i,a){if(!(e===c&&r===h||S)){var s,f,d,m=l[0];for(s=0,d=o.length;s<d;++s)t.zeroExcept(f=o[s],h,u)&&(m.value=y(m.value,n[f],!1));for(s=0,d=i.length;s<d;++s)t.onlyExcept(f=i[s],h,u,r,e)&&(m.value=v(m.value,n[f],a))}}function O(){var e,o,i;for(e=0;e<A;++e)l[e].value=b();if(s){for(e=0;e<r;++e)for(o=0;o<f[e].length;o++)(i=l[f[e][o]]).value=y(i.value,n[e],!0,o);for(e=0;e<r;++e)if(!t.zeroExcept(e,h,u))for(o=0;o<f[e].length;o++)(i=l[f[e][o]]).value=v(i.value,n[e],!1,o)}else{for(e=0;e<r;++e)(i=l[f[e]]).value=y(i.value,n[e],!0);for(e=0;e<r;++e)t.zeroExcept(e,h,u)||((i=l[f[e]]).value=v(i.value,n[e],!1))}}function F(){var e,o=l[0];for(o.value=b(),e=0;e<r;++e)o.value=y(o.value,n[e],!0);for(e=0;e<r;++e)t.zeroExcept(e,h,u)||(o.value=v(o.value,n[e],!1))}function j(){return S&&(k(),S=!1),l}function B(t){var e=p(j(),0,l.length,t);return g.sort(e,0,e.length)}function D(t,e,n){return y=t,v=e,b=n,S=!0,i}function R(){return D(Us,Js,Ws)}function z(t){return D(Qs(t),Ks(t),Ws)}function W(t){function e(e){return t(e.value)}return p=qs.by(e),g=Gs.by(e),i}function H(){return W(Rs)}function G(){return A}function $(){var t=o.indexOf(C);return t>=0&&o.splice(t,1),(t=L.indexOf(M))>=0&&L.splice(t,1),(t=a.indexOf(P))>=0&&a.splice(t,1),(t=T.indexOf(i))>=0&&T.splice(t,1),i}return arguments.length<1&&(e=Rs),o.push(C),L.push(M),a.push(P),M(d,m,0,r),R().orderNatural()}function $(){T.forEach((function(t){t.dispose()}));var e=i.indexOf(O);return e>=0&&i.splice(e,1),(e=i.indexOf(F))>=0&&i.splice(e,1),(e=a.indexOf(j))>=0&&a.splice(e,1),t.masks[h]&=u,z()}return u=~(c=I.one),f=(h=I.offset)<<7|Math.log(c)/Math.log(2),O(n,0,r),F(0,0,r),C}function d(){var e,a,s,l,c={reduce:d,reduceCount:m,reduceSum:function(t){return d(Qs(t),Ks(t),Ws)},value:function(){return u&&(function(){var o;for(e=l(),o=0;o<r;++o)e=a(e,n[o],!0),t.zero(o)||(e=s(e,n[o],!1))}(),u=!1),e},dispose:p,remove:p},u=!0;function h(o,i){var l;if(!u)for(l=i;l<r;++l)e=a(e,n[l],!0),t.zero(l)||(e=s(e,n[l],!1))}function f(r,o,i,l,c){var h,f,d;if(!u){for(h=0,d=i.length;h<d;++h)t.zero(f=i[h])&&(e=a(e,n[f],c));for(h=0,d=l.length;h<d;++h)t.only(f=l[h],o,r)&&(e=s(e,n[f],c))}}function d(t,e,n){return a=t,s=e,l=n,u=!0,c}function m(){return d(Us,Js,Ws)}function p(){var t=o.indexOf(f);return t>=0&&o.splice(t,1),(t=i.indexOf(h))>=0&&i.splice(t,1),c}return o.push(f),i.push(h),h(0,0),m()}function m(){return r}function p(){return n}function g(e){var o=[],i=0,a=u(e||[]);for(i=0;i<r;i++)t.zeroExceptMask(i,a)&&o.push(n[i]);return o}function y(t){if("function"==typeof t)return s.push(t),function(){s.splice(s.indexOf(t),1)};console.warn("onChange callback parameter must be a function!")}function v(t){for(var e=0;e<s.length;e++)s[e](t)}return t=new Fs.bitarray(0),arguments.length?l(arguments[0]):e}function rl(t,e){return(e<257?Fs.array8:e<65537?Fs.array16:Fs.array32)(t)}function ol(t){for(var e=rl(t,t),n=-1;++n<t;)e[n]=n;return e}function il(t){return 8===t?256:16===t?65536:4294967296}function al(){var t,e=[],n=this.annots;for(t=0;t<n.length;t++)e=e.concat(n[t].annots);return e}function sl(t){var e,n,r,o=[],i=this.annots;for(e in i)o.push({chr:i[e].chr,annots:[]});for(r=0;r<t.length;r++)o[(n=t[r]).chrIndex].annots.push(n);return o}function ll(){var t,e,n=this.rawAnnots.keys;for(this.unpackedAnnots=this.unpackAnnots(),this.crossfilter=nl(this.unpackedAnnots),this.annotsByFacet={},this.facets=n.slice(3,n.length),t=0;t<this.facets.length;t++)this.annotsByFacet[e=this.facets[t]]=this.crossfilter.dimension((function(t){return t[e]}));"filterSelections"in this&&this.filterAnnots(this.filterSelections),this.filteredAnnots=this.annots}function cl(t){var e,n,r,o=Date.now();for(this.filterSelections=t,[n,r]=function(t,e){var n,r,o,i,a,s={};if(0===Object.keys(t).length)i=e.unpackedAnnots;else{for(r=0;r<e.facets.length;r++)(o=e.facets[r])in t?(a=t[o],n=Array.isArray(a)?function(t){return 2===a.length?a[0]<=t&&t<a[1]:4===a.length?a[0]<=t&&t<a[1]||a[2]<=t&&t<a[3]:void 0}:function(t){return t in a}):n=null,e.annotsByFacet[o].filter(n),s[o]=e.annotsByFacet[o].group().top(Infinity);i=e.annotsByFacet[o].top(Infinity)}return[i,s]}(t,this);e<this.facets.length;e++)this.annotsByFacet[void 0].filterAll();return n=this.packAnnots(n),delete this.maxAnnotsPerBar,delete this.maxAnnotsPerBarAllChrs,this.filteredAnnots=n,Go.selectAll(this.selector+" polygon.annot").remove(),this.drawAnnots(n),console.log("Time in filterAnnots: "+(Date.now()-o)+" ms"),r}function ul(t){var e,n,r,o,i=t.id.split("-")[1];return n=this.config.chrHeight,r=0,(o=void 0!==(e=t.bands))?[e,t,r]=function(t,e,n,r){var o,i,a,s,l=0,c=e.id.split("-")[1],u=r.coordinateSystem,h=r.config.chrHeight;for(o=0;o<t.length;o++)a=(i=t[o])[u].stop-i[u].start,t[o].px={start:l,stop:l+(s=r._layout._isRotated?h*a/e.length:h*e.length/("relative"===r.config.chromosomeScale?r.maxLength[c][u]:r.maxLength[u])*a/e.length),width:s},l=t[o].px.stop,n&&"acen"===i.stain&&"p"===i.name[0]&&(e.pcenIndex=o);return[t,e,l]}(e,t,o,this):r=n*t.length/("relative"===this.config.chromosomeScale?this.maxLength[i][this.coordinateSystem]:this.maxLength[this.coordinateSystem]),t.width=r,t.scale=function(t,e,n){var r=n.config.chrHeight,o=t.length,i=n.maxLength,a=t.id.split("-")[1],s={};return s.bp=r/i.bp,!0===n.config.multiorganism?"relative"===n.config.chromosomeScale?(s.iscn=r*o/i[a].bp,s.bp=r/i[a].bp):s.iscn=r*o/i.bp:e&&(s.iscn=r/i.iscn),s}(t,o,this),t.bands=e,t}function hl(t,e,n,r){var o,i={};return o=void 0!==t,(i=function(t,e,n,r){if(void 0!==e){const o=e[e.length-1];t.name=n,t.length=o[r.coordinateSystem].stop,t.bpLength=o.bp.stop,t.type="nuclear"}else t=n;return t}(i,t,e,this)).chrIndex=r,i.id="chr"+i.name+"-"+n,!0===this.config.fullChromosomeLabels&&(i.name=this.organisms[n].scientificName+" chr"+i.name),i.bands=t,(i=this.getChromosomePixels(i)).centromerePosition=function(t,e){if(!1===t)return"";const n=e[0],r=e.slice(-1)[0],o=(r.bp.stop-n.bp.start)/20;return"p"===n.name[0]&&"q"===e[1].name[0]&&n.bp.stop-n.bp.start<o?"telocentric-p":"p"===e.slice(-2)[0].name[0]&&"q"===r.name[0]&&r.bp.stop-r.bp.start<o?"telocentric-q":""}(o,t),function(t,e){return e&&1===t.bands.length&&delete t.bands,t}(i,o)}function fl(t){t.forEach(t=>{t.classList.remove("active")})}function dl(){fl(document.querySelectorAll("#tools > ul > li")),document.querySelectorAll(".ideo-modal, .ideo-tool-panel").forEach(t=>{t.remove()}),document.querySelector("#tools").style.display="none"}nl.heap=Gs,nl.heapselect=qs,nl.bisect=Ys,nl.permute=Xs;class ml{constructor(t){this._model=t,this._class="ModelAdapter"}static getInstance(t){return t.bands?new ml(t):new pl(t)}getModel(){return this._model}getCssClass(){return""}}class pl extends ml{constructor(t){super(t),this._class="ModelNoBandsAdapter"}getModel(){this._model.bands=[];const t=this._model.width;return(t>1||"MT"===this._model.name)&&this._model.bands.push({name:"q",px:{start:0,stop:t,width:t},bp:{start:1,stop:this._model.bpLength},iscn:{start:1,stop:this._model.length}}),this._model}getCssClass(){return"noBands"}}class gl{constructor(t){this._config=t,this._ploidy=new fi(this._config)}getArmColor(t,e,n){return this._config.armColors?this._config.armColors[n]:this._config.ancestors?this._getPolyploidArmColor(t,e,n):null}getBorderColor(t,e,n){const r=this._config,o=r.chrBorderColor?r.chrBorderColor:"#000";return e<r.ploidy||this._ploidy.exists(t,e,n)?o:"#fff"}_getPolyploidArmColor(t,e,n){if(this._ploidy.exists(t,e,n)){var r=this._ploidy.getAncestor(t,e,n);return this._config.ancestors[r]}return"transparent"}}class yl{constructor(t){this._data=t,this.start=t.start,this.stop=t.stop,this.length=this.stop-this.start}getColor(t){return"ploidy"in this._data?"ploidy"in this._data&&this._data.ploidy[t]?this._getColor(t):"transparent":this._getColor(t)}_getColor(t){return Array.isArray(this._data.color)?this._data.color[t]:this._data.color}}class vl{constructor(t,e,n){this._adapter=t,this._model=this._adapter.getModel(),this._config=e,this._ideo=n,this._color=new gl(this._config),this._bumpCoefficient=5}static getInstance(t,e,n){const r=t.getModel().centromerePosition;return"telocentric-p"===r?new wl(t,e,n):"telocentric-q"===r?new xl(t,e,n):new bl(t,e,n)}_addPArmShape(t,e){return e?t.concat(this._getPArmShape()):t}_addQArmShape(t,e){return e?t.concat(this._getQArmShape()):t}render(t,e,n){var r,o,i,a,s,l,c;return r=this,t=t.append("g").attr("class","bands").attr("clip-path","url(#"+this._model.id+"-chromosome-set-clippath)"),o=this._renderArm(t,e,n,"p"),i=this._renderArm(t,e,n,"q"),this._renderRangeSet(t,e,n),a=this._addPArmShape(a=[],o),a=this._addQArmShape(a,i),s="0",l="",c=this.isFullyBanded(),"ancestors"in this._ideo.config&&!("rangeSet"in this._ideo.config)?(l=r._color.getArmColor(e,n,0),c&&(s="0.5")):c?(s=null,l="transparent"):"ancestors"in this._ideo.config||(s="1"),t.append("g").attr("class","chromosome-border").selectAll("path").data(a).enter().append("path").attr("fill",l).style("fill-opacity",s).attr("stroke",(function(t,o){return r._color.getBorderColor(e,n,o)})).attr("stroke-width",(function(t){return"strokeWidth"in t?t.strokeWidth:1})).attr("d",(function(t){return t.path})).attr("class",(function(t){return t.class})),a}_renderRangeSet(t,e,n){var r,o,i,a;"rangeSet"in this._config&&(o=this._config.rangeSet.filter((function(t){return t.chr-1===e})).map((function(t){return new yl(t)})),i=t.append("g").attr("class","range-set"),a=(r=this)._ideo,i.selectAll("rect.range").data(o).enter().append("rect").attr("class","range").attr("x",(function(t){return a.convertBpToPx(r._model,t.start)})).attr("y",0).attr("width",(function(t){return a.convertBpToPx(r._model,t.length)})).attr("height",this._config.chrWidth).style("fill",(function(t){return t.getColor(n)})))}_getShapeData(){var t,e,n;for(e=0;e<this._model.bands.length;e++)if("q"===this._model.bands[e].name[0]){t=this._model.bands[e];break}return n=this._model.bands[this._model.bands.length-1].px.stop,{x1:0,x2:t?t.px.start:n,x3:n,w:this._config.chrWidth,b:this._config.chrWidth/this._bumpCoefficient}}_getPArmShape(){var t=this._getShapeData(),e=t.x2-t.b;return this.isFullyBanded()||"ancestors"in this._ideo.config?{class:"",path:"M"+t.b+",0 L"+e+",0 Q"+(t.x2+t.b)+","+t.w/2+","+e+","+t.w+" L"+t.b+","+t.w+" Q-"+t.b+","+t.w/2+","+t.b+",0"}:[{class:"",path:"M"+t.b+",0 L"+(e-2)+",0 L"+(e-2)+","+t.w+" L"+t.b+","+t.w+" Q-"+t.b+","+t.w/2+","+t.b+",0"},{class:"acen",path:"M"+e+",0 Q"+(t.x2+t.b)+","+t.w/2+","+e+","+t.w+" L"+e+","+t.w+" L"+(e-2)+","+t.w+" L"+(e-2)+",0"}]}_getQArmShape(){var t=this._getShapeData(),e=t.x3-t.b,n=t.x2+t.b;return this.isFullyBanded()||"ancestors"in this._ideo.config?{class:"",path:"M"+n+",0 L"+e+",0 Q"+(t.x3+t.b)+","+t.w/2+","+e+","+t.w+" L"+n+","+t.w+" Q"+(t.x2-t.b)+","+t.w/2+","+n+",0"}:[{path:"M"+n+",0 L"+e+",0 Q"+(t.x3+t.b)+","+t.w/2+","+e+","+t.w+" L"+n+","+t.w+" L"+n+",0"},{class:"acen",path:"M"+n+",0Q"+(t.x2-t.b)+","+t.w/2+","+n+","+t.w+" L"+n+","+t.w+"L"+(n+2)+","+t.w+"L"+(n+2)+",0"}]}isFullyBanded(){return this._model.bands&&(2!==this._model.bands.length||"q"===this._model.bands[0].name[0])}_renderBands(t,e,n,r,o){var i,a,s;a="p"===o?0:1,s="","ancestors"in(i=this)._ideo.config&&!i.isFullyBanded()&&(s=i._color.getArmColor(e,n,a)),t.selectAll("path.band."+o).data(r).enter().append("path").attr("id",(function(t){return i._model.id+"-"+t.name.replace(".","-")})).attr("class",(function(t){return"band "+o+"-band "+t.stain})).attr("d",(function(t){var e;return"M "+i._ideo.round(t.px.start)+", 0l "+(e=i._ideo.round(t.px.width))+" 0 l 0 "+i._config.chrWidth+" l -"+e+" 0 z"})).style("fill",s)}_renderArm(t,e,n,r){var o=this._model.bands.filter((function(t){return t.name[0]===r}));return this._renderBands(t,e,n,o,r),Boolean(o.length)}}class bl extends vl{constructor(t,e,n){super(t,e,n),this._class="MetacentricChromosome"}}class wl extends vl{constructor(t,e,n){super(t,e,n),this._class="TelocentricPChromosome",this._pArmOffset=3}_addPArmShape(t){return t.concat(this._getPArmShape())}_getPArmShape(){var t=this._getShapeData();return t.o=this._pArmOffset,[{class:"acen",path:"M"+(t.x2+2)+",1L"+(t.x2+t.o+3.25)+",1 L"+(t.x2+t.o+3.25)+","+(t.w-1)+" L"+(t.x2+2)+","+(t.w-1)},{class:"gpos66",path:"M"+(t.x2-t.o+5)+",0L"+(t.x2-t.o+3)+",0 L"+(t.x2-t.o+3)+","+t.w+" L"+(t.x2-t.o+5)+","+t.w,strokeWidth:.5}]}_getQArmShape(){var t=this._getShapeData(),e=t.x3-t.b,n=this._pArmOffset+3;return{class:"",path:"M"+(t.x2+n)+",0 L"+e+",0 Q"+(t.x3+t.b)+","+t.w/2+","+e+","+t.w+" L"+(t.x2+n)+","+t.w}}}class xl extends vl{constructor(t,e,n){super(t,e,n),this._class="TelocentricQChromosome",this._qArmOffset=3}_getPArmShape(){var t=this._getShapeData(),e=t.x3-t.b,n=this._qArmOffset;return{class:"",path:"M"+(t.x2+n)+",0 L"+(e+n)+",0 L"+(e+n)+","+t.w+" L"+t.b+","+t.w+" Q-"+t.b+","+t.w/2+","+t.b+",0"}}_addQArmShape(t){return t.concat(this._getQArmShape())}_getQArmShape(){var t=this._getShapeData();return t.o=this._qArmOffset,[{class:"acen",path:"M"+(t.x2+2)+",1 L"+(t.x2+t.o+3.25)+",1 L"+(t.x2+t.o+3.25)+","+(t.w-1)+" L"+(t.x2+2)+","+(t.w-1)},{class:"gpos66",path:"M"+(t.x2+t.o+5)+",0 L"+(t.x2+t.o+3)+",0 L"+(t.x2+t.o+3)+","+t.w+" L"+(t.x2+t.o+5)+","+t.w,strokeWidth:.5}]}}function _l(t,e,n,r){var o,i,a,s,l;s=Go.select(this.selector+" defs"),l=ml.getInstance(t),o=n*this.config.chrMargin,i=r.append("g").attr("id",t.id).attr("class","chromosome "+l.getCssClass()).attr("transform","translate(0, "+o+")"),a=vl.getInstance(l,this.config,this).render(i,e,n),Go.select("#"+t.id+"-chromosome-set-clippath").remove(),s.append("clipPath").attr("id",t.id+"-chromosome-set-clippath").selectAll("path").data(a).enter().append("path").attr("d",(function(t){return t.path})).attr("class",(function(t){return t.class})),t.width<1&&Go.select("#"+t.id+" .bands").style("opacity",0)}function Al(t){var e,n,r,o,i,a;if(o=this._layout.getChromosomeSetTranslate(e=t.chrIndex),Go.selectAll((a=this.selector+" #"+t.id+"-chromosome-set")+" g").remove(),0===(n=Go.select(a)).nodes().length&&(n=Go.select(this.selector).append("g").attr("class","chromosome-set").attr("transform",o).attr("id",t.id+"-chromosome-set")),"sex"in this.config&&2===this.config.ploidy&&this.sexChromosomes.index===e)this.drawSexChromosomes(n,e);else for(r=1,this.config.ploidy>1&&(r=this._ploidy.getChromosomesNumber(e)),i=0;i<r;i++)this.appendHomolog(t,e,i,n)}function Cl(t){var e,n;this.unhighlight(),this.config.taxid&&(e=t.id.split("-")[0].replace("chr",""),this._layout.rotate(n=this.chromosomes[this.config.taxid][e].chrIndex,n,t))}function kl(){var t,e,n,r,o,i,a;o=Go.select((t=this.config).container+" svg#_ideogram"),n=Go.select(t.container+" #_ideogramInnerWrap"),r=Go.select(t.container+" #_ideogramMiddleWrap"),a=1===(i=t.ploidy)?i:1.12*i;let s=0;"annotationsLayout"in t&&(s=t.annotationHeight*t.numAnnotTracks),"vertical"===t.orientation&&"comparative"!==t.perspective&&"collinear"!==t.geometry&&(e=this.numChromosomes*(t.chrWidth+t.chrMargin+s),"heatmap-2d"!==t.annotationsLayout&&(e=Math.ceil(e*a/t.rows),"SmallLayout"===this._layout._class&&(e+=100),e+=35,r.style("height",this._layout.getHeight()+"px"),n.style("max-width",e+"px").style("overflow-x","scroll").style("position","absolute"),o.style("min-width",e-5+"px"),this.config.showTools&&(document.querySelector(this.selector).insertAdjacentHTML("beforebegin",'\n    \n  <style>\n\n    #gear {\n      position: absolute;\n      right: 3px;\n      top: 24px;\n      z-index: 8001;\n      cursor: pointer;\n      height: 18px;\n      width: 18px;\n    }\n\n    #tools {\n      position: absolute;\n      width: 120px;\n      right: 27px;\n      top: 16px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      border: 1px solid #CCC;\n      border-radius: 4px;\n      box-shadow: -2px 4px 6px #CCC;\n    }\n\n    #tools ul {\n      margin-block-start: 0;\n      margin-block-end: 0;\n      padding-inline-start: 0;\n    }\n\n    #tools li, #download li {\n      padding: 2px 12px 2px 12px;\n      cursor: pointer;\n    }\n\n    #tools li:hover,\n    #tools li.active,\n    #download li:hover {\n      background: #DDD;\n    }\n\n    #tools li.ideo-disabled,\n    #tools li.active.ideo-disabled,\n    #download li.ideo-disabled {\n      background: #FFF;\n      color: #CCC;\n      cursor: default;\n    }\n\n    #download {\n      position: absolute;\n      right: 3px;\n      top: 16px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      padding-inline-start: 0;\n    }\n\n    #settings {\n      position: absolute;\n      right: 3px;\n      top: 16px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      padding-inline-start: 0;\n    }\n\n    #about {\n      position: absolute;\n      right: 24px;\n      top: -8px;\n      z-index: 8000;\n      background: white;\n      width: 300px;\n      border: 1px solid #CCC;\n      padding: 10px;\n      border-radius: 4px;\n      box-shadow: -2px 4px 6px #CCC;\n      cursor: default;\n    }\n\n    #close {\n      float: right;\n      border: 1px solid #DDD;\n      border-radius: 4px;\n      padding: 0 6px;\n      background: #EEE;\n      font-weight: bold;\n      cursor: pointer;\n    }\n\n    #settings label {\n      display: inline;\n      text-decoration: underline;\n      text-decoration-style: dotted;\n      cursor: pointer;\n    }\n\n    #download {\n      position: absolute;\n      width: 120px;\n      top: -2px;\n      right: 120px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      border: 1px solid #CCC;\n      border-radius: 4px;\n      box-shadow: -2px 4px 6px #CCC;\n    }\n\n    li {\n      list-style-type: none;\n    }\n\n    #settings .no-underline {\n      text-decoration: none;\n    }\n\n    #settings .setting {\n      margin-right: 8px;\n    }\n\n    #settings input[type="checkbox"], #settings input[type="radio"] {\n      position: relative;\n      top: 2px;\n    }\n\n    .area-header {\n      font-size: 16px;\n      font-weight: bold;\n      margin-bottom: 10px;\n      clear: both;\n    }\n\n    .area-content {\n      display: flex;\n      flex-wrap: wrap;\n    }\n\n    .area-content > div {\n      margin-right: 30px;\n      margin-bottom: 15px;\n    }\n\n    .tab-panel input[type="number"] {\n      width: 50px;\n    }\n\n    .tab-panel ul {\n      width: 600px;\n      list-style: none;\n      border-bottom: 1px solid #CCC;\n      box-sizing: border-box;\n      margin-bottom: 0;\n      padding-left: 0;\n    }\n\n    .tab-panel .nav:before, .tab-panel .nav:after {\n      content: " ";\n      display: table;\n      clear: both;\n    }\n\n    .tab-panel li {\n      float: left;\n      margin-right: 2px;\n      display: block;\n      margin-bottom: -1px;\n    }\n\n    .tab-panel li > a {\n      padding: 10px 15px;\n      text-decoration: none;\n      border-radius: 4px 4px 0 0;\n      display: block;\n      position: relative;\n    }\n\n    .tab-panel li.active > a {\n      border: 1px solid #CCC;\n      border-bottom: none;\n      background-color: white;\n    }\n\n    .tab-panel .tab-content {\n      width: 600px;\n    }\n\n    .tab-panel .tab-content > div {\n      display: none;\n      padding-top: 20px;\n      clear: both;\n    }\n\n    .tab-panel .tab-content > div {\n      padding: 20px 10px 5px 10px;\n    }\n\n    .tab-panel .tab-content > div.active {\n      display: block;\n      border: 1px solid #CCC;\n      border-top: none;\n    }\n\n  </style>\n    <div id="gear" style="display: none"><svg viewBox="0 0 512 512"><path fill="#AAA" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"/></svg></div>\n    <div id="tools" style="display: none">\n      <ul>\n        <li id="download-tool" class="ideo-tool-hover">Download <span style="float: right">&blacktriangleright;</span></li>\n        <li id="about-tool">About</li>\n      </ul>\n    </div>'),function(t){document.querySelector("#gear").addEventListener("click",t=>{var e=document.querySelector("#tools");"none"===e.style.display?(e.style.display="",function(t){const e=document.querySelectorAll("#gear, #tools"),n=t=>{let n=0;e.forEach(e=>{e.contains(t.target)||(n+=1)}),n===e.length&&(dl(),r())},r=()=>{document.removeEventListener("click",n)};document.addEventListener("click",n)}()):(e.style.display="none",dl())}),function(t){const e=document.querySelectorAll("#tools > ul > li");e.forEach(n=>{const r=function(t){return Array.from(t.classList).includes("ideo-tool-hover")?"mouseenter":"click"}(n);n.addEventListener(r,o=>{fl(e),n.classList+=" active";const i=n.id.split("-")[0],a=function(t,e){var n;return"download"===t&&(n=`\n    <div id="download" class="ideo-tool-panel">\n      <li id="download-image">Image</li>\n      <li id="download-annots" class="${document.querySelectorAll(".annot").length>0?"":"ideo-disabled"}">Annotations</li>\n    </div>\n  `),"about"===t&&(n='\n    <div id="about" class="ideo-modal">\n      \n    <a href="https://github.com/eweitz/ideogram" target="_blank" rel="noopener">\n      Ideogram.js</a>, version 1.31.0 <span id="close">x</span><br/>\n      <i>Chromosome visualization for the web</i>\n    </div>'),n.trim()}(i);"mouseenter"===r?(n.insertAdjacentHTML("beforeend",a),function(t,e,n,r){"mouseenter"===t&&n.addEventListener("mouseleave",t=>{const n=t.toElement,o=n.id,i=document.querySelector(".ideo-tool-panel");document.querySelector("#tools").contains(n)&&i&&!i.contains(n)&&o!==e&&(fl(r),i.remove())})}(r,i,n,e),"download"===i&&(document.querySelector("#download-image").addEventListener("click",e=>{dl(),function(t){var e=document.querySelector(t.selector),n="_ideo-undisplayed-dl-canvas";(r=document.createElement("canvas")).setAttribute("style","display: none"),r.setAttribute("id",n);var r,o=e.width.baseVal.value+30,i=e.cloneNode(!0);i.style.left="",r.setAttribute("width",o),document.body.appendChild(r),(r=document.getElementById(n)).width*=2,r.height*=2;var a=r.getContext("2d");a.setTransform(2,0,0,2,0,0),a.imageSmoothingEnabled=!1;var s=(new XMLSerializer).serializeToString(i),l=window.URL||window.webkitURL||window,c=new Image,u=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),h=l.createObjectURL(u);c.onload=function(){a.drawImage(c,0,0),l.revokeObjectURL(h),function(t){var e=new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}),n=document.createElement("a");n.setAttribute("download","ideogram.png"),n.setAttribute("href",t),n.setAttribute("target","_blank"),n.setAttribute("id","_ideo-undisplayed-dl-image-link"),n.setAttribute("style","display: none;"),document.body.appendChild(n),n.dispatchEvent(e),r.remove()}(r.toDataURL("image/png").replace("image/png","image/octet-stream"))},c.src=h}(t)}),document.querySelector("#download-annots").addEventListener("click",e=>{const n=document.querySelector("#download-annots");!1===Array.from(n.classList).includes("ideo-disabled")&&(dl(),t.downloadAnnotations())}))):document.querySelector("#gear").insertAdjacentHTML("beforeend",a)})}),document.querySelectorAll("#close").forEach(t=>{t.addEventListener("click",()=>{dl()})})}(t)}(this),function(t){const e=document.querySelector(t.selector),n=document.querySelector("#gear"),r=document.querySelector("#tools");e.addEventListener("mouseover",()=>n.style.display=""),e.addEventListener("mouseout",()=>{"none"===r.style.display&&(n.style.display="none")}),n.addEventListener("mouseover",()=>n.style.display="")}(this))))}function Sl(){var t,e;e=(t=this)._layout,Go.selectAll(t.selector+" .chromosome-set").insert("text",":first-child").data(t.chromosomesArray).attr("class",e.getChromosomeLabelClass()).attr("transform",e.getChromosomeSetLabelTranslate()).attr("x",e.getChromosomeSetLabelXPosition()).attr("y",(function(t,n){return e.getChromosomeSetLabelYPosition(n)})).attr("text-anchor",e.getChromosomeSetLabelAnchor()).each((function(e,n){!function(t,e,n,r){var o=function(t,e,n){var r;return r=-1===t.name.indexOf(" ")?[t.name]:t.name.match(/^(.*)\s+([^\s]+)$/).slice(1).reverse(),"sex"in n.config&&2===n.config.ploidy&&e===n.sexChromosomes.index&&(r="male"===n.config.sex?["XY"]:["XX"]),r}(t,e,r);Go.select(n).selectAll("tspan").data(o).enter().append("tspan").attr("dy",(function(t,e){return-1.2*e+"em"})).attr("x",r._layout.getChromosomeSetLabelXPosition()).attr("class",(function(t,e){return 1===e&&r.config.fullChromosomeLabels?"italic":null})).text(String)}(e,n,this,t)})),function(t){var e=t._layout;Go.selectAll(t.selector+" .chromosome-set").each((function(n,r){Go.select(this).selectAll(".chromosome").append("text").attr("class","chrLabel").attr("transform",e.getChromosomeSetLabelTranslate()).attr("x",(function(t,n){return e.getChromosomeLabelXPosition(n)})).attr("y",(function(t,n){return e.getChromosomeLabelYPosition(n)})).text((function(e,n){return t._ploidy.getAncestor(r,n)})).attr("text-anchor","middle")}))}(this)}function El(t,e,n,r){var o;e-=1,o=function(t){var e,n,r;return void 0===t||!t.hasOwnProperty("x")||1===t.x&&1===t.y?(e=-8,n=-16,t={x:1,y:1},r=""):(r="scale("+t.x+","+t.y+")",e=-6,n=""===t?-16:-14),{x:e,y:n,scaleSvg:r,scale:t}}(r),"vertical"===n||""===n?function(t,e,n,r){var o,i,a,s=r.config;e=function(t,e){return(e.numAnnotTracks>1||""===e.orientation)&&(t-=1),t}(e,s),o=-4,!0===s.showBandLabels&&(o=s.chrMargin+s.chrWidth+26),i=s.chrMargin*e,s.numAnnotTracks>1==0&&(i+=1),a=i+o,t.selectAll("text.chrLabel").attr("transform",n.scaleSvg).selectAll("tspan").attr("x",n.x).attr("y",a)}(t,e,o,this):function(t,e,n,r){var o,i,a,s=r.config;o=-s.chrWidth-2,!0===s.showBandLabels&&(o=s.chrMargin+8),i=s.annotTracksHeight,"overlay"!==s.annotationsLayout&&(i*=2),a=3-(s.chrMargin*e+o)+i,a/=n.scale.x,t.selectAll("text.chrLabel").attr("transform","rotate(-90)"+n.scaleSvg).selectAll("tspan").attr("x",a).attr("y",n.y)}(t,e,o,this)}function Ll(t){return Math.round(performance.now()-t)}function Tl(t){t.time={rg:{t0:performance.now()}},"_didRelatedGenesFirstPlot"in t&&delete t._didRelatedGenesFirstPlot}function Ml(){const t=this.annotDescriptions.annots,e=Object.values(t),n=e.filter(t=>t.type.includes("paralogous")),r=e.filter(t=>t.type.includes("interacting gene"));return{related:e,paralogous:n,interacting:r,searched:Object.entries(t).filter(t=>t[1].type.includes("searched gene"))[0][0]}}function Pl(t){if(performance.now()-this.time.prevTooltipOff<300&&t.domId===this.time.prevTooltipAnnotDomId)return null;const e=t.name,n=this.annotDescriptions.annots[t.name].type.split(" ")[0],r=Nl(this);return Object.assign({tooltipGene:e,tooltipRelatedType:n},r)}function Nl(t){const e=t.getRelatedGenesByType();return{numRelatedGenes:e.related.length,numParalogs:e.paralogous.length,numInteractingGenes:e.interacting.length,searchedGene:e.searched}}async function Il(t){const e=await fetch("https://mygene.info/v3/query"+t+"&size=20");return await e.json()}function Ol(t){const e=t.name,n=t.genomic_pos.ensemblgene;let r=n;return void 0===n&&(r=t.genomic_pos.filter(t=>!t.chr.includes("_"))[0].ensemblgene),{name:e,ensemblId:r}}function Fl(t,e,n="red"){let r=null;return r=Array.isArray(t.genomic_pos)?t.genomic_pos.filter(t=>t.chr in e.chromosomes[e.config.taxid])[0]:t.genomic_pos,{name:t.symbol,chr:r.chr,start:r.start,stop:r.end,id:r.ensemblgene,color:n}}function jl(){const t=document.querySelector("#_ideogramInnerWrap"),e=`position: absolute; top: 15px; left: ${Ul({}).legendPad+20}px`,n=document.querySelector("#_ideogramLegend");t.prepend(n),n.style=e}function Bl(t,e){return new Promise(async n=>{const r=performance.now(),o=await async function(t,e){const n={},r={},o=e.config.organism.replace(/-/g," "),i=`https://webservice.wikipathways.org/findInteractions?query=${t.name}&format=json`,a=await fetch(i);return(await a.json()).result.forEach(i=>{if(i.species.toLowerCase()===o){const o=i.fields.right.values.concat(i.fields.left.values),a=i.name,s=i.id;o.forEach(o=>{if(o.includes(t.name))return;const i=a+s;if(function(t,e,n,r,o){let i;return i="geneCache"in o&&e.name?t in o.geneCache.lociByName:function(t,e){return""!==t&&!t.includes(" ")&&!t.includes("/")&&t.toLowerCase()!==e.name.toLowerCase()}(t,e),i&&!(n in r)}(o,t,i,r,e)){r[i]=1;const t={name:a,pathwayId:s};o in n?n[o].push(t):n[o]=[t]}})}}),n}(t,e),i=await async function(t,e,n){const r=[],o=Object.keys(t);if(0===o.length)return r;const i=`?q=${o.map(t=>"symbol:"+t.trim()).join(" OR ")}&species=${n.config.taxid}&fields=symbol,genomic_pos,name`;return(await Il(i)).hits.forEach(o=>{if("genomic_pos"in o==0||o.symbol===e.name)return;const i=Fl(o,n,"purple");r.push(i),zl(i,function(t,e,n){const r=[],o=[];let i="";if(void 0!==e){const t="https://www.wikipathways.org/index.php/Pathway:",a=e.map(e=>{const n=`${t}${e.pathwayId}`;return r.push(e.pathwayId),o.push(e.name),`<a href="${n}" target="_blank">${e.name}</a>`}).join("<br/>");i=`Interacts with ${n.name} in:<br/>${a}`}const{name:a,ensemblId:s}=Ol(t);return{description:i,ixnsDescription:i,ensemblId:s,name:a,type:"interacting gene",pathwayIds:r,pathwayNames:o}}(o,t[o.symbol],e),n)}),r}(o,t,e);e.relatedAnnots.push(...i),Hl("interacting",e),e.time.rg.interactions=Ll(r),n()})}function Dl(t,e){return new Promise(async n=>{const r=performance.now(),o=await async function(t,e){const n=`/homology/id/${t.id}?${"&format=condensed&type=paralogues&target_taxon="+e.config.taxid}`,r=(await Ideogram.fetchEnsembl(n)).data[0].homologies;return await async function(t,e,n){const r=[],o=`?q=${t.map(t=>"ensemblgene:"+t.id).join(" OR ")}&species=${n.config.taxid}&fields=symbol,genomic_pos,name`;return(await Il(o)).hits.forEach(t=>{if("genomic_pos"in t==0)return;if("name"in t==0)return;const o=Fl(t,n,"pink");r.push(o);const i="Paralog of "+e.name,{name:a,ensemblId:s}=Ol(t);zl(o,{description:i,ensemblId:s,name:a,type:"paralogous gene"},n)}),r}(r,t,e)}(t,e);e.relatedAnnots.push(...o),Hl("paralogous",e),e.time.rg.paralogs=Ll(r),n()})}function Rl(t,e){var n,r,o,i;return"name"in t?(n=t.name,r=e.name,o=t.color,i=e.color):([n,o]=[t[0],t[3]],[r,i]=[e[0],e[3]]),"red"===o?-1:"red"===i?1:"purple"===o&&"pink"===i?-1:"purple"===i&&"pink"===o?1:r.length!==n.length?r.length-n.length:0===[n,r].sort().indexOf(n)?1:-1}function zl(t,e,n){let r;const o=n.annotDescriptions.annots;t.name in o?(r=o[t.name],r.type+=", "+e.type,r.description+="<br/><br/>"+e.description):r=e,n.annotDescriptions.annots[t.name]=r}function Wl(t){const e={};let n=[];return t.forEach(t=>{t.name in e==0?(n.push(t),e[t.name]=1):"purple"===t.color&&(n=n.map(e=>t.name===e.name?t:e))}),n}function Hl(t,e){let n=e.relatedAnnots.slice();n=function(t,e){if("all"===e.config.annotsInList)return t;const n=[];return t.forEach(t=>{e.config.annotsInList.includes(t.name.toLowerCase())&&n.push(t)}),n}(n,e),n=Wl(n),e.relatedAnnots=Wl(n),n.sort(Rl),e.relatedAnnots.sort(Rl),n.length>1&&e.onFindRelatedGenesCallback&&e.onFindRelatedGenesCallback(),e.drawAnnots(n),e.config.showAnnotLabels&&(function(t){const e=[],n=t.chromosomesArray.map(t=>t.name),r={};t.relatedAnnots.forEach(t=>{t.chr in r?r[t.chr].push(t):r[t.chr]=[t]});const o={};Object.entries(r).map(([e,n])=>{n.sort((e,n)=>t.annotSortFunction(e,n));const r=n.map(t=>t.name).reverse();o[e]=r}),t.relatedAnnots.forEach(t=>{const r=t.chr,i=n.indexOf(r),a=o[r].indexOf(t.name);t.domId=ja(i,a),e.push(t)}),t.relatedAnnots=e}(e),e.fillAnnotLabels(e.relatedAnnots)),jl(),function(t,e){const n=e.getRelatedGenesByType(),r={paralogous:"interacting",interacting:"paralogous"}[t],o=n[t].length,i=n[r]?n[r].length:0;e._didRelatedGenesFirstPlot?o>0&&i>0?e.time.rg.totalLastPlotDiff=Ll(e.time.rg.timestampFirstPlot):o>0&&0===i?(e.time.rg.timestampFirstPlot=performance.now(),e.time.rg.totalFirstPlot=Ll(e.time.rg.t0),e._relatedGenesFirstPlotType=t,e.time.rg.totalLastPlotDiff=0):(0===o&&i>0||(e._relatedGenesFirstPlotType="searched"),e.time.rg.totalLastPlotDiff=0):(e._didRelatedGenesFirstPlot=!0,e.time.rg.totalFirstPlot=Ll(e.time.rg.t0),o>0&&(e.time.rg.timestampFirstPlot=performance.now(),e._relatedGenesFirstPlotType=t))}(t,e)}function Gl(t){var e=document.querySelector(t.config.container);e.style.visibility="",e.style.position="absolute",e.style.width="100%";var n=document.querySelector("#_ideogramInnerWrap");n.style.position="relative",n.style.marginLeft="auto",n.style.marginRight="auto",n.style.overflowY="hidden",document.querySelector("#_ideogramMiddleWrap").style.overflowY="hidden";const r=t.config.legendPad;if(void 0===t.didAdjustIdeogramLegend){var o=document.querySelector("#_ideogram");const e=160;n.style.maxWidth=parseInt(n.style.maxWidth)+e+r+"px",o.style.minWidth=parseInt(o.style.minWidth)+r+"px",o.style.maxWidth=parseInt(o.style.minWidth)+r+"px",o.style.position="relative",o.style.left=e+"px",t.didAdjustIdeogramLegend=!0}}async function $l(t=null){this.clearAnnotLabels();const e=document.querySelector("#_ideogramLegend");if(e&&e.remove(),!t)return Jl();this.config=Ul(this.config);const n=[`# Related genes for ${t} in ${this.getScientificName(this.config.taxid)}`,`# Generated by Ideogram.js version ${Ideogram.version}, https://github.com/eweitz/ideogram`,"# Generated at "+window.location.href].join("\n");delete this.annotDescriptions,this.annotDescriptions={headers:n,annots:{}},document.querySelectorAll(this.selector+" .annot").forEach(t=>t.remove()),this.startHideAnnotTooltipTimeout(),document.querySelectorAll(".chromosome").forEach(t=>{t.style.cursor=""}),Gl(this),this.relatedAnnots=[];const r=await async function(t,e){const n=performance.now(),r=`?q=symbol:${t}&species=${e.config.taxid}&fields=symbol,genomic_pos,name`,o=await Il(r);if(0===o.hits.length)return;const i=o.hits[0];e.annotDescriptions.annots[i.symbol]={description:"",ensemblId:i.genomic_pos.ensemblgene,name:i.name,type:"searched gene"};const a=Fl(i,e);return e.relatedAnnots.push(a),e.time.rg.searchedGene=Ll(n),a}(t,this);if(void 0===r)throw Error(`"${t}" is not a known gene in ${this.organismScientificName}`);this.config.legend=Yl,ba(this),jl(),await Promise.all([Bl(r,this),Dl(r,this)]),this.time.rg.total=Ll(this.time.rg.t0),function(t){const e=Nl(t),n=Object.assign({firstPlotType:t._relatedGenesFirstPlotType,timeTotal:t.time.rg.total,timeTotalFirstPlot:t.time.rg.totalFirstPlot,timeTotalLastPlotDiff:t.time.rg.totalLastPlotDiff,timeSearchedGene:t.time.rg.searchedGene,timeInteractingGenes:t.time.rg.interactions,timeParalogs:t.time.rg.paralogs},e);t.relatedGenesAnalytics=n}(this),this.onPlotRelatedGenesCallback&&this.onPlotRelatedGenesCallback()}function ql(t){const e=this.annotDescriptions.annots[t.name];return t.displayName=`<span id="ideo-related-gene" style="color: #0366d6; cursor: pointer;">${t.name}</span><br/>`+e.name+"<br/>"+(e.description.length>0?"<br/>"+e.description:"")+"<br/>",function(t){const e=document.querySelector("._ideogramTooltip");t.addedTooltipClickHandler||(e.addEventListener("click",()=>{const e=function(t,e){var n;return e.annots.forEach(e=>{e.annots.forEach(e=>{t===e.name&&(n=e)})}),n}(document.querySelector("#ideo-related-gene").textContent,t);t.onClickAnnot(e)}),t.addedTooltipClickHandler=!0)}(this),t}const Vl="font-size: 14px; font-weight: bold; font-color: #333;",Yl=[{name:`\n    <div style="position: relative; left: -15px;">\n      <div style="${Vl}">Related genes</div>\n      <i>Click gene to search</i>\n    </div>\n  `,nameHeight:50,rows:[{name:"Interacting gene",color:"purple",shape:"triangle"},{name:"Paralogous gene",color:"pink",shape:"triangle"},{name:"Searched gene",color:"red",shape:"triangle"}]}],Xl=[{name:`\n    <div style="position: relative; left: -15px;">\n      <div style="${Vl}">Highly cited genes</div>\n      <i>Click gene to search</i>\n    </div>\n  `,nameHeight:30,rows:[]}];function Ul(t){return t.legendPad=t.showAnnotLabels?70:30,t}function Jl(){const t=this;t&&!("annotDescriptions"in t)&&(t.annotDescriptions={annots:{}},t.flattenAnnots().map(e=>{let n=[];"significance"in e&&"n/a"!==e.significance&&n.push(e.significance),"citations"in e&&void 0!==e.citations&&n.push(e.citations),n=n.join("<br/><br/>"),t.annotDescriptions.annots[e.name]={description:n,name:e.fullName}}),Gl(t),jl(),t.fillAnnotLabels(),document.querySelector(t.config.container).style.visibility="")}class Ql{constructor(t){this.configure=si,this.initDrawChromosomes=ki,this.onLoad=Ei,this.handleRotateOnClick=Si,this.init=Oi,this.finishInit=hi,this.writeContainer=bi,this.onLoadAnnots=Zi,this.onDrawAnnots=ta,this.processAnnotData=Ra,this.restoreDefaultTracks=Pa,this.updateDisplayedTracks=Na,this.initAnnotSettings=Ha,this.fetchAnnots=qa,this.drawAnnots=wa,this.getHistogramBars=ma,this.drawHeatmaps=Ji,this.deserializeAnnotsForHeatmap=Ki,this.fillAnnots=Va,this.drawProcessedAnnots=xa,this.drawSynteny=Ma,this.startHideAnnotTooltipTimeout=ea,this.showAnnotTooltip=oa,this.onWillShowAnnotTooltip=na,this.onClickAnnot=ra,this.setOriginalTrackIndexes=Ia,this.afterRawAnnots=Ga,this.downloadAnnotations=Wa,this.addAnnotLabel=ua,this.removeAnnotLabel=fa,this.fillAnnotLabels=ha,this.clearAnnotLabels=da,this.flattenAnnots=$a,this.highlight=Ya,this.unhighlight=Xa,this.esearch="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?retmode=json&api_key=7e33ac6a08a6955ec3b83d214d22b21a2808",this.esummary="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?retmode=json&api_key=7e33ac6a08a6955ec3b83d214d22b21a2808",this.elink="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?retmode=json&api_key=7e33ac6a08a6955ec3b83d214d22b21a2808",this.getOrganismFromEutils=Ja,this.getTaxids=Za,this.getAssemblyAndChromosomesFromEutils=es,this.drawBandLabels=cs,this.getBandColorGradients=hs,this.processBandData=ps,this.setBandsToShow=as,this.hideUnshownBandLabels=ns,this.drawBandLabelText=ss,this.drawBandLabelStalk=ls,this.onBrushMove=gs,this.onBrushEnd=ys,this.createBrush=vs,this.createClickCursor=ws,this.onCursorMove=bs,this.drawSexChromosomes=xs,this.setSexChromosomes=_s,this.convertBpToPx=As,this.convertPxToBp=ks,this.unpackAnnots=al,this.packAnnots=sl,this.initCrossFilter=ll,this.filterAnnots=cl,this.assemblyIsAccession=$o,this.getDataDir=Yo,this.round=Xo,this.onDidRotate=Uo,this.getSvg=Jo,this.fetch=Qo,this.getTaxid=Ko,this.getCommonName=Zo,this.getScientificName=ti,this.getChromosomeModel=hl,this.getChromosomePixels=ul,this.drawChromosomeLabels=Sl,this.rotateChromosomeLabels=El,this.appendHomolog=_l,this.drawChromosome=Al,this.rotateAndToggleDisplay=Cl,this.setOverflowScroll=kl,this.plotRelatedGenes=$l,this.getRelatedGenesByType=Ml,this.configure(t)}static get version(){return"1.31.0"}static get d3(){return Go}static async fetchEnsembl(t,e=null,n="GET"){const r={method:n};if(null!==e&&(r.body=JSON.stringify(e)),"GET"===n){const e=t.includes("&")?"&":"?";t+=e+"content-type=application/json"}else r.headers={"Content-Type":"application/json"};const o=await fetch("https://rest.ensembl.org"+t,r);return await o.json()}static getChrSortNamesAndTypes(t,e){var n,r,o,i,a,s,l,c,u,h;return"string"==typeof t||"chr"in t&&"annots"in t?(a="MT"===(n="string"==typeof t?t:t.chr),s="MT"===(r="string"==typeof e?e:e.chr),l="AP"===n,c="AP"===r,u=!(o="CP"===n)&&!a&&!l,h=!(i="CP"===r)&&!s&&!c):(n=t.name,r=e.name,o="chloroplast"===t.type,i="chloroplast"===e.type,a="mitochondrion"===t.type,s="mitochondrion"===e.type,l="apicoplast"===t.type,c="apicoplast"===e.type,u="nuclear"===t.type,h="nuclear"===e.type),[n,r,{aIsNuclear:u,bIsNuclear:h,aIsCP:o,bIsCP:i,aIsMT:a,bIsMT:s,aIsAP:l,bIsAP:c}]}static sortChromosomes(t,e){let[n,r,o]=Ql.getChrSortNamesAndTypes(t,e);const{aIsNuclear:i,bIsNuclear:a,aIsCP:s,bIsCP:l,aIsMT:c,bIsMT:u,aIsAP:h,bIsAP:f}=o;return i&&a?(ni(n)&&ni(r)&&(n=ri(n).toString(),r=ri(r).toString()),n.localeCompare(r,"en",{numeric:!0})):!i&&a||c&&l?1:s&&u?-1:h||c||s||!(u||l||f)?void 0:-1}static initRelatedGenes(t,e="all"){return function(t,e){"all"!==e&&(e=e.map(t=>t.toLowerCase()));const n={showFullyBanded:!1,rotatable:!1,legend:Yl,chrBorderColor:"#333",chrLabelColor:"#333",onWillShowAnnotTooltip:ql,annotsInList:e,showTools:!0,showAnnotLabels:!0};if("onWillShowAnnotTooltip"in t){const e="onWillShowAnnotTooltip",r=t[e],o=n[e];n[e]=function(t){return t=o.bind(this)(t),r.bind(this)(t)},delete t[e]}let r=Object.assign(n,t);r=Ul(r);const o=new Ideogram(r);return t.onPlotRelatedGenes&&(o.onPlotRelatedGenesCallback=t.onPlotRelatedGenes),t.onFindRelatedGenes&&(o.onFindRelatedGenesCallback=t.onFindRelatedGenes),o.getTooltipAnalytics=Pl,o.annotSortFunction=Rl,Tl(o),async function(t,e,n=null){if(!function(t){const e=function(t){t=ei(t);for(const e in Ho){const n=Ho[e],r=ei(n.commonName),o=ei(n.scientificName);if(r===t||o===t)return e}return null}(t),n=Ho[e];return"hasGeneCache"in n&&!0===n.hasGeneCache}(t))return;const r=function(t,e,n){const r=ei(t);if(!e){const t=n.config.dataDir.split("/"),r=t.indexOf("data");e=t.slice(0,r).join("/")+"/data/annotations/gene-cache/"}return e+r+".tsv"}(t,n,e),o=await fetch(r),i=await o.text(),[a,s,l]=function(t){const e=[],n={},r=[];t.split(/\r\n|\n/).forEach(t=>{if("#"===t[0]||""===t)return;const[o,i,a]=t.split(/\t/),s=parseInt(i);r.push([o,s,a]),e.push(a),n[a]=[o,s]});const o=function(t){const e={};t.forEach(([t,n,r])=>{t in e?e[t].annots.push({name:r,start:n}):e[t]={chr:t,annots:[]}});const n={};return Object.entries(e).forEach(([t,e])=>{n[t]={chr:t,annots:e.annots.sort((t,e)=>t.start-e.start)}}),n}(r);return[e,n,o]}(i);e.geneCache={citedNames:a,lociByName:s,sortedAnnots:l}}(o.config.organism,o),o}(t,e)}static initGeneHints(t,e="all"){return function(t,e){delete t.onPlotRelatedGenes,"all"!==e&&(e=e.map(t=>t.toLowerCase()));const n=qo("annotations/gene-cache/homo-sapiens-top-genes.tsv"),r={showFullyBanded:!1,rotatable:!1,legend:Xl,chrMargin:-4,chrBorderColor:"#333",chrLabelColor:"#333",onWillShowAnnotTooltip:ql,annotsInList:e,showTools:!0,showAnnotLabels:!0,onDrawAnnots:Jl,annotationsPath:n};if("onWillShowAnnotTooltip"in t){const e="onWillShowAnnotTooltip",n=t[e],o=r[e];r[e]=function(t){return t=o.bind(this)(t),n.bind(this)(t)},delete t[e]}if("onDrawAnnots"in t){const e="onDrawAnnots",n=t[e],o=r[e];r[e]=function(){o.bind(this)(),n.bind(this)()},delete t[e]}const o=Object.assign(r,t);o.legendPad=o.showAnnotLabels?80:30;const i=new Ideogram(o);return t.onPlotRelatedGenes&&(i.onPlotRelatedGenesCallback=t.onPlotRelatedGenes),t.onFindRelatedGenes&&(i.onFindRelatedGenesCallback=t.onFindRelatedGenes),i.getTooltipAnalytics=Pl,i.annotSortFunction=Rl,Tl(i),i}(t,e)}}var Kl;window.Ideogram=Ql;var Zl=new Uint8Array(16);function tc(){if(!Kl&&!(Kl="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Kl(Zl)}var ec=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function nc(t){return"string"==typeof t&&ec.test(t)}for(var rc=[],oc=0;oc<256;++oc)rc.push((oc+256).toString(16).substr(1));function ic(t,e,n){var r=(t=t||{}).random||(t.rng||tc)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=r[o];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(rc[t[e+0]]+rc[t[e+1]]+rc[t[e+2]]+rc[t[e+3]]+"-"+rc[t[e+4]]+rc[t[e+5]]+"-"+rc[t[e+6]]+rc[t[e+7]]+"-"+rc[t[e+8]]+rc[t[e+9]]+"-"+rc[t[e+10]]+rc[t[e+11]]+rc[t[e+12]]+rc[t[e+13]]+rc[t[e+14]]+rc[t[e+15]]).toLowerCase();if(!nc(n))throw TypeError("Stringified UUID is invalid");return n}(r)}var ac,sc=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=j(y),r=(0,w.makeStyles)((function(){return{importFormEntry:{minWidth:180}}})),o=(0,v.observer)((function(t){var e=t.session,o=t.onChange,i=t.selected,a=r(),s=e.assemblyNames,l=e.assemblyManager,c=s.length?"":"No configured assemblies";return n.default.createElement(w.TextField,{select:!0,label:"Assembly",variant:"outlined",margin:"normal",helperText:c||"Select assembly to view",value:c?"":i,inputProps:{"data-testid":"assembly-selector"},onChange:function(t){return o(t.target.value)},error:!!c,disabled:!!c,className:a.importFormEntry},s.map((function(t){var e=l.get(t),r=e?(0,b.getConf)(e,"displayName"):"";return n.default.createElement(w.MenuItem,{key:t,value:t},r||t)})))}));e.default=o})));function lc(t,e){return cc.apply(this,arguments)}function cc(){return(cc=C(W.mark((function t(e,n){var r,o,i,a,s,l,c,u,h;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=[],i=[],a=void 0,ac={success:!0,occurances:[],type:0,message:""},t.prev=4,t.next=7,bc(e);case 7:if(s=xc(t.sent),l=s.lines,u=void 0,(c=s.columns).includes("genomeLocation")){t.next=16;break}return t.t0=JSON,t.next=14,bc({uri:"https://jbrowse.org/genomes/GRCh38/reactome_xref_symbols_grch38.json",locationType:"UriLocation"});case 14:t.t1=t.sent,u=t.t0.parse.call(t.t0,t.t1);case 16:if(h=void 0,!n){t.next=22;break}return t.next=20,fc(uc(l,c));case 20:h=hc(a=t.sent);case 22:c.includes("name")?l.forEach(function(){var t=C(W.mark((function t(e){return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o.push(Ac(e,c,u,h)),t.t0=i,t.next=4,yc(Ac(e,c,u,h));case 4:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):gc(2),t.next=28;break;case 25:t.prev=25,t.t2=t.catch(4),gc(2);case 28:return t.abrupt("return",{widget:i,ideo:o,pathways:null===(r=a)||void 0===r?void 0:r.pathways,res:ac});case 29:case"end":return t.stop()}}),t,null,[[4,25]])})))).apply(this,arguments)}function uc(t,e){var n;n=e.length>1?e.includes("geneSymbol")?e.indexOf("geneSymbol"):e.includes("genes")?e.indexOf("genes"):e.includes("name")?e.indexOf("name"):-1:0;var r="";return n>=0&&t.forEach((function(t){r=r.concat("\n",t.split("\t")[n])})),r}function hc(t){var e={};return t.pathways.forEach((function(t){e[t.stId]=_({},t)})),e}function fc(t){return dc.apply(this,arguments)}function dc(){return(dc=C(W.mark((function t(e){var n;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://reactome.org/AnalysisService/identifiers/projection?includeDisease=true&interactors=false&order=ASC&pValue=1&resource=TOTAL&sortBy=ENTITIES_PVALUE",{method:"POST",body:e});case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch ".concat(n.status," ").concat(n.statusText));case 5:return t.abrupt("return",n.json());case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mc(t){return pc.apply(this,arguments)}function pc(){return(pc=C(W.mark((function t(e){var n;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://idg.reactome.org/idgpairwise/relationships/hierarchyForTerm/".concat(e),{method:"GET"});case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch ".concat(n.status," ").concat(n.statusText));case 5:return t.abrupt("return",n.json());case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gc(t){ac.success=!1,1===t&&(ac.message="There are datapoints missing location data and they will be omitted from the annotations.",ac.type=1),2===t&&(ac.message='The annotations file is missing a required header: "name".',ac.type=2),3===t&&(ac.message="Some provided gene ids could not be coordinated with a location and they will be omitted from the annotations.",ac.type=3)}function yc(t){return vc.apply(this,arguments)}function vc(){return(vc=C(W.mark((function t(e){var n,r;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e).end=n.stop,delete n.stop,delete n.color,delete n.chr,!e.details.reactomeIds){t.next=10;break}return t.next=8,mc(e.name);case 8:(r=t.sent).hierarchy&&(n.details.hierarchy=r.hierarchy);case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function bc(t){return wc.apply(this,arguments)}function wc(){return(wc=C(W.mark((function t(e){return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.openLocation(e).readFile("utf8");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xc(t){var e=t.split("\n"),n=[],r=[];return e.forEach((function(t){t&&(0===r.length?(r=t.split("\t")).forEach((function(t,e){r[e]=_c(t)})):n.push(t))})),{lines:n,columns:r}}function _c(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(t,e){return 0===e?t.toLowerCase():t.toUpperCase()})).replace(/\s+/g,"")}function Ac(t,e,n,r){var o={details:{}},i=!1,a=!1,s=!1;return t.split("\t").forEach((function(t,n){if(t){var r=_c(e[n]);if("name"!==r||i||(o.name=t),"geneSymbol"===r&&(i=!0,o.name=t),"genomeLocation"===r){var l=function(t){var e=t.split(":");return{chr:e[0],start:+e[1].split("-")[0],stop:+e[1].split("-")[1]}}(t);l.start>0&&l.stop>0?o=_(_({},o),l):gc(1),a=!0}if("externalLinks"===r&&(t=JSON.parse(t)),"tier"===r){var c="#0000FF",u="#FF0000";"1"===t?(o.color=c,o.prevColor=c):(o.color=u,o.prevColor=u),s=!0}o.details[r]=t}})),!1===s&&(o.color="#FF0000",o.prevColor="#FF0000"),!1===a?n[o.name]?(o.chr=n[o.name].chr,o.start=n[o.name].start,o.stop=n[o.name].stop,o.details.reactomeIds=n[o.name].reactomeIds,o.details.genomeLocation="".concat(o.chr,":").concat(o.start,"-").concat(o.stop)):gc(3):r&&n&&n[o.name]&&(o.details.reactomeIds=n[o.name].reactomeIds),o.details.reactomeIds&&r&&(o.details.pathways=[],o.details.reactomeIds.forEach((function(t){r[t]&&o.details.pathways.push(r[t])}))),o}var Cc=["chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY"],kc=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","X","Y"],Sc=[{name:"Tier 1",rows:[{name:"",color:"#0000FF",shape:"triangle"},{name:"Tier 2",color:"#FF0000",shape:"triangle"}]}];function Ec(){return(Ec=C(W.mark((function t(e,n,r,i,a){var s,l,c;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=o.getSession(a),!(l=s.views.find((function(t){return"ReactomeView"===t.type})))){t.next=9;break}l.setPathways(n),l.setSelectedPathway(e),l.setGene(i),l.setMessage("Pathways relating to ".concat(i,' are being displayed. "').concat(r,'" has been selected.')),t.next=16;break;case 9:return(c=s.addView("ReactomeView",{displayName:"Reactome View"})).setPathways(n),c.setSelectedPathway(e),c.setGene(i),c.setMessage("Pathways relating to ".concat(i,' are being displayed. "').concat(r,'" has been selected.')),t.next=16,o.when((function(){return c.initialized}));case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lc(){return(Lc=C(W.mark((function t(e,n){var r,i,a,s,l,c,u,h,f,d,m;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.view.assembly,i=o.getSession(n),!(a=i.views.find((function(t){return"LinearGenomeView"===t.type&&t.assemblyNames[0]===r})))){t.next=7;break}a.navToLocString(e),t.next=29;break;case 7:return s=o.getSession(n),l=s.assemblyManager,t.next=11,l.waitForAssembly(r);case 11:if(!(c=t.sent)){t.next=29;break}return t.prev=13,u=o.parseLocString(e,(function(t){return s.assemblyManager.isValidRefName(t,r)})),h=c.regions,f=c.getCanonicalRefName(u.refName),h&&(d=h.find((function(t){return t.refName===f}))),m=s.addView("LinearGenomeView",{displayName:r}),t.next=22,o.when((function(){return m.initialized}));case 22:m.setDisplayedRegions([JSON.parse(JSON.stringify(d))]),m.navToLocString(e),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(13),s.notify("".concat(t.t0),"error");case 29:case"end":return t.stop()}}),t,null,[[13,26]])})))).apply(this,arguments)}function Tc(t){return Mc.apply(this,arguments)}function Mc(){return(Mc=C(W.mark((function t(e){var n,r,i,a,s,l,c,u;return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.getSession(e),!e.annotationsLocation){t.next=13;break}return e.setShowLoading(!0),t.next=5,lc(e.annotationsLocation,e.withReactome);case 5:i=(r=t.sent).widget,a=r.ideo,s=r.pathways,2!==(l=r.res).type&&(e.setWidgetAnnotations(i),e.setIdeoAnnotations(a)),e.withReactome&&(n.views.forEach((function(t){})),(c=n.views.find((function(t){return(null==t?void 0:t.isAnalysisResults)&&t.ideogramId===e.ideogramId})))&&n.removeView(c),n.addView("IdeogramView",{}),n.views[u=n.views.length-1].setDisplayName("Reactome Analysis Results"),n.views[u].setPathways(s),e.setPathways(s),n.views[u].setIsAnalysisResults(!0),n.views[u].setIdeogramId(e.ideogramId)),l.success||n.notify(l.message,"warning");case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Pc=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"}),"Help");e.default=r}))),Nc=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");e.default=r}))),Ic=c.makeStyles((function(t){return{closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]}}}));function Oc(t){var e=t.handleClose,n=Ic();return y.createElement(c.Dialog,{open:!0,maxWidth:"xl",onClose:e},y.createElement(c.DialogTitle,null,"How to use annotations files",e?y.createElement(c.IconButton,{"data-testid":"close-resultsDialog",className:n.closeButton,onClick:function(){e()}},y.createElement(Nc,null)):null),y.createElement(c.Divider,null),y.createElement(c.DialogContent,null,y.createElement("h3",null,"General"),y.createElement("ul",null,y.createElement("li",null,"annotations must be uploaded as a TSV with column headers"),y.createElement("li",null,"enforced location data must be under a heading called"," ",y.createElement("code",null,"genomeLocation")," and be in the format of 'chromosomeNumber:start-end', e.g. '1:39895426-39902013'"),y.createElement("li",null,"alternatively, annotation files provided without genome location data will attempt to be cross referenced with a remote file of gene locations"),y.createElement("li",null,"each row of data must include ",y.createElement("code",null,"name"))),y.createElement("h3",null,"External Links"),"Any external links that wish to be formatted on the widget properly must be in the following format:",y.createElement("ul",null,y.createElement("li",null,"under a header ",y.createElement("code",null,"externalLinks")),y.createElement("li",null,"a JSON string appearing as follows:"," ",y.createElement("code",null,'"[{"name": "MYLINK", "link": "https://my-link.com/"}]"')),y.createElement("li",null,"each annotation that you wish to have external links to must have this json string"),y.createElement("li",null,"multiple external links are permitted")),y.createElement("h3",null,"Colours and Categorization"),"Annotations can be categorized into two categories if the 'tier' header is within the TSV.",y.createElement("ul",null,y.createElement("li",null,"tier 1 is annotated in blue"),y.createElement("li",null,"tier 2 is annotated in red"),y.createElement("li",null,"this field is to be provided as a 1 or a 2")),y.createElement("h3",null,"Examples"),y.createElement("ul",null,y.createElement("li",null,"TSV with only required headers",y.createElement("br",null),y.createElement("code",null,"name",y.createElement("br",null),"note1",y.createElement("br",null),"note2")),y.createElement("br",null),y.createElement("li",null,"TSV with optional headers",y.createElement("br",null),y.createElement("code",null,"name\tgenomeLocation\ttier\texternalLinks",y.createElement("br",null),"note1\t1:39895426-39902013\t1\t",'[{"name":"MYLINK","link":"https://my-link.com/note1"}]',y.createElement("br",null),"note2\t1:157573749-157598080\t2\t",'[{"name":"MYLINK","link":"https://my-link.com/note2"}]')))),y.createElement(c.Divider,null),y.createElement(c.DialogActions,null,y.createElement(c.Button,{onClick:function(){return e()},color:"primary"},"Close")))}var Fc=c.makeStyles((function(t){return{importFormContainer:{padding:t.spacing(2)},button:{margin:t.spacing(2)},importFormEntry:{minWidth:180},closeButton:{position:"absolute",right:"4px",top:"4px"}}})),jc=s.observer((function(t){var e=t.onChange,n=t.selected,r=Fc(),o=Cc.length?"":"No configured regions";return y.createElement(c.TextField,{select:!0,label:"Region",variant:"outlined",margin:"normal",helperText:o||"Select a region to view",value:o?"":n,inputProps:{"data-testid":"region-selector"},onChange:function(t){return e(t.target.value)},error:!!o,disabled:!!o,className:r.importFormEntry},Cc.map((function(t){return y.createElement(c.MenuItem,{key:t,value:t},t)})))})),Bc=s.observer((function(t){var n=t.model,r=Fc(),i=o.getSession(n),a=P(e.useState(i.assemblyNames[0]),2),s=a[0],l=a[1],h=P(e.useState(Cc[0]),2),f=h[0],d=h[1],m=P(e.useState(n.withReactome),2),p=m[0],g=m[1],v=P(e.useState(!1),2),b=v[0],w=v[1];function x(){return(x=C(W.mark((function t(e,r){return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.setAssembly(e),n.setRegion(r),n.setOrientation("horizontal"),n.setAllRegions(!1),n.setShowImportForm(!1),n.setIdeogramId(ic()),t.next=8,Tc(n);case 8:n.setShowLoading(!1);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(){return(_=C(W.mark((function t(e){return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.setAllRegions(!0),n.setAssembly(e),n.setIdeogramId(ic()),t.next=5,Tc(n);case 5:n.setShowImportForm(!1),n.setShowLoading(!1);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return y.createElement("div",null,y.createElement(c.Container,{className:r.importFormContainer},y.createElement(c.Grid,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},y.createElement(c.Grid,{item:!0},y.createElement(sc,{onChange:function(t){l(t)},session:i,selected:s})),y.createElement(c.Grid,{item:!0},y.createElement(jc,{onChange:function(t){d(t)},selected:f})),y.createElement(c.Grid,{item:!0},y.createElement(c.Button,{type:"submit",disabled:!f,className:r.button,onClick:function(){f&&function(t,e){x.apply(this,arguments)}(s,f)},variant:"contained",color:"primary"},"Open"),y.createElement(c.Button,{disabled:!f,className:r.button,onClick:function(){!function(t){_.apply(this,arguments)}(s)},variant:"contained",color:"secondary"},"Show all regions in assembly")))),y.createElement(c.Divider,null),y.createElement(c.Container,{className:r.importFormContainer},y.createElement(c.Grid,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",direction:"column"},y.createElement(c.Typography,{variant:"body2"},y.createElement("b",null,"Optional:")," provide a .tsv file of gene annotations for the ideogram.",y.createElement(c.IconButton,{onClick:function(){return w(!0)}},y.createElement(Pc,null))),y.createElement(c.Grid,{item:!0},y.createElement(u.FileSelector,{name:"Annotations file",location:n.annotationsLocation,setLocation:function(t){return n.setAnnotationsLocation(t)}})),y.createElement(c.Grid,{item:!0},y.createElement(c.FormControlLabel,{label:"Analyze annotations with Reactome",control:y.createElement(c.Checkbox,{checked:p,color:"primary",onChange:function(t){g(null==t?void 0:t.target.checked),n.setWithReactome(null==t?void 0:t.target.checked)}})})))),b?y.createElement(e.Suspense,{fallback:y.createElement("div",null)},y.createElement(Oc,{handleClose:function(){return w(!1)}})):null)})),Dc=function(){function t(t){var e=this;this._insertTag=function(t){e.container.insertBefore(t,0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{n.insertRule(t,n.cssRules.length)}catch(t){}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),this.tags=[],this.ctr=0},t}(),Rc="-ms-",zc="-moz-",Wc="-webkit-",Hc="comm",Gc="rule",$c="decl",qc="@keyframes",Vc=Math.abs,Yc=String.fromCharCode,Xc=Object.assign;function Uc(t){return t.trim()}function Jc(t,e,n){return t.replace(e,n)}function Qc(t,e){return t.indexOf(e)}function Kc(t,e){return 0|t.charCodeAt(e)}function Zc(t,e,n){return t.slice(e,n)}function tu(t){return t.length}function eu(t){return t.length}function nu(t,e){return e.push(t),t}var ru=1,ou=1,iu=0,au=0,su=0,lu="";function cu(t,e,n,r,o,i,a){return{value:t,root:e,parent:n,type:r,props:o,children:i,line:ru,column:ou,length:a,return:""}}function uu(t,e){return Xc(cu("",null,null,"",null,null,0),t,{length:-t.length},e)}function hu(){return su=au>0?Kc(lu,--au):0,ou--,10===su&&(ou=1,ru--),su}function fu(){return su=au<iu?Kc(lu,au++):0,ou++,10===su&&(ou=1,ru++),su}function du(){return Kc(lu,au)}function mu(){return au}function pu(t,e){return Zc(lu,t,e)}function gu(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function yu(t){return ru=ou=1,iu=tu(lu=t),au=0,[]}function vu(t){return lu="",t}function bu(t){return Uc(pu(au-1,function t(e){for(;fu();)switch(su){case e:return au;case 34:case 39:34!==e&&39!==e&&t(su);break;case 40:41===e&&t(e);break;case 92:fu()}return au}(91===t?t+2:40===t?t+1:t)))}function wu(t){for(;(su=du())&&su<33;)fu();return gu(t)>2||gu(su)>3?"":" "}function xu(t,e){for(;--e&&fu()&&!(su<48||su>102||su>57&&su<65||su>70&&su<97););return pu(t,mu()+(e<6&&32==du()&&32==fu()))}function _u(t,e){for(;fu()&&t+su!==57&&(t+su!==84||47!==du()););return"/*"+pu(e,au-1)+"*"+Yc(47===t?t:fu())}function Au(t){for(;!gu(du());)fu();return pu(t,au)}function Cu(t,e,n,r,o,i,a,s,l,c,u){for(var h=o-1,f=0===o?i:[""],d=eu(f),m=0,p=0,g=0;m<r;++m)for(var y=0,v=Zc(t,h+1,h=Vc(p=a[m])),b=t;y<d;++y)(b=Uc(p>0?f[y]+" "+v:Jc(v,/&\f/g,f[y])))&&(l[g++]=b);return cu(t,e,n,0===o?Gc:s,l,c,u)}function ku(t,e,n){return cu(t,e,n,Hc,Yc(su),Zc(t,2,-2),0)}function Su(t,e,n,r){return cu(t,e,n,$c,Zc(t,0,r),Zc(t,r+1,-1),r)}function Eu(t,e){for(var n="",r=eu(t),o=0;o<r;o++)n+=e(t[o],o,t,e)||"";return n}function Lu(t,e,n,r){switch(t.type){case"@import":case $c:return t.return=t.return||t.value;case Hc:return"";case qc:return t.return=t.value+"{"+Eu(t.children,r)+"}";case Gc:t.value=t.props.join(",")}return tu(n=Eu(t.children,r))?t.return=t.value+"{"+n+"}":""}function Tu(t){return function(e){e.root||(e=e.return)&&t(e)}}var Mu=function(t){var e=new WeakMap;return function(n){if(e.has(n))return e.get(n);var r=t(n);return e.set(n,r),r}};function Pu(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}var Nu=function(t,e,n){for(var r=0,o=0;r=o,o=du(),38===r&&12===o&&(e[n]=1),!gu(o);)fu();return pu(t,au)},Iu=new WeakMap,Ou=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,n=t.parent,r=t.column===n.column&&t.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||Iu.get(n))&&!r){Iu.set(t,!0);for(var o=[],i=function(t,e){return vu(function(t,e){var n=-1,r=44;do{switch(gu(r)){case 0:38===r&&12===du()&&(e[n]=1),t[n]+=Nu(au-1,e,n);break;case 2:t[n]+=bu(r);break;case 4:if(44===r){t[++n]=58===du()?"&\f":"",e[n]=t[n].length;break}default:t[n]+=Yc(r)}}while(r=fu());return t}(yu(t),e))}(e,o),a=n.props,s=0,l=0;s<i.length;s++)for(var c=0;c<a.length;c++,l++)t.props[l]=o[s]?i[s].replace(/&\f/g,a[c]):a[c]+" "+i[s]}}},Fu=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}},ju=[function(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case $c:t.return=function t(e,n){switch(function(t,e){return(((e<<2^Kc(t,0))<<2^Kc(t,1))<<2^Kc(t,2))<<2^Kc(t,3)}(e,n)){case 5103:return Wc+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Wc+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Wc+e+zc+e+Rc+e+e;case 6828:case 4268:return Wc+e+Rc+e+e;case 6165:return Wc+e+Rc+"flex-"+e+e;case 5187:return Wc+e+Jc(e,/(\w+).+(:[^]+)/,Wc+"box-$1$2"+Rc+"flex-$1$2")+e;case 5443:return Wc+e+Rc+"flex-item-"+Jc(e,/flex-|-self/,"")+e;case 4675:return Wc+e+Rc+"flex-line-pack"+Jc(e,/align-content|flex-|-self/,"")+e;case 5548:return Wc+e+Rc+Jc(e,"shrink","negative")+e;case 5292:return Wc+e+Rc+Jc(e,"basis","preferred-size")+e;case 6060:return Wc+"box-"+Jc(e,"-grow","")+Wc+e+Rc+Jc(e,"grow","positive")+e;case 4554:return Wc+Jc(e,/([^-])(transform)/g,"$1"+Wc+"$2")+e;case 6187:return Jc(Jc(Jc(e,/(zoom-|grab)/,Wc+"$1"),/(image-set)/,Wc+"$1"),e,"")+e;case 5495:case 3959:return Jc(e,/(image-set\([^]*)/,Wc+"$1$`$1");case 4968:return Jc(Jc(e,/(.+:)(flex-)?(.*)/,Wc+"box-pack:$3"+Rc+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Wc+e+e;case 4095:case 3583:case 4068:case 2532:return Jc(e,/(.+)-inline(.+)/,Wc+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(tu(e)-1-n>6)switch(Kc(e,n+1)){case 109:if(45!==Kc(e,n+4))break;case 102:return Jc(e,/(.+:)(.+)-([^]+)/,"$1"+Wc+"$2-$3$1"+zc+(108==Kc(e,n+3)?"$3":"$2-$3"))+e;case 115:return~Qc(e,"stretch")?t(Jc(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(115!==Kc(e,n+1))break;case 6444:switch(Kc(e,tu(e)-3-(~Qc(e,"!important")&&10))){case 107:return Jc(e,":",":"+Wc)+e;case 101:return Jc(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Wc+(45===Kc(e,14)?"inline-":"")+"box$3$1"+Wc+"$2$3$1"+Rc+"$2box$3")+e}break;case 5936:switch(Kc(e,n+11)){case 114:return Wc+e+Rc+Jc(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Wc+e+Rc+Jc(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Wc+e+Rc+Jc(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Wc+e+Rc+e+e}return e}(t.value,t.length);break;case qc:return Eu([uu(t,{value:Jc(t.value,"@","@"+Wc)})],r);case Gc:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t,e){return(t=/(::plac\w+|:read-\w+)/.exec(t))?t[0]:t}(e)){case":read-only":case":read-write":return Eu([uu(t,{props:[Jc(e,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return Eu([uu(t,{props:[Jc(e,/:(plac\w+)/,":"+Wc+"input-$1")]}),uu(t,{props:[Jc(e,/:(plac\w+)/,":-moz-$1")]}),uu(t,{props:[Jc(e,/:(plac\w+)/,Rc+"input-$1")]})],r)}return""}))}}],Bu=function(t){var e=t.key;if("css"===e){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var r,o,i=t.stylisPlugins||ju,a={},s=[];r=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),n=1;n<e.length;n++)a[e[n]]=!0;s.push(t)}));var l,c=[Ou,Fu],u=[Lu,Tu((function(t){l.insert(t)}))],h=function(t){var e=eu(t);return function(n,r,o,i){for(var a="",s=0;s<e;s++)a+=t[s](n,r,o,i)||"";return a}}(c.concat(i,u));o=function(t,e,n,r){l=n,Eu(function(t){return vu(function t(e,n,r,o,i,a,s,l,c){for(var u=0,h=0,f=s,d=0,m=0,p=0,g=1,y=1,v=1,b=0,w="",x=i,_=a,A=o,C=w;y;)switch(p=b,b=fu()){case 40:if(108!=p&&58==C.charCodeAt(f-1)){-1!=Qc(C+=Jc(bu(b),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:C+=bu(b);break;case 9:case 10:case 13:case 32:C+=wu(p);break;case 92:C+=xu(mu()-1,7);continue;case 47:switch(du()){case 42:case 47:nu(ku(_u(fu(),mu()),n,r),c);break;default:C+="/"}break;case 123*g:l[u++]=tu(C)*v;case 125*g:case 59:case 0:switch(b){case 0:case 125:y=0;case 59+h:m>0&&tu(C)-f&&nu(m>32?Su(C+";",o,r,f-1):Su(Jc(C," ","")+";",o,r,f-2),c);break;case 59:C+=";";default:if(nu(A=Cu(C,n,r,u,h,i,l,w,x=[],_=[],f),a),123===b)if(0===h)t(C,n,A,A,x,a,f,l,_);else switch(d){case 100:case 109:case 115:t(e,A,A,o&&nu(Cu(e,A,A,0,0,i,l,w,i,x=[],f),_),i,_,f,l,o?x:_);break;default:t(C,A,A,A,[""],_,0,l,_)}}u=h=m=0,g=v=1,w=C="",f=s;break;case 58:f=1+tu(C),m=p;default:if(g<1)if(123==b)--g;else if(125==b&&0==g++&&125==hu())continue;switch(C+=Yc(b),b*g){case 38:v=h>0?1:(C+="\f",-1);break;case 44:l[u++]=(tu(C)-1)*v,v=1;break;case 64:45===du()&&(C+=bu(fu())),d=du(),h=f=tu(w=C+=Au(mu())),b++;break;case 45:45===p&&2==tu(C)&&(g=0)}}return a}("",null,null,null,[""],t=yu(t),0,[0],t))}(t?t+"{"+e.styles+"}":e.styles),h),r&&(f.inserted[e.name]=!0)};var f={key:e,sheet:new Dc({key:e,container:r,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:o};return f.sheet.hydrate(s),f};function Du(){return(Du=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var Ru="function"==typeof Symbol&&Symbol.for,zu=Ru?Symbol.for("react.element"):60103,Wu=Ru?Symbol.for("react.portal"):60106,Hu=Ru?Symbol.for("react.fragment"):60107,Gu=Ru?Symbol.for("react.strict_mode"):60108,$u=Ru?Symbol.for("react.profiler"):60114,qu=Ru?Symbol.for("react.provider"):60109,Vu=Ru?Symbol.for("react.context"):60110,Yu=Ru?Symbol.for("react.async_mode"):60111,Xu=Ru?Symbol.for("react.concurrent_mode"):60111,Uu=Ru?Symbol.for("react.forward_ref"):60112,Ju=Ru?Symbol.for("react.suspense"):60113,Qu=Ru?Symbol.for("react.suspense_list"):60120,Ku=Ru?Symbol.for("react.memo"):60115,Zu=Ru?Symbol.for("react.lazy"):60116,th=Ru?Symbol.for("react.block"):60121,eh=Ru?Symbol.for("react.fundamental"):60117,nh=Ru?Symbol.for("react.responder"):60118,rh=Ru?Symbol.for("react.scope"):60119;function oh(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case zu:switch(t=t.type){case Yu:case Xu:case Hu:case $u:case Gu:case Ju:return t;default:switch(t=t&&t.$$typeof){case Vu:case Uu:case Zu:case Ku:case qu:return t;default:return e}}case Wu:return e}}}function ih(t){return oh(t)===Xu}var ah={AsyncMode:Yu,ConcurrentMode:Xu,ContextConsumer:Vu,ContextProvider:qu,Element:zu,ForwardRef:Uu,Fragment:Hu,Lazy:Zu,Memo:Ku,Portal:Wu,Profiler:$u,StrictMode:Gu,Suspense:Ju,isAsyncMode:function(t){return ih(t)||oh(t)===Yu},isConcurrentMode:ih,isContextConsumer:function(t){return oh(t)===Vu},isContextProvider:function(t){return oh(t)===qu},isElement:function(t){return"object"==typeof t&&null!==t&&t.$$typeof===zu},isForwardRef:function(t){return oh(t)===Uu},isFragment:function(t){return oh(t)===Hu},isLazy:function(t){return oh(t)===Zu},isMemo:function(t){return oh(t)===Ku},isPortal:function(t){return oh(t)===Wu},isProfiler:function(t){return oh(t)===$u},isStrictMode:function(t){return oh(t)===Gu},isSuspense:function(t){return oh(t)===Ju},isValidElementType:function(t){return"string"==typeof t||"function"==typeof t||t===Hu||t===Xu||t===$u||t===Gu||t===Ju||t===Qu||"object"==typeof t&&null!==t&&(t.$$typeof===Zu||t.$$typeof===Ku||t.$$typeof===qu||t.$$typeof===Vu||t.$$typeof===Uu||t.$$typeof===eh||t.$$typeof===nh||t.$$typeof===rh||t.$$typeof===th)},typeOf:oh},sh=(F((function(t,e){})),F((function(t){t.exports=ah}))),lh={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},ch={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},uh={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},hh={};function fh(t){return sh.isMemo(t)?uh:hh[t.$$typeof]||lh}hh[sh.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},hh[sh.Memo]=uh;var dh=Object.defineProperty,mh=Object.getOwnPropertyNames,ph=Object.getOwnPropertySymbols,gh=Object.getOwnPropertyDescriptor,yh=Object.getPrototypeOf,vh=Object.prototype;function bh(t,e,n){var r="";return n.split(" ").forEach((function(n){void 0!==t[n]?e.push(t[n]+";"):r+=n+" "})),r}var wh=function(t,e,n){var r=t.key+"-"+e.name;if(!1===n&&void 0===t.registered[r]&&(t.registered[r]=e.styles),void 0===t.inserted[e.name]){var o=e;do{t.insert(e===o?"."+r:"",o,t.sheet,!0),o=o.next}while(void 0!==o)}},xh={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},_h=/[A-Z]|^ms/g,Ah=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Ch=function(t){return 45===t.charCodeAt(1)},kh=function(t){return null!=t&&"boolean"!=typeof t},Sh=Pu((function(t){return Ch(t)?t:t.replace(_h,"-$&").toLowerCase()})),Eh=function(t,e){switch(t){case"animation":case"animationName":if("string"==typeof e)return e.replace(Ah,(function(t,e,n){return Th={name:e,styles:n,next:Th},e}))}return 1===xh[t]||Ch(t)||"number"!=typeof e||0===e?e:e+"px"};function Lh(t,e,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Th={name:n.name,styles:n.styles,next:Th},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Th={name:r.name,styles:r.styles,next:Th},r=r.next;return n.styles+";"}return function(t,e,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=Lh(t,e,n[o])+";";else for(var i in n){var a=n[i];if("object"!=typeof a)null!=e&&void 0!==e[a]?r+=i+"{"+e[a]+"}":kh(a)&&(r+=Sh(i)+":"+Eh(i,a)+";");else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=e&&void 0!==e[a[0]]){var s=Lh(t,e,a);switch(i){case"animation":case"animationName":r+=Sh(i)+":"+s+";";break;default:r+=i+"{"+s+"}"}}else for(var l=0;l<a.length;l++)kh(a[l])&&(r+=Sh(i)+":"+Eh(i,a[l])+";")}return r}(t,e,n);case"function":if(void 0!==t){var o=Th,i=n(t);return Th=o,Lh(t,e,i)}}if(null==e)return n;var a=e[n];return void 0!==a?a:n}var Th,Mh=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Ph=function(t,e,n){if(1===t.length&&"object"==typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var r=!0,o="";Th=void 0;var i=t[0];null==i||void 0===i.raw?(r=!1,o+=Lh(n,e,i)):o+=i[0];for(var a=1;a<t.length;a++)o+=Lh(n,e,t[a]),r&&(o+=i[a]);Mh.lastIndex=0;for(var s,l="";null!==(s=Mh.exec(o));)l+="-"+s[1];return{name:function(t){for(var e,n=0,r=0,o=t.length;o>=4;++r,o-=4)e=1540483477*(65535&(e=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+l,styles:o,next:Th}},Nh={}.hasOwnProperty,Ih=e.createContext("undefined"!=typeof HTMLElement?Bu({key:"css"}):null),Oh=Ih.Provider,Fh=function(t){return e.forwardRef((function(n,r){var o=e.useContext(Ih);return t(n,o,r)}))},jh=e.createContext({}),Bh=Mu((function(t){return Mu((function(e){return function(t,e){return"function"==typeof e?e(t):Du({},t,e)}(t,e)}))})),Dh="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Rh=function(t,e){var n={};for(var r in e)Nh.call(e,r)&&(n[r]=e[r]);return n[Dh]=t,n},zh=function(){return null},Wh=Fh((function(t,n,r){var o=t.css;"string"==typeof o&&void 0!==n.registered[o]&&(o=n.registered[o]);var i=t[Dh],a=[o],s="";"string"==typeof t.className?s=bh(n.registered,a,t.className):null!=t.className&&(s=t.className+" ");var l=Ph(a,void 0,e.useContext(jh));wh(n,l,"string"==typeof i),s+=n.key+"-"+l.name;var c={};for(var u in t)Nh.call(t,u)&&"css"!==u&&u!==Dh&&(c[u]=t[u]);c.ref=r,c.className=s;var h=e.createElement(i,c);return e.createElement(e.Fragment,null,e.createElement(zh,null),h)}));O(F((function(t){function e(){return t.exports=e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(this,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})));var Hh=function(t,n){var r=arguments;if(null==n||!Nh.call(n,"css"))return e.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=Wh,i[1]=Rh(t,n);for(var a=2;a<o;a++)i[a]=r[a];return e.createElement.apply(null,i)},Gh=Fh((function(t,n){var r=Ph([t.styles],void 0,e.useContext(jh)),o=e.useRef();return e.useLayoutEffect((function(){var t=n.key+"-global",e=new Dc({key:t,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),i=!1,a=document.querySelector('style[data-emotion="'+t+" "+r.name+'"]');return n.sheet.tags.length&&(e.before=n.sheet.tags[0]),null!==a&&(i=!0,a.setAttribute("data-emotion",t),e.hydrate([a])),o.current=[e,i],function(){e.flush()}}),[n]),e.useLayoutEffect((function(){var t=o.current,e=t[0];t[1]?t[1]=!1:(void 0!==r.next&&wh(n,r.next,!0),e.tags.length&&(e.before=e.tags[e.tags.length-1].nextElementSibling,e.flush()),n.insert("",r,e,!1))}),[n,r.name]),null}));function $h(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ph(e)}var qh=function t(e){for(var n=e.length,r=0,o="";r<n;r++){var i=e[r];if(null!=i){var a=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))a=t(i);else for(var s in a="",i)i[s]&&s&&(a&&(a+=" "),a+=s);break;default:a=i}a&&(o&&(o+=" "),o+=a)}}return o};function Vh(t,e,n){var r=[],o=bh(t,r,n);return r.length<2?n:o+e(r)}var Yh=function(){return null},Xh={__proto__:null,ClassNames:Fh((function(t,n){var r=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=Ph(e,n.registered);return wh(n,o,!1),n.key+"-"+o.name},o={css:r,cx:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return Vh(n.registered,r,qh(e))},theme:e.useContext(jh)},i=t.children(o);return e.createElement(e.Fragment,null,e.createElement(Yh,null),i)})),Global:Gh,createElement:Hh,css:$h,jsx:Hh,keyframes:function(){var t=$h.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},CacheProvider:Oh,ThemeContext:jh,ThemeProvider:function(t){var n=e.useContext(jh);return t.theme!==n&&(n=Bh(n)(t.theme)),e.createElement(jh.Provider,{value:n},t.children)},__unsafe_useEmotionCache:function(){return e.useContext(Ih)},useTheme:function(){return e.useContext(jh)},withEmotionCache:Fh,withTheme:function(t){var n=t.displayName||t.name||"Component",r=function(n,r){var o=e.useContext(jh);return e.createElement(t,Du({theme:o,ref:r},n))},o=e.forwardRef(r);return o.displayName="WithTheme("+n+")",function t(e,n,r){if("string"!=typeof n){if(vh){var o=yh(n);o&&o!==vh&&t(e,o,r)}var i=mh(n);ph&&(i=i.concat(ph(n)));for(var a=fh(e),s=fh(n),l=0;l<i.length;++l){var c=i[l];if(!(ch[c]||r&&r[c]||s&&s[c]||a&&a[c])){var u=gh(n,c);try{dh(e,c,u)}catch(t){}}}}return e}(o,t)}},Uh=F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.heightWidthRadiusDefaults=e.heightWidthDefaults=e.sizeMarginDefaults=e.sizeDefaults=void 0;var n={loading:!0,color:"#000000",css:"",speedMultiplier:1};function r(t){return Object.assign({},n,{size:t})}function o(t,e){return Object.assign({},n,{height:t,width:e})}e.sizeDefaults=r,e.sizeMarginDefaults=function(t){return Object.assign({},r(t),{margin:2})},e.heightWidthDefaults=o,e.heightWidthRadiusDefaults=function(t,e,n){return void 0===n&&(n=2),Object.assign({},o(t,e),{radius:n,margin:2})}}));O(Uh);var Jh=F((function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.calculateRgba=void 0,function(t){t.maroon="#800000",t.red="#FF0000",t.orange="#FFA500",t.yellow="#FFFF00",t.olive="#808000",t.green="#008000",t.purple="#800080",t.fuchsia="#FF00FF",t.lime="#00FF00",t.teal="#008080",t.aqua="#00FFFF",t.blue="#0000FF",t.navy="#000080",t.black="#000000",t.gray="#808080",t.silver="#C0C0C0",t.white="#FFFFFF"}(n||(n={})),e.calculateRgba=function(t,e){if(Object.keys(n).includes(t)&&(t=n[t]),"#"===t[0]&&(t=t.slice(1)),3===t.length){var r="";t.split("").forEach((function(t){r+=t,r+=t})),t=r}return"rgba("+(t.match(/.{2}/g)||[]).map((function(t){return parseInt(t,16)})).join(", ")+", "+e+")"}}));O(Jh);var Qh=F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.cssValue=e.parseLengthAndUnit=void 0;var n={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function r(t){if("number"==typeof t)return{value:t,unit:"px"};var e,r=(t.match(/^[0-9.]*/)||"").toString();e=r.includes(".")?parseFloat(r):parseInt(r,10);var o=(t.match(/[^0-9]*$/)||"").toString();return n[o]?{value:e,unit:o}:(console.warn("React Spinners: "+t+" is not a valid css value. Defaulting to "+e+"px."),{value:e,unit:"px"})}e.parseLengthAndUnit=r,e.cssValue=function(t){var e=r(t);return""+e.value+e.unit}}));O(Qh);var Kh=F((function(t,e){var n=I&&I.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=I&&I.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(Uh,e),r(Jh,e),r(Qh,e)}));O(Kh);var Zh=O(F((function(t,e){var n,r=I&&I.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},o=I&&I.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=I&&I.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=I&&I.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=I&&I.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var l,c,u=s(y),h=Xh.keyframes(l||(l=r(["\n  0% {transform: scale(1);opacity: 1}\n  45% {transform: scale(0.1);opacity: 0.7}\n  80% {transform: scale(1);opacity: 1}\n"],["\n  0% {transform: scale(1);opacity: 1}\n  45% {transform: scale(0.1);opacity: 0.7}\n  80% {transform: scale(1);opacity: 1}\n"]))),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.style=function(t){var n=e.props,o=n.color,i=n.size,a=n.margin,s=n.speedMultiplier;return Xh.css(c||(c=r(["\n      background-color: ",";\n      width: ",";\n      height: ",";\n      margin: ",";\n      border-radius: 100%;\n      display: inline-block;\n      animation: "," ","s ","s infinite\n        cubic-bezier(0.2, 0.68, 0.18, 1.08);\n      animation-fill-mode: both;\n    "],["\n      background-color: ",";\n      width: ",";\n      height: ",";\n      margin: ",";\n      border-radius: 100%;\n      display: inline-block;\n      animation: "," ","s ","s infinite\n        cubic-bezier(0.2, 0.68, 0.18, 1.08);\n      animation-fill-mode: both;\n    "])),o,Kh.cssValue(i),Kh.cssValue(i),Kh.cssValue(a),h,.75/s,.12*t/s)},e}return o(e,t),e.prototype.render=function(){var t=this.props;return t.loading?Xh.jsx("span",{css:[t.css]},Xh.jsx("span",{css:this.style(1)}),Xh.jsx("span",{css:this.style(2)}),Xh.jsx("span",{css:this.style(3)})):null},e.defaultProps=Kh.sizeMarginDefaults(15),e}(u.PureComponent);e.default=f}))),tf=c.makeStyles((function(){return{table:{padding:0},link:{color:"rgb(0, 0, 238)"},tableContainer:{width:"100%",maxHeight:600,overflow:"auto"}}}));function ef(t){var n=tf(),r=t.model,i=t.pathways,a=P(e.useState(0),2),s=a[0],l=a[1],u=P(e.useState(5),2),h=u[0],d=u[1],m=P(e.useState({name:""}),2),p=m[0],g=m[1];return i=i.slice().sort((function(t,e){return parseFloat(t.entities.pValue)-parseFloat(e.entities.pValue)})),y.createElement(f.BaseCard,{title:"Pathways"},y.createElement(c.TableContainer,{className:n.tableContainer},y.createElement(c.Table,{className:n.table},y.createElement(c.TableHead,null,y.createElement(c.TableRow,null,["Pathway name","Entities found","Entities Total","Entities ratio","Entities pValue","Entities FDR","Reactions found","Reactions total","Reactions ratio"].map((function(t,e){return y.createElement(c.TableCell,{key:"".concat(e,"-").concat(t)},t)})))),y.createElement(c.TableBody,null,i.slice(s*h,s*h+h).map((function(t,e){var n=function(t){return p.name===t.name}(t);return y.createElement(c.TableRow,{key:e,onClick:function(e){return function(t,e){g(e);var n=[],i=o.getSession(r);i.views.forEach((function(t,o){if(t===r){var a=i.views.filter((function(e){return(null==e?void 0:e.ideogramId)===(null==t?void 0:t.ideogramId)&&e!==t}))[0];a.ideoAnnotations.forEach((function(t){var r;null!==(r=t.details.reactomeIds)&&void 0!==r&&r.includes(e.stId)&&n.push(t.name)})),a.setHighlightedAnnots(n)}}))}(0,t)},selected:n},y.createElement(c.TableCell,null,y.createElement(c.Link,{target:"_blank",rel:"noopener",underline:"always",href:"https://reactome.org/content/detail/".concat(t.stId)},t.name)),y.createElement(c.TableCell,{align:"right"},t.entities.found),y.createElement(c.TableCell,{align:"right"},t.entities.total),y.createElement(c.TableCell,{align:"right"},t.entities.ratio.toExponential(2)),y.createElement(c.TableCell,{align:"right"},t.entities.pValue.toExponential(2)),y.createElement(c.TableCell,{align:"right"},t.entities.fdr.toExponential(2)),y.createElement(c.TableCell,{align:"right"},t.reactions.found),y.createElement(c.TableCell,{align:"right"},t.reactions.total),y.createElement(c.TableCell,{align:"right"},t.reactions.ratio.toFixed(3)))}))))),y.createElement(c.TablePagination,{rowsPerPageOptions:[5,10,25],component:"div",count:i.length,rowsPerPage:h,page:s,onPageChange:function(t,e){l(e)},onRowsPerPageChange:function(t){d(parseInt(t.target.value,10)),l(0)}}))}var nf=s.observer(ef),rf=0,of=s.observer((function(t){var n=t.model,r=e.useRef(null),i=e.useMemo((function(){return"ideo-container-"+ ++rf}),[]),a={organism:"human",sex:n.sex,chrHeight:n.allRegions||"vertical"===n.orientation?500:900,chrWidth:n.allRegions&&"vertical"===n.orientation?8:10,chromosomes:n.allRegions?kc:[n.region],showBandLabels:!n.allRegions,rotatable:!1,orientation:n.orientation,container:"#"+i,annotations:n.ideoAnnotations&&n.showAnnotations?n.ideoAnnotations:void 0,legend:n.ideoAnnotations&&"tier"in n.ideoAnnotations[0].details?Sc:void 0,onClickAnnot:function(t){var e=o.getSession(n),r=n.widgetAnnotations.filter((function(e){return e.name===t.name}))[0];if(n.setSelectedAnnot(t.name),e){var i=e.addWidget("IdeogramFeatureWidget","ideogramFeature",{featureData:r,view:n});e.showWidget(i),e.setSelection(r)}}};return e.useEffect((function(){if(r.current)return new Ql(a)}),[n.sex,n.orientation,n.pliody,n.showImportForm,n.allRegions,n.region,n.showAnnotations,n.showLoading,n.isAnalysisResults,n.selectedAnnot,n.highlightedAnnots]),e.useEffect((function(){var t=function(){var t=C(W.mark((function t(){return W.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Tc(n);case 2:n.setShowLoading(!1);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();n.ideoAnnotations||n.showImportForm||t().catch(console.error)}),[n.annotationsLocation,n.withReactome]),y.createElement("div",null,n.showImportForm&&!n.isAnalysisResults?y.createElement(Bc,{model:n}):null,n.showImportForm||!n.showLoading||n.isAnalysisResults?null:y.createElement(c.Grid,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",style:{paddingTop:"5px"},direction:"column"},y.createElement(c.Typography,{variant:"body1"},"Generating annotations"),y.createElement(Zh,{color:"#0D233F",speedMultiplier:.5,size:10})),n.showImportForm||n.showLoading||n.isAnalysisResults||"horizontal"!==n.orientation?null:y.createElement(c.Grid,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},y.createElement("div",{ref:r,id:i})),n.showImportForm||n.showLoading||n.isAnalysisResults||"vertical"!==n.orientation?null:y.createElement("div",{ref:r,id:i,style:{paddingTop:"5px"}}),n.isAnalysisResults&&n.pathways?y.createElement(nf,{model:n,pathways:n.pathways}):null,n.isAnalysisResults?null:y.createElement(c.Typography,{variant:"caption",style:{paddingLeft:"4px",paddingBottom:"4px"}},"Powered by"," ",y.createElement(c.Link,{href:"https://eweitz.github.io/ideogram/"},"ideogram.js"),"."))})),af=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");e.default=r}))),sf=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");e.default=r}))),lf=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M3 18h13v-2H3v2zm0-5h10v-2H3v2zm0-7v2h13V6H3zm18 9.59L17.42 12 21 8.41 19.59 7l-5 5 5 5L21 15.59z"}),"MenuOpen");e.default=r}))),cf=c.makeStyles((function(){return{table:{padding:0},link:{color:"rgb(0, 0, 238)"},tableContainer:{width:"100%",maxHeight:600,overflow:"auto"}}})),uf=s.observer((function(t){var e=cf(),n=t.id,r=t.name,o=t.link;return y.createElement(y.Fragment,null,y.createElement(c.TableRow,{key:"".concat(n,"-").concat(r)},y.createElement(c.TableCell,null,r),y.createElement(c.TableCell,null,y.createElement(c.Link,{className:e.link,target:"_blank",rel:"noopener",href:"".concat(o),underline:"always"},n))))}));function hf(t){var e=cf(),n=t.feature;return y.createElement(f.BaseCard,{title:"External Links"},y.createElement("div",{className:e.tableContainer},y.createElement(c.Table,{className:e.table},y.createElement(c.TableBody,null,n.externalLinks.map((function(t,e){return y.createElement(uf,Object.assign({id:n.geneSymbol?n.geneSymbol:n.name},t,{key:e}))}))))))}function ff(t){var e=cf(),n=t.feature,r=n.synonyms.split(",");return y.createElement(f.BaseCard,{title:"Synonyms"},y.createElement("div",{className:e.tableContainer},y.createElement(c.Table,{className:e.table},y.createElement(c.TableBody,null,y.createElement(c.TableRow,{key:"".concat(n.geneId,"-synonyms")},y.createElement(c.TableCell,null,r.map((function(t,e){return y.createElement(c.Chip,{label:t,key:e,style:{marginRight:"2px",marginTop:"2px"}})}))))))))}function df(t){var e=t.feature,n=t.model;return y.createElement(f.BaseCard,{title:"Navigate to feature on linear genome view"},y.createElement("div",{style:{display:"flex",justifyContent:"center"}},y.createElement(c.Button,{variant:"contained",color:"primary",size:"large",onClick:function(){!function(t,e){Lc.apply(this,arguments)}("".concat(e.genomeLocation),n)}},"Navigate")))}function mf(t){var e=t.node,n=t.model,r=t.pathways,o=t.geneName,i=cf();return y.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},y.createElement(c.Link,{className:i.link,target:"_blank",rel:"noopener",href:"https://reactome.org/PathwayBrowser/#/".concat(e.stId,"&FLG=").concat(e.name),underline:"always"},e.name),n.hasPlugin("ReactomePlugin")?y.createElement(c.Tooltip,{title:"Open pathway in Reactome Plugin"},y.createElement(c.IconButton,{color:"primary",component:"span",onClick:function(){!function(t,e,n,r,o){Ec.apply(this,arguments)}(e.stId,r,e.name,o,n)}},y.createElement(lf,null))):null)}function pf(t){var e=t.hierarchy,n=t.model,r=t.pathways,o=t.geneName;return y.createElement(f.BaseCard,{title:"Reactome Annotated Pathways"},y.createElement(p.TreeView,{defaultCollapseIcon:y.createElement(af,null),defaultExpandIcon:y.createElement(sf,null)},e.map((function(t){return function t(e){return y.createElement(p.TreeItem,{key:e.stId,nodeId:e.stId,label:y.createElement(mf,{node:e,model:n,pathways:r,geneName:o})},Array.isArray(e.children)?e.children.map((function(e){return t(e)})):null)}(t)}))))}function gf(t){var e,n=t.model,r=n.featureData,o=_({start:r.start,end:r.end},r.details);return y.createElement(c.Paper,{"data-testid":"ideo-widget"},y.createElement(f.FeatureDetails,Object.assign({feature:o},t,{omit:["synonyms","externalLinks","pathways","reactomeIds","hierarchy"]})),y.createElement(df,{feature:o,model:n}),o.externalLinks&&y.createElement(hf,{feature:o}),o.synonyms&&y.createElement(ff,{feature:o}),(null===(e=o.hierarchy)||void 0===e?void 0:e.length)>0&&y.createElement(pf,{hierarchy:o.hierarchy,model:n,pathways:o.pathways,geneName:o.name}))}var yf=s.observer(gf),vf=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility");e.default=r})));function bf(t){return y.createElement(g,Object.assign({},t),y.createElement("path",{d:"M4,22H2V2h2V22z M22,7H6v3h16V7z M16,14H6v3h10V14z"}))}function wf(t){return y.createElement(g,Object.assign({},t),y.createElement("path",{d:"M9.5,11c1.93,0,3.5,1.57,3.5,3.5S11.43,18,9.5,18S6,16.43,6,14.5S7.57,11,9.5,11z M9.5,9C6.46,9,4,11.46,4,14.5 S6.46,20,9.5,20s5.5-2.46,5.5-5.5c0-1.16-0.36-2.23-0.97-3.12L18,7.42V10h2V4h-6v2h2.58l-3.97,3.97C11.73,9.36,10.66,9,9.5,9z"}))}function xf(t){return y.createElement(g,Object.assign({},t),y.createElement("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"}))}var _f=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"}),"FolderOpen");e.default=r}))),Af=O(F((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=D(y),r=(0,j(R).default)(n.createElement("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"}),"TableChart");e.default=r})));t.default=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(r,t);var e,n=M(r);function r(){var t;return k(this,r),(t=n.apply(this,arguments)).name="IdeogramPlugin",t.version="1.2.3",t}return(e=[{key:"install",value:function(t){t.addViewType((function(){return new i({name:"IdeogramView",stateModel:m.types.model("IdeogramView",{type:m.types.literal("IdeogramView"),displayName:m.types.maybe(m.types.string),id:d.ElementId,sex:"female",orientation:"vertical",region:"1",assembly:"hg38",selectedAnnot:"",ideogramId:"",allRegions:!1,showImportForm:!0,showAnnotations:!0,withReactome:!1,showLoading:!1,isAnalysisResults:!1,annotationsLocation:m.types.optional(m.types.frozen(),{uri:"",locationType:"UriLocation"})}).volatile((function(){return{widgetAnnotations:void 0,ideoAnnotations:void 0,pathways:void 0,highlightedAnnots:void 0}})).actions((function(t){return{setWidth:function(t){},setDisplayName:function(e){t.displayName=e},setRegion:function(e){t.region=e.split("chr")[1]},setAssembly:function(e){t.assembly=e},setAllRegions:function(e){t.allRegions=e},setOrientation:function(e){"horizontal"===e&&(t.orientation=e),"vertical"===e&&(t.orientation=e)},setShowImportForm:function(e){t.showImportForm=e},setAnnotationsLocation:function(e){t.annotationsLocation=e},setWidgetAnnotations:function(e){t.widgetAnnotations=e},setIdeoAnnotations:function(e){t.ideoAnnotations=e},setWithReactome:function(e){t.withReactome=e},setShowLoading:function(e){t.showLoading=e},setPathways:function(e){t.pathways=e},setIsAnalysisResults:function(e){t.isAnalysisResults=e},setSelectedAnnot:function(e){t.selectedAnnot=e,this.applyHighlighting()},setHighlightedAnnots:function(e){t.highlightedAnnots=e,this.applyHighlighting()},setIdeogramId:function(e){t.ideogramId=e},applyHighlighting:function(){t.ideoAnnotations.filter((function(e){var n,r;null!==(n=t.highlightedAnnots)&&void 0!==n&&n.includes(e.name)&&(e.color="#FFC20A"),t.selectedAnnot===e.name&&(e.color="#000000"),null!==(r=t.highlightedAnnots)&&void 0!==r&&r.includes(e.name)||t.selectedAnnot===e.name||(e.color=e.prevColor)}))},toggleAllRegions:function(t){!1===t&&this.setOrientation("horizontal"),this.setAllRegions(t)},toggleOrientation:function(){this.setOrientation("horizontal"===t.orientation?"vertical":"horizontal")},toggleSex:function(){t.sex="male"===t.sex?"female":"male"},toggleAnnotations:function(){t.showAnnotations=!t.showAnnotations},refreshTable:function(){var e=o.getSession(t),n=!1;if(e.views.forEach((function(t){null!=t&&t.isAnalysisResults&&(n=!0)})),n)e.notify("The analysis results table is already displayed.","info");else{e.addView("IdeogramView",{});var r=e.views.length-1;e.views[r].setDisplayName("Reactome Analysis Results"),e.views[r].setPathways(t.pathways),e.views[r].setIsAnalysisResults(!0),e.views[r].setIdeogramId(t.ideogramId)}}}})).views((function(t){return{menuItems:function(){return[{label:"Return to import form",icon:_f,disabled:!0===t.isAnalysisResults,onClick:function(){return t.setShowImportForm(!0)}},{label:"Show all regions in assembly",icon:vf,type:"checkbox",checked:!0===t.allRegions,disabled:!0===t.isAnalysisResults||!0===t.showImportForm,onClick:function(){return t.toggleAllRegions(!t.allRegions)}},{label:"Horizontal Display",icon:bf,type:"checkbox",disabled:!1===t.allRegions&&!0===t.isAnalysisResults||!0===t.showImportForm,checked:"horizontal"===t.orientation,onClick:function(){return t.toggleOrientation()}},{label:"Male Genome",icon:wf,type:"checkbox",checked:"male"===t.sex,disabled:!0===t.isAnalysisResults||!0===t.showImportForm,onClick:function(){return t.toggleSex()}},{label:"Show annotations",icon:xf,type:"checkbox",checked:!0===t.showAnnotations&&void 0!==t.ideoAnnotations,disabled:void 0===t.widgetAnnotations&&!0===t.isAnalysisResults||!0===t.showImportForm||void 0===t.ideoAnnotations,onClick:function(){return t.toggleAnnotations()}},{label:"Refresh Analysis Results Table",icon:Af,disabled:!0===t.isAnalysisResults||!0===t.showImportForm||!1===t.withReactome,onClick:function(){return t.refreshTable()}}]}}})),ReactComponent:of})})),t.addWidgetType((function(){return new a(_({name:"IdeogramFeatureWidget",heading:"Feature Details"},function(t){return{configSchema:l.ConfigurationSchema("IdeogramFeatureWidget",{}),stateModel:m.types.model("IdeogramFeatureWidget",{id:d.ElementId,type:m.types.literal("IdeogramFeatureWidget"),featureData:m.types.frozen({}),view:m.types.safeReference(t.pluggableMstType("view","stateModel"))}).actions((function(e){return{setFeatureData:function(t){e.featureData=t},clearFeatureData:function(){e.featureData={}},hasPlugin:function(e){return t.hasPlugin(e)}}})),ReactComponent:yf}}(t)))}))}},{key:"configure",value:function(t){o.isAbstractMenuManager(t.rootModel)&&t.rootModel.appendToSubMenu(["Add"],{label:"Ideogram view",icon:z,onClick:function(t){t.addView("IdeogramView",{}),t.views[t.views.length-1].setDisplayName("Ideogram View")}})}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(r.prototype,e),r}(r),Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=jbrowse-plugin-ideogram.umd.production.min.js.map
