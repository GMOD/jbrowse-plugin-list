!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@jbrowse/core/Plugin"),require("@jbrowse/core/data_adapters/BaseAdapter"),require("@jbrowse/core/pluggableElementTypes/AdapterType"),require("@jbrowse/core/util/rxjs"),require("@jbrowse/core/configuration")):"function"==typeof define&&define.amd?define(["exports","@jbrowse/core/Plugin","@jbrowse/core/data_adapters/BaseAdapter","@jbrowse/core/pluggableElementTypes/AdapterType","@jbrowse/core/util/rxjs","@jbrowse/core/configuration"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).JBrowsePluginBiothings={},e.JBrowseExports["@jbrowse/core/Plugin"],e.JBrowseExports["@jbrowse/core/data_adapters/BaseAdapter"],e.JBrowseExports["@jbrowse/core/pluggableElementTypes/AdapterType"],e.JBrowseExports["@jbrowse/core/util/rxjs"],e.JBrowseExports["@jbrowse/core/configuration"])}(this,(function(e,t,r,n,a,i){"use strict";var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o={};function c(e){return"uniqueId"in e&&"object"!=typeof e.data}Object.defineProperty(o,"__esModule",{value:!0}),o.isFeature=void 0,o.isFeature=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.get&&"function"==typeof e.id};class l{constructor(e){var t;c(e)?this.data=e:(this.data=e.data||{},this.parentHandle=e.parent);const r=c(e)?e.uniqueId:e.id;if(null==r)throw new Error("SimpleFeature requires a unique `id` or `data.uniqueId` attribute");if(this.uniqueId=String(r),!(this.data.aliases||this.data.end-this.data.start>=0))throw new Error(`invalid feature data, end less than start. end: ${this.data.end} start: ${this.data.start}`);this.data.subfeatures&&(this.subfeatures=null===(t=this.data.subfeatures)||void 0===t?void 0:t.map(((e,t)=>"function"!=typeof e.get?new l({id:e.uniqueId||`${r}-${t}`,data:{strand:this.data.strand,...e},parent:this}):e)))}get(e){return"subfeatures"===e?this.subfeatures:"parent"===e?this.parent():this.data[e]}set(e,t){this.data[e]=t}tags(){return Object.keys(this.data)}id(){return this.uniqueId}parent(){return this.parentHandle}children(){return this.get("subfeatures")}toJSON(){const e={...this.data,uniqueId:this.id()},t=this.parent();t&&(e.parentId=t.id());const r=this.children();return r&&(e.subfeatures=r.map((e=>e.toJSON()))),e}static fromJSON(e){return new l({...e})}}var d=o.default=l,u={},h={},f={},p={};function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},w.apply(this,arguments)}Object.defineProperty(p,"__esModule",{value:!0});var E=function(){function e(){b(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return g(e,[{key:"addEventListener",value:function(e,t,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:r})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,a=r.length;n<a;n++)if(r[n].callback===t)return void r.splice(n,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),r=0,n=t.length;r<n;r++){var a=t[r];try{a.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}a.options&&a.options.once&&this.removeEventListener(e.type,a.callback)}return!e.defaultPrevented}}}]),e}(),A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(a,e);var t,r,n=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=m(t);if(r){var a=m(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}(this,e)});function a(){var e;return b(this,a),(e=n.call(this)).listeners||E.call(_(e)),Object.defineProperty(_(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(_(e),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(_(e),"reason",{value:void 0,writable:!0,configurable:!0}),e}return g(a,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),w(m(a.prototype),"dispatchEvent",this).call(this,e)}}]),a}(E),O=function(){function e(){b(this,e),Object.defineProperty(this,"signal",{value:new A,writable:!0,configurable:!0})}return g(e,[{key:"abort",value:function(e){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}var r=e;if(void 0===r)if("undefined"==typeof document)(r=new Error("This operation was aborted")).name="AbortError";else try{r=new DOMException("signal is aborted without reason")}catch(e){(r=new Error("This operation was aborted")).name="AbortError"}this.signal.reason=r,this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(O.prototype[Symbol.toStringTag]="AbortController",A.prototype[Symbol.toStringTag]="AbortSignal"),p.AbortController=O,p.AbortSignal=A,p.abortableFetch=function(e){"function"==typeof e&&(e={fetch:e});var t=e.fetch,r=e.Request,n=void 0===r?t.Request:r,a=e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,i=void 0!==a&&a;if(!function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}({fetch:t,Request:n,AbortController:e.AbortController,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:i}))return{fetch:t,Request:s};var s=n;(s&&!s.prototype.hasOwnProperty("signal")||i)&&((s=function(e,t){var r;t&&t.signal&&(r=t.signal,delete t.signal);var a=new n(e,t);return r&&Object.defineProperty(a,"signal",{writable:!1,enumerable:!1,configurable:!0,value:r}),a}).prototype=n.prototype);var o=t;return{fetch:function(e,t){var r=s&&s.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(r){var n;try{n=new DOMException("Aborted","AbortError")}catch(e){(n=new Error("Aborted")).name="AbortError"}if(r.aborted)return Promise.reject(n);var a=new Promise((function(e,t){r.addEventListener("abort",(function(){return t(n)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([a,o(e,t)])}return o(e,t)},Request:s}},Object.defineProperty(f,"__esModule",{value:!0}),f.AbortSignal=f.AbortController=void 0;const x=p;var C=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s)return s;throw new Error("unable to locate global object")};let j=void 0===C().AbortController?x.AbortController:C().AbortController;f.AbortController=j;let S=void 0===C().AbortController?x.AbortSignal:C().AbortSignal;f.AbortSignal=S;var T={};Object.defineProperty(T,"__esModule",{value:!0});const R=f;class P{}T.default=class{constructor(){this.signals=new Set,this.abortController=new R.AbortController}addSignal(e=new P){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(e),e.aborted?this.handleAborted(e):"function"==typeof e.addEventListener&&e.addEventListener("abort",(()=>{this.handleAborted(e)}))}handleAborted(e){this.signals.delete(e),0===this.signals.size&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}};var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.default=class{constructor(){this.callbacks=new Set}addCallback(e=(()=>{})){this.callbacks.add(e),e(this.currentMessage)}callback(e){this.currentMessage=e,this.callbacks.forEach((t=>{t(e)}))}};var I=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(h,"__esModule",{value:!0});const N=f,L=I(T),M=I(k);class q{constructor({fill:e,cache:t}){if("function"!=typeof e)throw new TypeError("must pass a fill function");if("object"!=typeof t)throw new TypeError("must pass a cache object");if("function"!=typeof t.get||"function"!=typeof t.set||"function"!=typeof t.delete)throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=t,this.fillCallback=e}static isAbortException(e){return"AbortError"===e.name||"ERR_ABORTED"===e.code||"AbortError: aborted"===e.message||"Error: aborted"===e.message}evict(e,t){this.cache.get(e)===t&&this.cache.delete(e)}fill(e,t,r,n){const a=new L.default,i=new M.default;i.addCallback(n);const s={aborter:a,promise:this.fillCallback(t,a.signal,(e=>{i.callback(e)})),settled:!1,statusReporter:i,get aborted(){return this.aborter.signal.aborted}};s.aborter.addSignal(r),s.aborter.signal.addEventListener("abort",(()=>{s.settled||this.evict(e,s)})),s.promise.then((()=>{s.settled=!0}),(()=>{s.settled=!0,this.evict(e,s)})).catch((e=>{throw console.error(e),e})),this.cache.set(e,s)}static checkSinglePromise(e,t){function r(){if(t&&t.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then((e=>(r(),e)),(e=>{throw r(),e}))}has(e){return this.cache.has(e)}get(e,t,r,n){if(!r&&t instanceof N.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const a=this.cache.get(e);return a?a.aborted&&!a.settled?(this.evict(e,a),this.get(e,t,r,n)):a.settled?a.promise:(a.aborter.addSignal(r),a.statusReporter.addCallback(n),q.checkSinglePromise(a.promise,r)):(this.fill(e,t,r,n),q.checkSinglePromise(this.cache.get(e).promise,r))}delete(e){const t=this.cache.get(e);t&&(t.settled||t.aborter.abort(),this.cache.delete(e))}clear(){const e=this.cache.keys();let t=0;for(let r=e.next();!r.done;r=e.next())this.delete(r.value),t+=1;return t}}h.default=q;var z=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(u,"__esModule",{value:!0});const B=z(h);var F=u.default=B.default,D={};Object.defineProperty(D,"__esModule",{value:!0});class $ extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,r]of e)this.onEviction(t,r.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const r=t.get(e);return this._getItemValue(e,r)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,r]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,r)&&(yield e)}for(const e of this.cache){const[t,r]=e;!1===this._deleteIfExpired(t,r)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:r=this.maxAge}={}){const n="number"==typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:n}):this._set(e,{value:t,expiry:n})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],r=t.length-e;r<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(r>0&&this._emitEvictions(t.slice(0,r)),this.oldCache=new Map(t.slice(r)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,r]=e;!1===this._deleteIfExpired(t,r)&&(yield[t,r.value])}for(const e of this.oldCache){const[t,r]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,r)&&(yield[t,r.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,a]=r;!1===this._deleteIfExpired(n,a)&&(yield[n,a.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,a]=r;this.cache.has(n)||!1===this._deleteIfExpired(n,a)&&(yield[n,a.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[r,n]of this.entriesAscending())e.call(t,n,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}var U=D.default=$,V=/\{([0-9a-zA-Z_]+)\}/g,J=function(e){var t;if(2===arguments.length&&"object"==typeof arguments[1])t=arguments[1];else{t=new Array(arguments.length-1);for(var r=1;r<arguments.length;++r)t[r-1]=arguments[r]}return t&&t.hasOwnProperty||(t={}),e.replace(V,(function(r,n,a){var i;return"{"===e[a-1]&&"}"===e[a+r.length]?n:null==(i=t.hasOwnProperty(n)?t[n]:null)?"":i}))};const Y=i.ConfigurationSchema("MyGeneV3Adapter",{baseUrl:{type:"string",defaultValue:""}},{explicitlyTyped:!0});let W=class extends r.BaseFeatureDataAdapter{featureCache=new F({cache:new U({maxSize:100}),fill:e=>this.readChunk(e)});async getRefNames(e={}){return[]}getFeatures(e,t={}){const r=i.readConfObject(this.config,"baseUrl");return a.ObservableCreate((async n=>{const a=1e5,i=e.end+(a-e.end%a),s=[];for(let t=e.start-e.start%a;t<i;t+=a)s.push({refName:e.refName,start:t,end:t+a,assemblyName:e.assemblyName,baseUrl:r});await Promise.all(s.map((async r=>{const a=`${r.assemblyName},${r.refName},${r.start},${r.end}`,i=t.signal;(await this.featureCache.get(a,r,i)).forEach((t=>{t&&!(t.get("start")>e.end)&&t.get("end")>=e.start&&n.next(t)}))}))),n.complete()}),t.signal)}async readChunk(e){const{start:t,end:r,refName:n,baseUrl:a}=e,i=n.startsWith("chr")?n:`chr${n}`,s=J(a,{ref:i,start:t,end:r}),o=Number(a.includes("hg19")),c=await fetch(s);if(!c.ok)throw new Error(`Failed to fetch ${c.status} ${c.statusText}`);return(await c.json()).hits.map((e=>{const{genomic_pos:t,genomic_pos_hg19:r,exons:a,exons_hg19:i,_id:s,_score:c,_license:l,...u}=e;let h=[t,r][o];Array.isArray(h)&&(h=h.find((e=>n.replace("chr","")===e.chr)));let f=[a,i][o];if(!f)return new d({id:s,data:{...u,refName:h.chr,start:h.start,end:h.end,strand:h.strand,name:e.symbol,description:e.name,type:"gene"}});if(e.map_location&&!e.map_location.match(`^${h.chr}(p|q)`))return null;if(f&&(f=f.filter((t=>e.map_location?.startsWith(t.chr)))),f&&f.length){const t=f.map(((e,t)=>({start:e.txstart,end:e.txend,name:e.transcript,strand:e.strand,thickStart:e.cdsstart,thickEnd:e.cdsend,refName:h.chr,subfeatures:e.position.map((t=>({start:t[0],end:t[1],strand:e.strand,type:"exon"})))}))).filter((e=>e.start>=h.start-2e3&&e.end<=h.end+2e3)).map((t=>"protein-coding"===e.type_of_gene?function(e){const{thickStart:t,thickEnd:r,refName:n,strand:a,subfeatures:i}=e;if(!t&&!r)return e;const s=(i?i.sort(((e,t)=>e.start-t.start)):[]).map((({start:e,end:i})=>t>=i?{type:(a>0?"five":"three")+"_prime_UTR",start:e,end:i}:t>e&&t<i&&r>=i?[{type:(a>0?"five":"three")+"_prime_UTR",start:e,end:t},{type:"CDS",start:t,end:i,refName:n}]:t<=e&&r>=i?{type:"CDS",start:e,end:i}:t>e&&t<i&&r<i?[{type:(a>0?"five":"three")+"_prime_UTR",start:e,end:t},{type:"CDS",start:t,end:r},{type:(a>0?"three":"five")+"_prime_UTR",start:r,end:i}]:t<=e&&r>e&&r<i?[{type:"CDS",start:e,end:r},{type:(a>0?"three":"five")+"_prime_UTR",start:r,end:i}]:r<=e?{type:(a>0?"three":"five")+"_prime_UTR",start:e,end:i}:void 0)).filter((e=>!!e)).flat();return{...e,subfeatures:s.map((e=>({...e,refName:n}))),type:"mRNA"}}(t):t)),[r,n]=[Math.min(h.start,...t.map((e=>e.start))),Math.max(h.end,...t.map((e=>e.end)))];return new d({id:s,data:{...u,refName:h.chr,start:r,end:n,strand:h.strand,name:e.symbol,description:e.name,type:"gene",subfeatures:t}})}return null}))}freeResources(){}};async function G(e){const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch ${t.status} ${t.statusText}`);return t.json()}function H(e,t){const r=+e._id.match(/chr.*:g.([0-9]+)/)[1],n=new d({uniqueId:e._id,start:r-1,end:r,name:e._id,refName:t});function a(e,t,r){if(!t)return;if(e.match(/snpeff/)){if(Array.isArray(t.ann))return void t.ann.forEach(((t,r)=>{a(e+"_"+r,t,r)}));t.ann?(delete t.ann.cds,delete t.ann.cdna,delete t.ann.protein):(delete t.cds,delete t.cdna,delete t.protein)}e.match(/cadd/)&&(t.encode&&a(e+"_encode",t.encode),delete t.encode),e.match(/clinvar/)&&(a(e+"_hgvs",t.hgvs),delete t.hgvs,Array.isArray(t.rcv)?t.rcv.forEach(((t,r)=>{a(e+"_rcv"+r,t)})):a(e+"_rcv",t.rcv),delete t.rcv),e.match(/grasp/)&&(Array.isArray(t.publication)&&t.publication.forEach(((t,r)=>{a(e+"_publication"+r,t)})),delete t.publication),n.data[e+"_attrs"+(r||"")]={};const i=Object.keys(t).filter((e=>"object"!=typeof t[e])),s=Object.keys(t).filter((e=>"object"==typeof t[e]&&"gene"!==e));i.forEach((a=>{n.data[e+"_attrs"+(r||"")][a]=t[a]})),s.forEach((a=>{n.data[e+"_"+a+(r||"")]=t[a]}))}return a("cadd",e.cadd),a("cosmic",e.cosmic),a("dbnsfp",e.dbnsfp),a("dbsnp",e.dbsnp),a("evs",e.evs),a("exac",e.exac),a("mutdb",e.mutdb),a("wellderly",e.wellderly),a("snpedia",e.snpedia),a("snpeff",e.snpeff),a("vcf",e.vcf),a("grasp",e.grasp),a("gwassnps",e.gwassnps),a("docm",e.docm),a("emv",e.emv),a("clinvar",e.clinvar),a("uniprot",e.uniprot),n}const Z=i.ConfigurationSchema("MyVariantV1Adapter",{baseUrl:{type:"string",defaultValue:""},query:{type:"string",defaultValue:""}},{explicitlyTyped:!0});class K extends r.BaseFeatureDataAdapter{async getRefNames(e={}){return[]}getFeatures(e,t={}){const r=this.getConf("baseUrl"),n=this.getConf("query"),{start:i,end:s,refName:o}=e;return a.ObservableCreate((async e=>{(await this.readChunk({start:i,end:s,refName:o,baseUrl:r,query:n})).forEach((t=>e.next(t))),e.complete()}),t.signal)}async readChunk(e){const{start:t,end:r,refName:n,baseUrl:a,query:i}=e,s=n.startsWith("chr")?n:`chr${n}`,o=J(a+i,{ref:s,start:t,end:r}),c=await G(o),{hits:l=[]}=c,d=[],u=async(e,t)=>{const r=J(a+"query?scroll_id={scrollId}&size={size}&from={from}",{scrollId:e,size:1e3,from:t}),i=await G(r),{hits:s=[]}=i;d.push(...s.map((e=>H(e,n)))),s.length>=1e3&&await u(e,t+1e3)};if(l.length>=1e3){const e=await G(o+"&fetch_all=true");await u(e._scroll_id,0)}else l&&d.push(...l.map((e=>H(e,n))));return d}freeResources(){}}e.default=class extends t{name="Biothings";version="1.1.1";install(e){!function(e){e.addAdapterType((()=>new n({name:"MyGeneV3Adapter",configSchema:Y,AdapterClass:W})))}(e),function(e){e.addAdapterType((()=>new n({name:"MyVariantV1Adapter",configSchema:Z,AdapterClass:K})))}(e)}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=jbrowse-plugin-biothings.umd.production.min.js.map
