!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@jbrowse/core/Plugin"),require("@jbrowse/core/configuration"),require("@jbrowse/core/pluggableElementTypes/models"),require("@jbrowse/core/util"),require("mobx-state-tree"),require("@jbrowse/core/util/tracks"),require("react"),require("@jbrowse/core/util/io"),require("@mui/material"),require("tss-react/mui"),require("@jbrowse/core/ui"),require("@mui/material/utils")):"function"==typeof define&&define.amd?define(["exports","@jbrowse/core/Plugin","@jbrowse/core/configuration","@jbrowse/core/pluggableElementTypes/models","@jbrowse/core/util","mobx-state-tree","@jbrowse/core/util/tracks","react","@jbrowse/core/util/io","@mui/material","tss-react/mui","@jbrowse/core/ui","@mui/material/utils"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).JBrowsePluginTrackHubRegistry={},e.JBrowseExports["@jbrowse/core/Plugin"],e.JBrowseExports["@jbrowse/core/configuration"],e.JBrowseExports["@jbrowse/core/pluggableElementTypes/models"],e.JBrowseExports["@jbrowse/core/util"],e.JBrowseExports["mobx-state-tree"],e.JBrowseExports["@jbrowse/core/util/tracks"],e.JBrowseExports.react,e.JBrowseExports["@jbrowse/core/util/io"],e.JBrowseExports["@mui/material"],e.JBrowseExports["tss-react/mui"],e.JBrowseExports["@jbrowse/core/ui"],e.JBrowseExports["@mui/material/utils"])}(this,(function(e,t,r,n,a,o,i,s,c,l,u,f,d){"use strict";function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=p(t),m=p(s),y=p(d),b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g={},v={};Object.defineProperty(v,"__esModule",{value:!0}),v.default=class{constructor(e){this.name="",this.name=e.name}};var w=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(g,"__esModule",{value:!0});const _=w(v);var k=g.default=class extends _.default{constructor(e){if(super(e),this.stateModel=e.stateModel,this.configSchema=e.configSchema,this.displayName=e.displayName,this.description=e.description,this.url=e.url,this.configEditorComponent=e.configEditorComponent,!this.stateModel)throw new Error(`no stateModel defined for connection ${this.name}`);if(!this.configSchema)throw new Error(`no configSchema defined for connection ${this.name}`)}},E=r.ConfigurationSchema("TheTrackHubRegistryConnection",{trackDbId:{type:"string",defaultValue:"",description:"id of the trackDb in The Track Hub Registry"}},{baseConfiguration:n.baseConnectionConfig});function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.members?Object.values(e.members).map((function(r){return S(r,e.shortLabel?t.concat([e.shortLabel]):t)})).flat():(e.categories=t,[e])}function C(e,t,r){return S({members:e.configuration}).map((function(n){var o=L(n,e.hub.url,r);return O(O({},L(n,e.hub.url,r)),{},{trackId:"trackhub-registry-".concat(a.objectHash(o)),assemblyNames:[t]})}))}function L(e,t,r){var n=e.type.split(" ")[0].toLowerCase();"bam"===n&&e.bigDataUrl.toLowerCase().endsWith("cram")&&(n="cram");var a,o={uri:new URL(e.bigDataUrl,t).href,locationType:"UriLocation"},s=e.categories;switch(n){case"bam":return a=t?e.bigDataIndex?{uri:new URL(e.bigDataIndex,t).href,locationType:"UriLocation"}:{uri:new URL("".concat(e.bigDataUrl,".bai"),t).href,locationType:"UriLocation"}:e.bigDataIndex?{localPath:e.bigDataIndex,locationType:"LocalPathLocation"}:{localPath:"".concat(e.bigDataUrl,".bai"),locationType:"LocalPathLocation"},{type:"AlignmentsTrack",name:e.shortLabel,description:e.longLabel,category:s,adapter:{type:"BamAdapter",bamLocation:o,index:{location:a}}};case"bed":case"bed5floatscore":case"bedgraph":case"bedrnaelements":case"bigbarchart":case"bigchain":case"biginteract":case"bigmaf":case"bigpsl":case"broadpeak":case"coloredexon":case"gvf":case"ld2":case"narrowpeak":case"peptidemapping":case"vcftabix":case"wig":case"wigmaf":return i.generateUnsupportedTrackConf(e.shortLabel,n,s);case"bigbed":return{type:"FeatureTrack",name:e.shortLabel,description:e.longLabel,category:s,adapter:{type:"BigBedAdapter",bigBedLocation:o}};case"bigwig":return{type:"QuantitativeTrack",name:e.shortLabel,description:e.longLabel,category:s,adapter:{type:"BigWigAdapter",bigWigLocation:o}};case"cram":return a=t?e.bigDataIndex?{uri:new URL(e.bigDataIndex,t).href,locationType:"UriLocation"}:{uri:new URL("".concat(e.bigDataUrl,".bai"),t).href,locationType:"UriLocation"}:e.bigDataIndex?{localPath:e.bigDataIndex,locationType:"LocalPathLocation"}:{localPath:"".concat(e.bigDataUrl,".bai"),locationType:"LocalPathLocation"},{type:"AlignmentsTrack",name:e.shortLabel,description:e.longLabel,category:s,adapter:{type:"CramAdapter",bamLocation:o,index:{location:a},sequenceAdapter:r}};default:throw new Error("Unsupported track type: ".concat(n))}}async function x(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`HTTP\n          ${r.status}: ${await r.text()} from\n          ${e}`);return r.json()}function P(e){return o.types.compose("TheTrackHubRegistryConnection",n.BaseConnectionModelFactory(e),o.types.model({type:o.types.literal("TheTrackHubRegistryConnection"),configuration:r.ConfigurationReference(E)})).volatile((()=>({error:void 0}))).actions((e=>({async connect(t){e.clear();const n=r.readConfObject(t,"trackDbId");try{const t=await x(`https://www.trackhubregistry.org/api/search/trackdb/${n}`),o=t.assembly.name,i=a.getSession(e).assemblyManager.get(o);if(!i)throw new Error(`unknown assembly ${o}`);const s=C(t,o,r.getConf(i,["sequence","adapter"]));e.setTrackConfs(s)}catch(e){console.error(e),this.setError(e)}},setError(t){e.error=t}})))}var $={},R={},D={};Object.defineProperty(D,"__esModule",{value:!0});class I extends Map{constructor(e,t={checkIndent:!0}){super();const{checkIndent:r}=t;let n;this._checkIndent=r,n="string"==typeof e?e.trimEnd().split(/\r?\n/):e||[],this._keyAndCommentOrder=[],n.forEach((e=>{this.add(e)}))}add(e){if(""===e)throw new Error("Invalid stanza, contained blank lines");if(e.trim().startsWith("#"))return this._keyAndCommentOrder.push(e.trim()),this;if(e.trimEnd().endsWith("\\")){const t=e.trimEnd().slice(0,-1);return this._continuedLine?this._continuedLine+=t.trimStart():this._continuedLine=t,this}let t=e;if(this._continuedLine&&(t=this._continuedLine+t.trimStart(),this._continuedLine=void 0),this.indent||this._checkIndent){const e=t.match(/^([ \t]+)/);if(void 0===this.indent)e?[,this.indent]=e:this.indent="";else if(""===this.indent&&null!==e||this.indent&&e&&this.indent!==e[1])throw new Error("Inconsistent indentation of stanza")}else this.indent="";const r=t.trim(),n=r.indexOf(" ");if(-1===n){if(!this.nameKey)throw new Error("First line in a stanza must have both a key and a value");return this.has(r)?this:(this._keyAndCommentOrder.push(r),super.set(r,""))}const a=r.slice(0,n),o=r.slice(n+1);if(this.has(a)&&o!==this.get(a))throw new Error(`Got duplicate key with a different value in stanza: "${a}" key has both ${this.get(a)} and ${o}`);return this._keyAndCommentOrder.push(a),this.nameKey||(this.nameKey=a,this.name=r.slice(n+1)),super.set(a,o)}set(e,t){if("string"!=typeof t)throw new Error(`Value of ${e} must be a string, got ${typeof t}`);return super.set(e,t)}delete(e){if(e===this.nameKey)throw new Error("Cannot delete the first line in a stanza (you can still overwrite it with set()).");return this._keyAndCommentOrder.includes(e)&&(this._keyAndCommentOrder=this._keyAndCommentOrder.filter((t=>t!==e))),super.delete(e)}clear(){this._keyAndCommentOrder.length=0,this._continuedLine=void 0,this.indent=void 0,this.name=void 0,this.nameKey=void 0,super.clear()}toString(){if(0===this.size)return"";const e=[];return this._keyAndCommentOrder.forEach((t=>{t.startsWith("#")?e.push(`${this.indent}${t}`):e.push(`${this.indent}${t} ${this.get(t)}`.trimEnd())})),`${e.join("\n")}\n`}}D.default=I;var M=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(R,"__esModule",{value:!0});const A=M(D);class F extends Map{constructor(e,t={checkIndent:!0}){super();const{checkIndent:r}=t;let n;this._checkIndent=r,n="string"==typeof e?e.trimEnd().split(/(?:[\t ]*\r?\n){2,}/):e||[],this._stanzaAndCommentOrder=[],n.forEach((e=>{this.add(e)}))}add(e){if(""===e)throw new Error("Invalid stanza, was empty");if(e.trim().startsWith("#")){const t=e.trimEnd().split(/\r?\n/).map((e=>e.trim()));if(t.every((e=>e.startsWith("#"))))return this._stanzaAndCommentOrder.push(t.join("\n")),this}const t=new A.default(e,{checkIndent:this._checkIndent});if(this.nameKey){if(t.nameKey!==this.nameKey)throw new Error(`The first line in each stanza must have the same key. Saw both ${this.nameKey} and ${t.nameKey}`)}else this.nameKey=t.nameKey;if(!t.name)throw new Error(`No stanza name: ${t.name}`);if(this.has(t.name))throw new Error(`Got duplicate stanza name: ${t.name}`);return this._stanzaAndCommentOrder.push(t.name),super.set(t.name,t)}update(e,t){if(!(t instanceof A.default))throw new Error(`Value of ${e} is not an RaStanza`);super.set(e,t)}delete(e){return this._stanzaAndCommentOrder.includes(e)&&(this._stanzaAndCommentOrder=this._stanzaAndCommentOrder.filter((t=>t!==e))),super.delete(e)}clear(){this._stanzaAndCommentOrder.length=0,this.nameKey=void 0,super.clear()}toString(){if(0===this.size)return"";const e=[];return this._stanzaAndCommentOrder.forEach((t=>{if(t.startsWith("#"))e.push(`${t}\n`);else{const r=this.get(t);r&&e.push(r.toString())}})),e.join("\n")}}R.default=F;var z={},U=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(z,"__esModule",{value:!0});const N=U(R);z.default=class extends N.default{constructor(e){if(super(e,{checkIndent:!1}),"track"!==this.nameKey)throw new Error(`trackDb has "${this.nameKey}" instead of "track" as the first line in each track`);this.forEach(((e,t)=>{var r;const n=Array.from(e.keys()),a=[];if(["track","shortLabel"].forEach((e=>{n.includes(e)||a.push(e)})),a.length>0)throw new Error(`Track ${t} is missing required key(s): ${a.join(", ")}`);const o=["superTrack","compositeTrack","container","view"];if(!n.some((e=>o.includes(e)))){if(!n.includes("bigDataUrl"))throw new Error(`Track ${t} is missing required key "bigDataUrl"`);if(!n.includes("type")){const e=this.settings(t);if(!Array.from(e.keys()).includes("type"))throw new Error(`Neither track ${t} nor any of its parent tracks have the required key "type"`)}}let i="",s=t;do{s=null===(r=this.get(s))||void 0===r?void 0:r.get("parent"),s&&([s]=s.split(" "),i+="    ")}while(s);const c=this.get(t);c&&(c.indent=i,this.set(t,c))}))}settings(e){var t;if(!this.has(e))throw new Error(`Track ${e} does not exist`);const r=[e];let n=e;do{n=null===(t=this.get(n))||void 0===t?void 0:t.get("parent"),n&&r.push(n)}while(n);const a=new Map;return r.reverse(),r.forEach((e=>{var t;null===(t=this.get(e))||void 0===t||t.forEach(((e,t)=>{a.set(t,e)}))})),a}};var H={},q=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(H,"__esModule",{value:!0});const B=q(D);H.default=class extends B.default{constructor(e){if(super(e),"hub"!==this.nameKey)throw new Error('Hub file must begin with a line like "hub <hub_name>"');const t=["hub","shortLabel","longLabel","genomesFile","email","descriptionUrl"],r=[];if(this.forEach(((e,n)=>{t.includes(n)||r.push(n)})),r.length>0)throw new Error(`Hub file has invalid entr${1===r.length?"y":"ies"}: ${r.join(", ")}`);const n=[];if(t.forEach((e=>{"descriptionUrl"===e||this.get(e)||n.push(e)})),n.length>0)throw new Error(`Hub file is missing required entr${1===n.length?"y":"ies"}: ${n.join(", ")}`)}};var W={},K=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(W,"__esModule",{value:!0});const J=K(R);W.default=class extends J.default{constructor(e){if(super(e),"genome"!==this.nameKey)throw new Error('Genomes file must begin with a line like "genome <genome_name>"');const t=["genome","trackDb"];this.forEach(((e,r)=>{const n=[];if(t.forEach((t=>{e.get(t)||n.push(t)})),n.length>0)throw new Error(`Genomes file entry ${r} is missing required entr${1===n.length?"y":"ies"}: ${n.join(", ")}`)}))}};var V=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($,"__esModule",{value:!0}),$.GenomesFile=Z=$.HubFile=$.TrackDbFile=$.RaStanza=$.RaFile=void 0;const G=V(R);$.RaFile=G.default;const Y=V(D);$.RaStanza=Y.default;const Q=V(z);$.TrackDbFile=Q.default;const X=V(H);var Z=$.HubFile=X.default;const ee=V(W);$.GenomesFile=ee.default;var te={},re={exports:{}};!function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}(re);var ne={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=y.default}(ne);var ae="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"==typeof ae.setTimeout&&setTimeout,"function"==typeof ae.clearTimeout&&clearTimeout,new Date;var oe={},ie={exports:{}},se={},ce=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;function fe(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var de=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==n.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,n,a=fe(e),o=1;o<arguments.length;o++){for(var i in r=Object(arguments[o]))le.call(r,i)&&(a[i]=r[i]);if(ce){n=ce(r);for(var s=0;s<n.length;s++)ue.call(r,n[s])&&(a[n[s]]=r[n[s]])}}return a},pe=m.default,he=60103;if(se.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var me=Symbol.for;he=me("react.element"),se.Fragment=me("react.fragment")}var ye=pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,be=Object.prototype.hasOwnProperty,ge={key:!0,ref:!0,__self:!0,__source:!0};function ve(e,t,r){var n,a={},o=null,i=null;for(n in void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(i=t.ref),t)be.call(t,n)&&!ge.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:he,type:e,key:o,ref:i,props:a,_owner:ye.current}}se.jsx=ve,se.jsxs=ve;var we={};!function(e){"production"!==oe.NODE_ENV&&function(){var t=m.default,r=de,n=60103,a=60106;e.Fragment=60107;var o=60108,i=60114,s=60109,c=60110,l=60112,u=60113,f=60120,d=60115,p=60116,h=60121,y=60122,b=60117,g=60129,v=60131;if("function"==typeof Symbol&&Symbol.for){var w=Symbol.for;n=w("react.element"),a=w("react.portal"),e.Fragment=w("react.fragment"),o=w("react.strict_mode"),i=w("react.profiler"),s=w("react.provider"),c=w("react.context"),l=w("react.forward_ref"),u=w("react.suspense"),f=w("react.suspense_list"),d=w("react.memo"),p=w("react.lazy"),h=w("react.block"),y=w("react.server.block"),b=w("react.fundamental"),w("react.scope"),w("react.opaque.id"),g=w("react.debug_trace_mode"),w("react.offscreen"),v=w("react.legacy_hidden")}var _="function"==typeof Symbol&&Symbol.iterator,k=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function E(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];j("error",e,r)}function j(e,t,r){var n=k.ReactDebugCurrentFrame.getStackAddendum();""!==n&&(t+="%s",r=r.concat([n]));var a=r.map((function(e){return""+e}));a.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,a)}function O(e){return e.displayName||"Context"}function T(t){if(null==t)return null;if("number"==typeof t.tag&&E("Received an unexpected object in getComponentName(). This is likely a bug in React. Please file an issue."),"function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case e.Fragment:return"Fragment";case a:return"Portal";case i:return"Profiler";case o:return"StrictMode";case u:return"Suspense";case f:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case c:return O(t)+".Consumer";case s:return O(t._context)+".Provider";case l:return y="ForwardRef",b=(m=t.render).displayName||m.name||"",t.displayName||(""!==b?y+"("+b+")":y);case d:return T(t.type);case h:return T(t._render);case p:var r=t._payload,n=t._init;try{return T(n(r))}catch(e){return null}}var m,y,b;return null}var S,C,L,x,P,$,R,D=0;function I(){}I.__reactDisabledLog=!0;var M,A=k.ReactCurrentDispatcher;function F(e,t,r){if(void 0===M)try{throw Error()}catch(e){var n=e.stack.trim().match(/\n( *(at )?)/);M=n&&n[1]||""}return"\n"+M+e}var z,U=!1,N="function"==typeof WeakMap?WeakMap:Map;function H(e,t){if(!e||U)return"";var n,a=z.get(e);if(void 0!==a)return a;U=!0;var o,i=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=A.current,A.current=null,function(){if(0===D){S=console.log,C=console.info,L=console.warn,x=console.error,P=console.group,$=console.groupCollapsed,R=console.groupEnd;var e={configurable:!0,enumerable:!0,value:I,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}D++}();try{if(t){var s=function(){throw Error()};if(Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(s,[])}catch(e){n=e}Reflect.construct(e,[],s)}else{try{s.call()}catch(e){n=e}e.call(s.prototype)}}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var c=t.stack.split("\n"),l=n.stack.split("\n"),u=c.length-1,f=l.length-1;u>=1&&f>=0&&c[u]!==l[f];)f--;for(;u>=1&&f>=0;u--,f--)if(c[u]!==l[f]){if(1!==u||1!==f)do{if(u--,--f<0||c[u]!==l[f]){var d="\n"+c[u].replace(" at new "," at ");return"function"==typeof e&&z.set(e,d),d}}while(u>=1&&f>=0);break}}}finally{U=!1,A.current=o,function(){if(0==--D){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:r({},e,{value:S}),info:r({},e,{value:C}),warn:r({},e,{value:L}),error:r({},e,{value:x}),group:r({},e,{value:P}),groupCollapsed:r({},e,{value:$}),groupEnd:r({},e,{value:R})})}D<0&&E("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=i}var p=e?e.displayName||e.name:"",h=p?F(p):"";return"function"==typeof e&&z.set(e,h),h}function q(e,t,r){return H(e,!1)}function B(e,t,r){if(null==e)return"";if("function"==typeof e)return H(e,!(!(n=e.prototype)||!n.isReactComponent));var n;if("string"==typeof e)return F(e);switch(e){case u:return F("Suspense");case f:return F("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case l:return q(e.render);case d:return B(e.type,t,r);case h:return q(e._render);case p:var a=e._payload,o=e._init;try{return B(o(a),t,r)}catch(e){}}return""}z=new N;var W={},K=k.ReactDebugCurrentFrame;function J(e){if(e){var t=e._owner,r=B(e.type,e._source,t?t.type:null);K.setExtraStackFrame(r)}else K.setExtraStackFrame(null)}var V,G,Y,Q=k.ReactCurrentOwner,X=Object.prototype.hasOwnProperty,Z={key:!0,ref:!0,__self:!0,__source:!0};Y={};var ee,te=k.ReactCurrentOwner,re=k.ReactDebugCurrentFrame;function ne(e){if(e){var t=e._owner,r=B(e.type,e._source,t?t.type:null);re.setExtraStackFrame(r)}else re.setExtraStackFrame(null)}function ae(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}function oe(){if(te.current){var e=T(te.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}ee=!1;var ie={};function se(e,t){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var r=function(e){var t=oe();if(!t){var r="string"==typeof e?e:e.displayName||e.name;r&&(t="\n\nCheck the top-level render call using <"+r+">.")}return t}(t);if(!ie[r]){ie[r]=!0;var n="";e&&e._owner&&e._owner!==te.current&&(n=" It was passed a child from "+T(e._owner.type)+"."),ne(e),E('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',r,n),ne(null)}}}function ce(e,t){if("object"==typeof e)if(Array.isArray(e))for(var r=0;r<e.length;r++){var n=e[r];ae(n)&&se(n,t)}else if(ae(e))e._store&&(e._store.validated=!0);else if(e){var a=function(e){if(null===e||"object"!=typeof e)return null;var t=_&&e[_]||e["@@iterator"];return"function"==typeof t?t:null}(e);if("function"==typeof a&&a!==e.entries)for(var o,i=a.call(e);!(o=i.next()).done;)ae(o.value)&&se(o.value,t)}}function le(t,r,a,m,w,_){var k=function(t){return"string"==typeof t||"function"==typeof t||t===e.Fragment||t===i||t===g||t===o||t===u||t===f||t===v||"object"==typeof t&&null!==t&&(t.$$typeof===p||t.$$typeof===d||t.$$typeof===s||t.$$typeof===c||t.$$typeof===l||t.$$typeof===b||t.$$typeof===h||t[0]===y)}(t);if(!k){var j="";(void 0===t||"object"==typeof t&&null!==t&&0===Object.keys(t).length)&&(j+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var O,S=function(e){return void 0!==e?"\n\nCheck your code at "+e.fileName.replace(/^.*[\\\/]/,"")+":"+e.lineNumber+".":""}(w);j+=S||oe(),null===t?O="null":Array.isArray(t)?O="array":void 0!==t&&t.$$typeof===n?(O="<"+(T(t.type)||"Unknown")+" />",j=" Did you accidentally export a JSX literal instead of a component?"):O=typeof t,E("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",O,j)}var C=function(e,t,r,a,o){var i,s={},c=null,l=null;for(i in void 0!==r&&(c=""+r),function(e){if(X.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(t)&&(c=""+t.key),function(e){if(X.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return!1}return void 0!==e.ref}(t)&&(l=t.ref,function(e,t){if("string"==typeof e.ref&&Q.current&&t&&Q.current.stateNode!==t){var r=T(Q.current.type);Y[r]||(E('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',T(Q.current.type),e.ref),Y[r]=!0)}}(t,o)),t)X.call(t,i)&&!Z.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps){var u=e.defaultProps;for(i in u)void 0===s[i]&&(s[i]=u[i])}if(c||l){var f="function"==typeof e?e.displayName||e.name||"Unknown":e;c&&function(e,t){var r=function(){V||(V=!0,E("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"key",{get:r,configurable:!0})}(s,f),l&&function(e,t){var r=function(){G||(G=!0,E("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"ref",{get:r,configurable:!0})}(s,f)}return function(e,t,r,a,o,i,s){var c={$$typeof:n,type:e,key:t,ref:r,props:s,_owner:i,_store:{}};return Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(c,"_self",{configurable:!1,enumerable:!1,writable:!1,value:a}),Object.defineProperty(c,"_source",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}(e,c,l,o,a,Q.current,s)}(t,r,a,w,_);if(null==C)return C;if(k){var L=r.children;if(void 0!==L)if(m)if(Array.isArray(L)){for(var x=0;x<L.length;x++)ce(L[x],t);Object.freeze&&Object.freeze(L)}else E("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ce(L,t)}return t===e.Fragment?function(e){for(var t=Object.keys(e.props),r=0;r<t.length;r++){var n=t[r];if("children"!==n&&"key"!==n){ne(e),E("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",n),ne(null);break}}null!==e.ref&&(ne(e),E("Invalid attribute `ref` supplied to `React.Fragment`."),ne(null))}(C):function(e){var t,r=e.type;if(null!=r&&"string"!=typeof r){if("function"==typeof r)t=r.propTypes;else{if("object"!=typeof r||r.$$typeof!==l&&r.$$typeof!==d)return;t=r.propTypes}if(t){var n=T(r);!function(e,t,r,n,a){var o=Function.call.bind(Object.prototype.hasOwnProperty);for(var i in e)if(o(e,i)){var s=void 0;try{if("function"!=typeof e[i]){var c=Error((n||"React class")+": "+r+" type `"+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[i]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw c.name="Invariant Violation",c}s=e[i](t,i,n,r,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){s=e}!s||s instanceof Error||(J(a),E("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",r,i,typeof s),J(null)),s instanceof Error&&!(s.message in W)&&(W[s.message]=!0,J(a),E("Failed %s type: %s",r,s.message),J(null))}}(t,e.props,"prop",n,e)}else void 0===r.PropTypes||ee||(ee=!0,E("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",T(r)||"Unknown"));"function"!=typeof r.getDefaultProps||r.getDefaultProps.isReactClassApproved||E("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}(C),C}e.jsx=function(e,t,r){return le(e,t,r,!1)},e.jsxs=function(e,t,r){return le(e,t,r,!0)}}()}(we),ie.exports="production"===oe.NODE_ENV?se:we;var _e=re.exports;Object.defineProperty(te,"__esModule",{value:!0});var ke=te.default=void 0,Ee=(0,_e(ne).default)((0,ie.exports.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"}),"Email");ke=te.default=Ee;var je={},Oe=re.exports;Object.defineProperty(je,"__esModule",{value:!0});var Te=je.default=void 0,Se=(0,Oe(ne).default)((0,ie.exports.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}),"OpenInNew");function Ce(e){const[t,r]=s.useState(),[n,a]=s.useState(),{hub:o}=e,{url:i,longLabel:u,shortLabel:d}=o;return s.useEffect((()=>{(async()=>{try{const e=c.openLocation({uri:i,locationType:"UriLocation"}),t=await e.readFile("utf8"),n=new Z(t);r(n)}catch(e){console.error(e),a(e)}})()}),[i]),n?m.default.createElement(l.Card,null,m.default.createElement(l.CardContent,null,m.default.createElement(l.Typography,{color:"error"},`${n}`))):t?m.default.createElement(l.Card,null,m.default.createElement(l.CardHeader,{title:d}),m.default.createElement(l.CardContent,null,m.default.createElement(f.SanitizedHTML,{html:u})),m.default.createElement(l.CardActions,null,m.default.createElement(l.IconButton,{href:`mailto:${t.get("email")}`,rel:"noopener noreferrer",target:"_blank",color:"secondary"},m.default.createElement(ke,null)),t.get("descriptionUrl")?m.default.createElement(l.IconButton,{href:new URL(t.get("descriptionUrl")||"",new URL(i)).href,rel:"noopener noreferrer",target:"_blank"},m.default.createElement(Te,{color:"secondary"})):null)):m.default.createElement(l.LinearProgress,{variant:"query"})}Te=je.default=Se;const Le=u.makeStyles()((e=>({formControl:{minWidth:192,marginLeft:e.spacing(2),marginRight:e.spacing(2)}})));function xe({selectList:e,selectedItem:t,handleSelect:r,label:n,helpText:a}){const{classes:o}=Le();return m.default.createElement(l.FormControl,{className:o.formControl},m.default.createElement(l.InputLabel,null,n),m.default.createElement(l.Select,{value:t,onChange:r,label:a},e.map((e=>{let t,r;return e.name&&(t=e.name,r=`${e.name} (${e.synonyms.join(" ")})`),m.default.createElement(l.MenuItem,{key:r||e,value:t||e},r||e)}))),m.default.createElement(l.FormHelperText,null,a))}function Pe({status:e}){return m.default.createElement(m.default.Fragment,null,m.default.createElement(l.LinearProgress,{variant:"query"}),m.default.createElement(l.Typography,null,e))}function $e({children:e,...t}){return e(t)}const Re=u.makeStyles()((e=>({hubList:{maxHeight:400,overflowY:"auto"},genomeSelector:{marginTop:e.spacing(1)}})));function De({model:e}){const[t,r]=s.useState(),[n,o]=s.useState(),[i,u]=s.useState(""),[d,p]=s.useState(""),[h,y]=s.useState(new Map),[b,g]=s.useState(!1),[v,w]=s.useState(""),{classes:_}=Re();s.useEffect((()=>{const e=new AbortController,{signal:t}=e;return(async()=>{try{if(1!==(await x("https://www.trackhubregistry.org/api/info/ping",{signal:t})).ping)return void r("Registry is not available");const e=await x("https://www.trackhubregistry.org/api/info/assemblies",{signal:t});o(e)}catch(e){a.isAbortException(e)||(console.error(e),r(e))}})(),()=>{e.abort()}}),[]),s.useEffect((()=>{const e=new AbortController,{signal:n}=e;async function o(e){const t=e?new Map:new Map(h),r=Math.floor(h.size/10)+1,a=await async function(e,t={},r={}){const n=Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&");return x(`${e}${n?`?${n}`:""}`,{...r,method:"POST"})}("https://www.trackhubregistry.org/api/search",{page:r,entries_per_page:10},{headers:{"Content-Type":"application/json"},body:JSON.stringify({assembly:d}),signal:n});if(a){for(const e of a.items){if(e.hub.url.startsWith("ftp://"))e.error="JBrowse cannot add connections from FTP sources";else{const t=c.openLocation({uri:e.hub.url,locationType:"UriLocation"});try{await t.stat()}catch(t){e.error=`${t}`}}t.set(`${e.trackdb_id}`,e)}y(t),t.size===a.total_entries&&g(!0)}}return(async()=>{try{t||(d&&!h.size?await o(!0):h.size&&!b&&await o())}catch(e){a.isAbortException(e)||(console.error(e),r(e))}})(),()=>{e.abort()}}),[d,t,h,b]);const k=[m.default.createElement(l.Typography,{key:"heading",variant:"h6"},"The Track Hub Registry")];if(t)return k.push(m.default.createElement(l.Typography,{key:"error",color:"error"},`${t}`)),m.default.createElement("div",null,k);if(!n)return k.push(m.default.createElement(Pe,{key:"queryStatus",status:"Connecting to registry..."})),m.default.createElement("div",null,k);const E=Object.keys(n).sort();if(k.push(m.default.createElement(xe,{key:"speciesSelect",selectList:E,selectedItem:i,handleSelect:e=>{u(e.target.value),p(""),y(new Map),w(""),g(!1)},label:"Species",helpText:"Select a species"})),i){const e=n[i].filter((e=>!("GRCh37"===e.name&&"hg38"===e.synonyms[0])));k.push(m.default.createElement(xe,{key:"assemblySelect",selectList:e,selectedItem:d,handleSelect:e=>{p(e.target.value),y(new Map),w(""),g(!1)},label:"Assembly",helpText:"Select an assembly"}))}return d&&(k.push(m.default.createElement("div",{key:"hubSelect"},m.default.createElement(l.Typography,null,"Select an assembly from our local tracklist if it doesn't match the assembly name on the remote trackhub"),m.default.createElement("br",null),m.default.createElement(l.FormControl,null,m.default.createElement(l.FormLabel,null,"Hubs:"),m.default.createElement("div",{className:_.hubList},m.default.createElement(l.RadioGroup,{value:v,onChange:t=>{const r=t.target.value;w(r),console.log({newHub:r},h),e.target.name.set(h.get(r).hub.shortLabel),e.target.assemblyNames.set([d]),e.target.trackDbId.set(r)}},Array.from(h.values()).filter((({assembly:e})=>e.name===d||e.synonyms.includes(d))).map((e=>{const{error:t,trackdb_id:r,hub:n}=e,{shortLabel:a,longLabel:o}=n;return m.default.createElement($e,{key:r,value:r},(e=>m.default.createElement(l.Tooltip,{title:t||m.default.createElement(f.SanitizedHTML,{html:o}),placement:"left"},m.default.createElement(l.FormControlLabel,{key:r,value:r,label:m.default.createElement(f.SanitizedHTML,{html:a}),disabled:Boolean(t),control:m.default.createElement(l.Radio,null),...e}))))}))))))),b||k.push(m.default.createElement(Pe,{key:"hubStatus",status:"Retrieving hubs"}))),v&&k.push(m.default.createElement(Ce,{key:"hubDetails",hub:h.get(v).hub})),m.default.createElement(m.default.Fragment,null,k)}e.default=class extends h.default{name="TrackHubRegistryPlugin";install(e){e.addConnectionType((()=>new k({name:"TheTrackHubRegistryConnection",configSchema:E,configEditorComponent:De,stateModel:P(e),displayName:"The Track Hub Registry",description:"A hub from The Track Hub Registry",url:"//trackhubregistry.org/"})))}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=jbrowse-plugin-trackhub-registry.umd.production.min.js.map
