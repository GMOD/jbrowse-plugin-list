"use strict";var JBrowsePluginMafViewer=(()=>{var ji=Object.create;var Eo=Object.defineProperty;var zi=Object.getOwnPropertyDescriptor;var Xi=Object.getOwnPropertyNames;var $i=Object.getPrototypeOf,Zi=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(e&&(t=e(e=0)),t);var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),st=(e,t)=>{for(var o in t)Eo(e,o,{get:t[o],enumerable:!0})},zf=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Xi(t))!Zi.call(e,a)&&a!==o&&Eo(e,a,{get:()=>t[a],enumerable:!(r=zi(t,a))||r.enumerable});return e};var A=(e,t,o)=>(o=e!=null?ji($i(e)):{},zf(t||!e||!e.__esModule?Eo(o,"default",{value:e,enumerable:!0}):o,e)),ep=e=>zf(Eo({},"__esModule",{value:!0}),e);var $f=P((Gc,Xf)=>{Xf.exports=JBrowseExports["@jbrowse/core/Plugin"]});var Le=P((Uc,en)=>{en.exports=JBrowseExports["@jbrowse/core/pluggableElementTypes"]});var Nr=P((Jc,tn)=>{tn.exports=JBrowseExports["@jbrowse/core/data_adapters/BaseAdapter"]});var X=P((Vc,on)=>{on.exports=JBrowseExports["@jbrowse/core/util"]});var Hr=P((Kc,rn)=>{rn.exports=JBrowseExports["@jbrowse/core/util/io"]});var Wr=P((Yc,an)=>{an.exports=JBrowseExports["@jbrowse/core/util/rxjs"]});var Te=P((qc,fn)=>{fn.exports=JBrowseExports["mobx-state-tree"]});var He=P((rh,Bn)=>{Bn.exports=JBrowseExports["@jbrowse/core/configuration"]});var Q=P((dh,bn)=>{bn.exports=JBrowseExports.react});var Fe=P((sh,Qn)=>{Qn.exports=JBrowseExports["@jbrowse/core/ui"]});var We=P((uh,Fn)=>{Fn.exports=JBrowseExports["@mui/material"]});var re=P((ih,Dn)=>{Dn.exports=JBrowseExports["mobx-react"]});var De=P((ph,vn)=>{vn.exports=JBrowseExports["tss-react/mui"]});var pe=P((xh,Pn)=>{Pn.exports=JBrowseExports["react/jsx-runtime"]});var _o=P((Th,qn)=>{qn.exports=JBrowseExports["react-dom"]});var Yl=P(v=>{"use strict";var V=typeof Symbol=="function"&&Symbol.for,da=V?Symbol.for("react.element"):60103,sa=V?Symbol.for("react.portal"):60106,er=V?Symbol.for("react.fragment"):60107,tr=V?Symbol.for("react.strict_mode"):60108,or=V?Symbol.for("react.profiler"):60114,rr=V?Symbol.for("react.provider"):60109,ar=V?Symbol.for("react.context"):60110,ua=V?Symbol.for("react.async_mode"):60111,fr=V?Symbol.for("react.concurrent_mode"):60111,nr=V?Symbol.for("react.forward_ref"):60112,lr=V?Symbol.for("react.suspense"):60113,wm=V?Symbol.for("react.suspense_list"):60120,dr=V?Symbol.for("react.memo"):60115,sr=V?Symbol.for("react.lazy"):60116,Cm=V?Symbol.for("react.block"):60121,Rm=V?Symbol.for("react.fundamental"):60117,ym=V?Symbol.for("react.responder"):60118,Bm=V?Symbol.for("react.scope"):60119;function ne(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case da:switch(e=e.type,e){case ua:case fr:case er:case or:case tr:case lr:return e;default:switch(e=e&&e.$$typeof,e){case ar:case nr:case sr:case dr:case rr:return e;default:return t}}case sa:return t}}}function Kl(e){return ne(e)===fr}v.AsyncMode=ua;v.ConcurrentMode=fr;v.ContextConsumer=ar;v.ContextProvider=rr;v.Element=da;v.ForwardRef=nr;v.Fragment=er;v.Lazy=sr;v.Memo=dr;v.Portal=sa;v.Profiler=or;v.StrictMode=tr;v.Suspense=lr;v.isAsyncMode=function(e){return Kl(e)||ne(e)===ua};v.isConcurrentMode=Kl;v.isContextConsumer=function(e){return ne(e)===ar};v.isContextProvider=function(e){return ne(e)===rr};v.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===da};v.isForwardRef=function(e){return ne(e)===nr};v.isFragment=function(e){return ne(e)===er};v.isLazy=function(e){return ne(e)===sr};v.isMemo=function(e){return ne(e)===dr};v.isPortal=function(e){return ne(e)===sa};v.isProfiler=function(e){return ne(e)===or};v.isStrictMode=function(e){return ne(e)===tr};v.isSuspense=function(e){return ne(e)===lr};v.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===er||e===fr||e===or||e===tr||e===lr||e===wm||typeof e=="object"&&e!==null&&(e.$$typeof===sr||e.$$typeof===dr||e.$$typeof===rr||e.$$typeof===ar||e.$$typeof===nr||e.$$typeof===Rm||e.$$typeof===ym||e.$$typeof===Bm||e.$$typeof===Cm)};v.typeOf=ne});var jl=P((wT,ql)=>{"use strict";ql.exports=Yl()});var od=P((CT,td)=>{"use strict";var ia=jl(),Im={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Om={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Em={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Zl={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},pa={};pa[ia.ForwardRef]=Em;pa[ia.Memo]=Zl;function zl(e){return ia.isMemo(e)?Zl:pa[e.$$typeof]||Im}var bm=Object.defineProperty,Qm=Object.getOwnPropertyNames,Xl=Object.getOwnPropertySymbols,Fm=Object.getOwnPropertyDescriptor,Dm=Object.getPrototypeOf,$l=Object.prototype;function ed(e,t,o){if(typeof t!="string"){if($l){var r=Dm(t);r&&r!==$l&&ed(e,r,o)}var a=Qm(t);Xl&&(a=a.concat(Xl(t)));for(var f=zl(e),n=zl(t),l=0;l<a.length;++l){var d=a[l];if(!Om[d]&&!(o&&o[d])&&!(n&&n[d])&&!(f&&f[d])){var s=Fm(t,d);try{bm(e,d,s)}catch{}}}}return e}td.exports=ed});var xd=P((eS,md)=>{md.exports=JBrowseExports["@mui/material/styles"]});var Fd,zm,Ia,Dd=M(()=>{"use strict";Fd=A(Q()),zm=({x:e,y:t,width:o,height:r,color:a="rgb(255,255,255,0.5)"})=>Fd.default.createElement("rect",{x:e,y:t,width:o,height:r,fill:a}),Ia=zm});var le,kd,vd,Xm,Md,Pd=M(()=>{"use strict";le=A(Q()),kd=A(re()),vd={pointerEvents:"all",cursor:"pointer",strokeWidth:8,stroke:"transparent"},Xm=(0,kd.observer)(function({model:e}){let{rowHeight:t,treeAreaWidth:o,hierarchy:r,showBranchLen:a,nodeDescendantNames:f}=e,n=(0,le.useCallback)(()=>{e.setHighlightedRowNames(void 0)},[e]),l=(0,le.useMemo)(()=>{let d=new Map;if(r)for(let s of r.descendants())d.set(s,()=>{e.setHighlightedRowNames(f.get(s),{x:s.x,y:s.y})});return d},[e,r,f,o]);return le.default.createElement(le.default.Fragment,null,r?[...r.links()].map(d=>{let{source:s,target:u}=d,i=s.x,p=u.x,m=a?u.len:u.y,h=a?s.len:s.y;return le.default.createElement(le.default.Fragment,{key:`${o}-${i}-${p}-${m}-${h}`},le.default.createElement("line",{stroke:"black",x1:h,y1:i,x2:h,y2:p}),le.default.createElement("line",{stroke:"black",x1:h,y1:p,x2:m,y2:p}),le.default.createElement("line",{x1:h,y1:i,x2:h,y2:p,style:vd,onMouseEnter:l.get(s),onMouseLeave:n}),le.default.createElement("line",{x1:h,y1:p,x2:m,y2:p,style:vd,onMouseEnter:l.get(u),onMouseLeave:n}))}):null)}),Md=Xm});var Je,Ld,$m,Nd,Hd=M(()=>{"use strict";Je=A(Q()),Ld=A(re());Dd();Pd();$m=(0,Ld.observer)(function({model:e}){let{labelWidth:t,canDisplayLabel:o,totalHeight:r,treeWidth:a,sidebarWidth:f,samples:n=[],rowHeight:l,svgFontSize:d}=e,s=Math.min(20,l);return Je.default.createElement(Je.default.Fragment,null,Je.default.createElement(Ia,{y:0,x:0,width:f,height:r}),Je.default.createElement(Md,{model:e}),Je.default.createElement("g",{transform:`translate(${a+5},0)`},n.map((u,i)=>Je.default.createElement(Ia,{key:`${u.id}-${i}`,y:i*l,x:0,width:t+5,height:s,color:u.color})),o?n.map((u,i)=>Je.default.createElement("text",{key:`${u.id}-${i}`,dominantBaseline:"middle",fontSize:d,x:2,y:i*l+l/2},u.label)):null))}),Nd=$m});var Oa=P((WS,Wd)=>{Wd.exports=JBrowseExports.mobx});var de,Gd,Ea,_d,Ud,Jd,Vd,Zm,ex,Kd,Yd=M(()=>{"use strict";de=A(Q()),Gd=A(Fe()),Ea=A(X()),_d=A(Te()),Ud=A(Oa()),Jd=A(re()),Vd=A(De()),Zm=(0,Vd.makeStyles)()({resizeHandle:{position:"absolute",top:0,height:"100%",width:4,zIndex:1001,background:"transparent",cursor:"col-resize","&:hover":{background:"rgba(0,0,0,0.2)"}}}),ex=(0,Jd.observer)(function({children:e,model:t,exportSVG:o}){let{classes:r}=Zm(),a=(0,de.useRef)(null);if((0,de.useEffect)(()=>{let f=a.current?.getContext("2d");return f?(0,Ud.autorun)(()=>{if((0,_d.isAlive)(t)){let{totalHeight:n,leafMap:l,rowHeight:d,highlightedRowNames:s,hoveredTreeNode:u}=t,{width:i}=(0,Ea.getContainingView)(t);if(f.resetTransform(),f.clearRect(0,0,i,n),s){f.fillStyle="rgba(255,165,0,0.2)";let p=d/2;for(let m of s){let h=l.get(m);h&&f.fillRect(0,h.x-p,i,d)}u&&(f.fillStyle="rgba(255,165,0,0.8)",f.beginPath(),f.arc(u.y,u.x,4,0,2*Math.PI),f.fill(),f.strokeStyle="rgba(255,140,0,1)",f.lineWidth=1,f.stroke())}}}):void 0},[t]),o)return de.default.createElement(de.default.Fragment,null,e);{let{totalHeight:f,treeWidth:n,hierarchy:l}=t,{width:d}=(0,Ea.getContainingView)(t);return de.default.createElement(de.default.Fragment,null,de.default.createElement("svg",{style:{position:"absolute",userSelect:"none",top:0,left:0,pointerEvents:"none",height:f,width:d}},e),de.default.createElement("canvas",{ref:a,width:d,height:f,style:{position:"absolute",top:0,left:0,width:d,height:f,zIndex:1e3,pointerEvents:"none"}}),l?de.default.createElement("div",{onMouseDown:s=>{s.stopPropagation()}},de.default.createElement(Gd.ResizeHandle,{onDrag:s=>{t.setTreeAreaWidth(Math.max(20,t.treeAreaWidth+s))},className:r.resizeHandle,style:{left:n},vertical:!0})):null)}}),Kd=ex});var ba,qd,tx,gr,Qa=M(()=>{"use strict";ba=A(Q()),qd=A(re());Hd();Yd();tx=(0,qd.observer)(function(e){let{model:t}=e;return ba.default.createElement(Kd,{...e},ba.default.createElement(Nd,{model:t}))}),gr=tx});var rs=P((ZS,os)=>{os.exports=JBrowseExports["@jbrowse/core/util/tracks"]});var gs=P((Fw,hs)=>{"use strict";hs.exports=function e(t,o){if(t===o)return!0;if(t&&o&&typeof t=="object"&&typeof o=="object"){if(t.constructor!==o.constructor)return!1;var r,a,f;if(Array.isArray(t)){if(r=t.length,r!=o.length)return!1;for(a=r;a--!==0;)if(!e(t[a],o[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if(f=Object.keys(t),r=f.length,r!==Object.keys(o).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(o,f[a]))return!1;for(a=r;a--!==0;){var n=f[a];if(!e(t[n],o[n]))return!1}return!0}return t!==t&&o!==o}});var Cs={};st(Cs,{default:()=>Tx});var se,Ts,Ae,Ss,ws,hx,gx,Tx,Rs=M(()=>{"use strict";se=A(Q()),Ts=A(Fe()),Ae=A(We()),Ss=A(re()),ws=A(De()),hx=(0,ws.makeStyles)()({root:{width:500}}),gx=(0,Ss.observer)(function(e){let{model:t,handleClose:o}=e,{classes:r}=hx(),[a,f]=(0,se.useState)(`${t.rowHeight}`),[n,l]=(0,se.useState)(`${t.rowProportion}`);return se.default.createElement(Ts.Dialog,{open:!0,onClose:o,title:"Set row height"},se.default.createElement("form",{onSubmit:d=>{d.preventDefault(),t.setRowProportion(+n),t.setRowHeight(+a),o()}},se.default.createElement(Ae.DialogContent,{className:r.root},se.default.createElement(Ae.Typography,null,"Set row height and the proportion of the row height to use for drawing each row"),se.default.createElement(Ae.TextField,{value:a,helperText:"Enter row height",autoFocus:!0,onChange:d=>{f(d.target.value)}}),se.default.createElement(Ae.TextField,{value:n,helperText:"Enter row proportion",onChange:d=>{l(d.target.value)}}),se.default.createElement(Ae.DialogActions,null,se.default.createElement(Ae.Button,{variant:"contained",color:"primary",type:"submit"},"Submit"),se.default.createElement(Ae.Button,{variant:"contained",color:"secondary",onClick:()=>{o()}},"Cancel")))))}),Tx=gx});var Bs={};st(Bs,{renderSvg:()=>Sx});async function Sx(e,t,o){let{height:r,id:a}=e,{offsetPx:f,width:n}=(0,ys.getContainingView)(e),l=`mafclip-${a}`;return Ee.default.createElement(Ee.default.Fragment,null,Ee.default.createElement("defs",null,Ee.default.createElement("clipPath",{id:l},Ee.default.createElement("rect",{x:0,y:0,width:n,height:r}))),Ee.default.createElement("g",{clipPath:`url(#${l})`},Ee.default.createElement("g",{id:"snpcov"},await o(t)),Ee.default.createElement("g",{transform:`translate(${Math.max(-f,0)})`},Ee.default.createElement(gr,{model:e,exportSVG:!0}))))}var Ee,ys,Is=M(()=>{"use strict";Ee=A(Q()),ys=A(X());Qa()});var Su=P((xR,Tu)=>{Tu.exports=JBrowseExports["react-dom/client"]});var Wu=P((Ky,Hu)=>{Hu.exports=JBrowseExports["@jbrowse/core/pluggableElementTypes/WidgetType"]});var zu=P((Zy,ju)=>{ju.exports=JBrowseExports["@mui/material/utils"]});var J,Qe=M(()=>{"use client";J=A(zu(),1)});var Xu,Ff,$u=M(()=>{"use client";Qe();Xu=A(pe(),1),Ff=(0,J.createSvgIcon)((0,Xu.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy")});var Zu,Df,ei=M(()=>{"use client";Qe();Zu=A(pe(),1),Df=(0,J.createSvgIcon)((0,Zu.jsx)("path",{d:"M18 23H4c-1.1 0-2-.9-2-2V7h2v14h14zM15 1H8c-1.1 0-1.99.9-1.99 2L6 17c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V7zm1.5 14h-6v-2h6zm0-6h-2v2h-2V9h-2V7h2V5h2v2h2z"}),"Difference")});var ti,vf,oi=M(()=>{"use client";Qe();ti=A(pe(),1),vf=(0,J.createSvgIcon)((0,ti.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")});var ri,kf,ai=M(()=>{"use client";Qe();ri=A(pe(),1),kf=(0,J.createSvgIcon)((0,ri.jsx)("path",{d:"M16.56 8.94 7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12M5.21 10 10 5.21 14.79 10zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5M2 20h20v4H2z"}),"FormatColorFill")});var fi,Mf,ni=M(()=>{"use client";Qe();fi=A(pe(),1),Mf=(0,J.createSvgIcon)((0,fi.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown")});var li,Pf,di=M(()=>{"use client";Qe();li=A(pe(),1),Pf=(0,J.createSvgIcon)((0,li.jsx)("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}),"Label")});var si,Lf,ui=M(()=>{"use client";Qe();si=A(pe(),1),Lf=(0,J.createSvgIcon)((0,si.jsx)("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"}),"PlaylistAdd")});var ii,Nf,pi=M(()=>{"use client";Qe();ii=A(pe(),1),Nf=(0,J.createSvgIcon)((0,ii.jsx)("path",{d:"M14 17H4v2h10zm6-8H4v2h16zM4 15h16v-2H4zM4 5v2h16V5z"}),"Subject")});var mi,Hf,xi=M(()=>{"use client";Qe();mi=A(pe(),1),Hf=(0,J.createSvgIcon)((0,mi.jsx)("path",{d:"M21 8H3V4h18zm0 2H3v4h18zm0 6H3v4h18z"}),"TableRows")});var ci=M(()=>{$u();ei();oi();ai();ni();di();ui();pi();xi()});var kr,Wf=M(()=>{"use strict";kr="bold 12px monospace"});function Gf({samples:e,maxLabelLength:t}){let o=(0,Ai.useTheme)(),r=(0,Lt.useRef)(null),a=t*12+10,f=e.length*16;return(0,Lt.useEffect)(()=>{let n=r.current;if(!n)return;let l=n.getContext("2d");if(!l)return;let d=window.devicePixelRatio||1;n.width=a*d,n.height=f*d,n.style.width=`${a}px`,n.style.height=`${f}px`,l.scale(d,d),l.fillStyle=o.palette.background.paper,l.fillRect(0,0,a,f),l.font=kr,l.textBaseline="top";for(let s=0;s<e.length;s++){let u=e[s],i=s*16;l.fillStyle=o.palette.text.secondary,l.fillText(u.label??u.id,2,i+2)}},[e,a,f,o]),Lt.default.createElement("canvas",{ref:r,style:{display:"block"}})}var Lt,Ai,hi=M(()=>{"use strict";Lt=A(Q()),Ai=A(We());Wf()});function gi(e){return e.palette.bases}function _f(e,t){let o=gi(t);if(!o)switch(e.toUpperCase()){case"A":return"#6dbf6d";case"C":return"#6c6cff";case"G":return"#ffb347";case"T":case"U":return"#ff6b6b";default:return t.palette.grey[500]}switch(e.toUpperCase()){case"A":return o.A.main;case"C":return o.C.main;case"G":return o.G.main;case"T":case"U":return o.T.main;default:return t.palette.grey[500]}}function Ti(e,t){let o=gi(t);if(!o)switch(e.toUpperCase()){case"A":case"C":case"T":case"U":return"#fff";case"G":return"#000";default:return t.palette.common.white}switch(e.toUpperCase()){case"A":return o.A.contrastText;case"C":return o.C.contrastText;case"G":return o.G.contrastText;case"T":case"U":return o.T.contrastText;default:return t.palette.common.white}}var Si=M(()=>{"use strict"});function Uf({samples:e,sequences:t,colorBackground:o,hoveredCol:r,onHover:a,onLeave:f}){let n=(0,Mr.useTheme)(),l=(0,qe.useRef)(null),d=t[0]?.length||0,s=d*12,u=e.length*16;(0,qe.useEffect)(()=>{let p=l.current;if(!p)return;let m=p.getContext("2d");if(!m)return;let h=window.devicePixelRatio||1;p.width=s*h,p.height=u*h,p.style.width=`${s}px`,p.style.height=`${u}px`,m.scale(h,h),m.fillStyle=n.palette.background.paper,m.fillRect(0,0,s,u),m.font=kr,m.textBaseline="top";for(let c=0;c<e.length;c++){let w=t[c]||"",T=c*16;for(let g=0;g<w.length;g++){let x=w[g],C=g*12;if(o&&x!=="-"&&x!=="."&&(m.fillStyle=_f(x,n),m.fillRect(C,T,12,16)),g===r){let R=n.palette.highlight?.main??"#FFB11D";m.fillStyle=(0,Mr.alpha)(R,.5),m.fillRect(C,T,12,16)}x==="-"?m.fillStyle=n.palette.grey[400]:x==="."?m.fillStyle=n.palette.grey[500]:o?m.fillStyle=Ti(x,n):m.fillStyle=_f(x,n),m.fillText(x,C+2,T+2)}}},[e,t,s,u,r,o,n]);let i=(0,qe.useCallback)(p=>{let m=l.current;if(!m)return;let h=m.getBoundingClientRect(),c=p.clientX-h.left,w=p.clientY-h.top,T=Math.floor(c/12),g=Math.floor(w/16),x=T>=0&&T<d?T:void 0,C=g>=0&&g<e.length?g:void 0;a(x,C,p.clientX,p.clientY)},[d,e.length,a]);return qe.default.createElement("canvas",{ref:l,style:{display:"block"},onMouseMove:i,onMouseLeave:f})}var qe,Mr,wi=M(()=>{"use strict";qe=A(Q()),Mr=A(We());Si();Wf()});function Jf({x:e,y:t,sample:o,base:r,genomicPos:a}){let{classes:f}=Dc(),n=r!==void 0&&a===void 0;return Nt.default.createElement("div",{className:f.tooltip,style:{left:e+12,top:t+12}},Nt.default.createElement("div",null,Nt.default.createElement("strong",null,o.label)),r&&Nt.default.createElement("div",null,"Base: ",r,a!==void 0?` | Pos: ${(a+1).toLocaleString("en-US")}`:null),n&&Nt.default.createElement("div",{className:f.insertion},"Insertion (not in reference)"))}var Nt,Ci,Dc,Ri=M(()=>{"use strict";Nt=A(Q()),Ci=A(De()),Dc=(0,Ci.makeStyles)()(e=>({tooltip:{position:"fixed",pointerEvents:"none",zIndex:1e3,backgroundColor:e.palette.grey[800],color:e.palette.common.white,padding:"4px 8px",borderRadius:4,fontSize:12,whiteSpace:"nowrap"},insertion:{color:e.palette.warning.light,fontStyle:"italic"}}))});function yi(e,t){if(!e||!t)return 0;let o=e.findIndex(r=>r.id===t);return o===-1?0:o}function Bi(e,t){let o=[],r=t;for(let a of e)a==="-"?o.push(void 0):(o.push(r),r++);return o}var Ii=M(()=>{"use strict"});var N,Oi,Ei,vc,kc,bi,Qi=M(()=>{"use strict";N=A(Q()),Oi=A(re()),Ei=A(De());hi();wi();Ri();Ii();vc=(0,Ei.makeStyles)()(e=>({container:{border:`1px solid ${e.palette.divider}`,borderRadius:e.shape.borderRadius,maxHeight:400,backgroundColor:e.palette.background.paper,display:"flex",overflow:"hidden",position:"relative"},labelsContainer:{flexShrink:0,borderRight:`1px solid ${e.palette.divider}`,backgroundColor:e.palette.background.paper,overflowY:"auto",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},sequenceContainer:{flex:1,overflow:"auto"}})),kc=(0,Oi.observer)(function({model:t,sequences:o,colorBackground:r,showSampleNames:a}){let{classes:f}=vc(),n=(0,N.useRef)(null),l=(0,N.useRef)(null),{samples:d,regions:s}=t,[u,i]=N.default.useState(),[p,m]=N.default.useState(),[h,c]=N.default.useState(),w=(0,N.useMemo)(()=>d?Math.max(...d.map(S=>(S.label??S.id).length)):0,[d]),T=(0,N.useMemo)(()=>{if(!s)return[];let S=s[0];if(!S)return[];let B=yi(d,S.assemblyName),k=o[B]||"";return Bi(k,S.start)},[o,s,d]);(0,N.useEffect)(()=>{let S=n.current,B=l.current;if(!S||!B)return;let k=()=>{S.scrollTop=B.scrollTop};return B.addEventListener("scroll",k),()=>{B.removeEventListener("scroll",k)}},[]);let g=(0,N.useCallback)((S,B,k,E)=>{if(s)if(i(S),m(B),c({x:k,y:E}),S!==void 0){let H=T[S],ue=s[0];H!==void 0&&ue?t.setHoverHighlight({refName:ue.refName,start:H,end:H+1,assemblyName:ue.assemblyName}):t.setHoverHighlight(void 0)}else t.setHoverHighlight(void 0)},[T,t,s]),x=(0,N.useCallback)(()=>{i(void 0),m(void 0),c(void 0),t.setHoverHighlight(void 0)},[t]);if(!d||!s||o.length===0)return N.default.createElement("div",null,"No sequence data");let C=p!==void 0?d[p]:void 0,y=p!==void 0&&u!==void 0?o[p]?.[u]:void 0,R=u!==void 0?T[u]:void 0;return N.default.createElement("div",{className:f.container},a&&N.default.createElement("div",{ref:n,className:f.labelsContainer},N.default.createElement(Gf,{samples:d,maxLabelLength:w})),N.default.createElement("div",{ref:l,className:f.sequenceContainer},N.default.createElement(Uf,{samples:d,sequences:o,colorBackground:r,hoveredCol:u,onHover:g,onLeave:x})),h&&C&&N.default.createElement(Jf,{x:h.x,y:h.y,sample:C,base:y,genomicPos:R}))}),bi=kc});async function Fi(e,t,o){try{await navigator.clipboard.writeText(e),t?.()}catch(r){console.error(r),o?.(r)}}function Di(e,t,o,r){try{let a=URL.createObjectURL(new Blob([e],{type:"text/plain"})),f=document.createElement("a");f.href=a,f.download=t,document.body.append(f),f.click(),f.remove(),URL.revokeObjectURL(a),o?.()}catch(a){console.error(a),r?.(a)}}var vi=M(()=>{"use strict"});var Pi={};st(Pi,{default:()=>Lc});var G,Ht,je,Bo,ki,Mi,Mc,Pc,Lc,Li=M(()=>{"use strict";G=A(Q()),Ht=A(Fe()),je=A(X()),Bo=A(We()),ki=A(re()),Mi=A(De());ci();Qi();vi();Mc=(0,Mi.makeStyles)()(e=>({root:{padding:e.spacing(2)},controls:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:e.spacing(1),marginBottom:e.spacing(2)}})),Pc=(0,ki.observer)(function({model:t}){let{classes:o}=Mc(),r=(0,je.getSession)(t),{adapterConfig:a,samples:f,regions:n}=t,[l,d]=(0,je.useLocalStorage)("mafSequenceWidget-showAllLetters",!0),[s,u]=(0,je.useLocalStorage)("mafSequenceWidget-includeInsertions",!1),[i,p]=(0,je.useLocalStorage)("mafSequenceWidget-singleLineFormat",!1),[m,h]=(0,je.useLocalStorage)("mafSequenceWidget-colorBackground",!0),[c,w]=(0,je.useLocalStorage)("mafSequenceWidget-showSampleNames",!0),[T,g]=(0,G.useState)([]),[x,C]=(0,G.useState)(""),[y,R]=(0,G.useState)(!0),[S,B]=(0,G.useState)();(0,G.useEffect)(()=>{!a||!f||!n||(async()=>{try{R(!0),B(void 0);let{rpcManager:E}=r,H=await E.call("MafSequenceWidget","MafGetSequences",{sessionId:"MafSequenceWidget",adapterConfig:a,samples:f,showAllLetters:l,includeInsertions:s,regions:n});g(H);let ue;if(i){let ge=Math.max(...f.map(ie=>(ie.label??ie.id).length));ue=H.map((ie,ze)=>{let Re=f[ze],Gt=Re.label??Re.id,Y=" ".repeat(ge-Gt.length+2);return`>${Gt}${Y}${ie}`}).join(`
`)}else ue=H.map((ge,ie)=>{let ze=f[ie];return`>${ze.label??ze.id}
${ge}`}).join(`
`);C(ue)}catch(E){console.error(E),B(E)}finally{R(!1)}})()},[a,f,n,l,s,i,r]);let k=x?x.length>5e6:!1;return!a||!f||!n?G.default.createElement(Bo.Paper,{className:o.root},G.default.createElement("div",null,"No sequence data available")):G.default.createElement(Bo.Paper,{className:o.root},G.default.createElement("div",{className:o.controls},G.default.createElement(Ht.CascadingMenuButton,{menuItems:[{label:"Show all letters",icon:Nf,type:"radio",checked:l,onClick:()=>{d(!0)}},{label:"Show only differences",icon:Df,type:"radio",checked:!l,onClick:()=>{d(!1)}},{label:"Include insertions",icon:Lf,type:"checkbox",checked:s,onClick:()=>{u(!s)}},{label:"Single line format",icon:Hf,type:"checkbox",checked:i,onClick:()=>{p(!i)}},{label:"Color background",icon:kf,type:"checkbox",checked:m,onClick:()=>{h(!m)}},{label:"Show sample names",icon:Pf,type:"checkbox",checked:c,onClick:()=>{w(!c)}},{type:"divider"},{label:"Copy to clipboard",icon:Ff,disabled:y||!x,onClick:()=>{Fi(x,()=>{r.notify("Sequence copied to clipboard","info")},E=>{r.notifyError(`${E}`,E)}).catch(E=>{console.error(E)})}},{label:"Download as FASTA",icon:vf,disabled:y||!x,onClick:()=>{Di(x,"sequence.fasta",()=>{r.notify("Sequence downloaded","info")},E=>{r.notifyError(`${E}`,E)})}}],ButtonComponent:E=>G.default.createElement(Bo.Button,{...E,variant:"contained",size:"small",endIcon:G.default.createElement(Mf,null)},"Actions")})),S?G.default.createElement(Ht.ErrorMessage,{error:S}):G.default.createElement(G.default.Fragment,null,y?G.default.createElement(Ht.LoadingEllipses,null):k?G.default.createElement("div",null,"Reference sequence too large to display, use the Download button"):G.default.createElement(bi,{model:t,sequences:T,singleLineFormat:i,includeInsertions:s,colorBackground:m,showSampleNames:c})))}),Lc=Pc});var Hc={};st(Hc,{default:()=>Lr});var qi=A($f());var Zf="1.4.5";var En=A(Le());var wn=A(Nr()),Jt=A(X()),Cn=A(Hr()),Rn=A(Wr()),yn=A(Te());var Gr=function(e,t){return Gr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(o[a]=r[a])},Gr(e,t)};function _t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Gr(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}function _r(e){var t=typeof Symbol=="function"&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ut(e,t){var o=typeof Symbol=="function"&&e[Symbol.iterator];if(!o)return e;var r=o.call(e),a,f=[],n;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)f.push(a.value)}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return f}function it(e,t,o){if(o||arguments.length===2)for(var r=0,a=t.length,f;r<a;r++)(f||!(r in t))&&(f||(f=Array.prototype.slice.call(t,0,r)),f[r]=t[r]);return e.concat(f||Array.prototype.slice.call(t))}function ye(e){return typeof e=="function"}function bo(e){var t=function(r){Error.call(r),r.stack=new Error().stack},o=e(t);return o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,o}var Qo=bo(function(e){return function(o){e(this),this.message=o?o.length+` errors occurred during unsubscription:
`+o.map(function(r,a){return a+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=o}});function Ur(e,t){if(e){var o=e.indexOf(t);0<=o&&e.splice(o,1)}}var Fo=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,o,r,a,f;if(!this.closed){this.closed=!0;var n=this._parentage;if(n)if(this._parentage=null,Array.isArray(n))try{for(var l=_r(n),d=l.next();!d.done;d=l.next()){var s=d.value;s.remove(this)}}catch(c){t={error:c}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(t)throw t.error}}else n.remove(this);var u=this.initialTeardown;if(ye(u))try{u()}catch(c){f=c instanceof Qo?c.errors:[c]}var i=this._finalizers;if(i){this._finalizers=null;try{for(var p=_r(i),m=p.next();!m.done;m=p.next()){var h=m.value;try{nn(h)}catch(c){f=f??[],c instanceof Qo?f=it(it([],ut(f)),ut(c.errors)):f.push(c)}}}catch(c){r={error:c}}finally{try{m&&!m.done&&(a=p.return)&&a.call(p)}finally{if(r)throw r.error}}}if(f)throw new Qo(f)}},e.prototype.add=function(t){var o;if(t&&t!==this)if(this.closed)nn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(o=this._finalizers)!==null&&o!==void 0?o:[]).push(t)}},e.prototype._hasParent=function(t){var o=this._parentage;return o===t||Array.isArray(o)&&o.includes(t)},e.prototype._addParent=function(t){var o=this._parentage;this._parentage=Array.isArray(o)?(o.push(t),o):o?[o,t]:t},e.prototype._removeParent=function(t){var o=this._parentage;o===t?this._parentage=null:Array.isArray(o)&&Ur(o,t)},e.prototype.remove=function(t){var o=this._finalizers;o&&Ur(o,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})();var fA=Fo.EMPTY;function ln(e){return e instanceof Fo||e&&"closed"in e&&ye(e.remove)&&ye(e.add)&&ye(e.unsubscribe)}function nn(e){ye(e)?e():e.unsubscribe()}var Ne={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var pt={setTimeout:function(e,t){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var a=pt.delegate;return a?.setTimeout?a.setTimeout.apply(a,it([e,t],ut(o))):setTimeout.apply(void 0,it([e,t],ut(o)))},clearTimeout:function(e){var t=pt.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function dn(e){pt.setTimeout(function(){var t=Ne.onUnhandledError;if(t)t(e);else throw e})}function Jr(){}var sn=(function(){return Vr("C",void 0,void 0)})();function un(e){return Vr("E",void 0,e)}function pn(e){return Vr("N",e,void 0)}function Vr(e,t,o){return{kind:e,value:t,error:o}}var Kr=null;function mn(e){Ne.useDeprecatedSynchronousErrorHandling&&Kr&&(Kr.errorThrown=!0,Kr.error=e)}var jr=(function(e){_t(t,e);function t(o){var r=e.call(this)||this;return r.isStopped=!1,o?(r.destination=o,ln(o)&&o.add(r)):r.destination=fp,r}return t.create=function(o,r,a){return new zr(o,r,a)},t.prototype.next=function(o){this.isStopped?qr(pn(o),this):this._next(o)},t.prototype.error=function(o){this.isStopped?qr(un(o),this):(this.isStopped=!0,this._error(o))},t.prototype.complete=function(){this.isStopped?qr(sn,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(o){this.destination.next(o)},t.prototype._error=function(o){try{this.destination.error(o)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(Fo);var op=Function.prototype.bind;function Yr(e,t){return op.call(e,t)}var rp=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var o=this.partialObserver;if(o.next)try{o.next(t)}catch(r){Do(r)}},e.prototype.error=function(t){var o=this.partialObserver;if(o.error)try{o.error(t)}catch(r){Do(r)}else Do(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(o){Do(o)}},e})(),zr=(function(e){_t(t,e);function t(o,r,a){var f=e.call(this)||this,n;if(ye(o)||!o)n={next:o??void 0,error:r??void 0,complete:a??void 0};else{var l;f&&Ne.useDeprecatedNextContext?(l=Object.create(o),l.unsubscribe=function(){return f.unsubscribe()},n={next:o.next&&Yr(o.next,l),error:o.error&&Yr(o.error,l),complete:o.complete&&Yr(o.complete,l)}):n=o}return f.destination=new rp(n),f}return t})(jr);function Do(e){Ne.useDeprecatedSynchronousErrorHandling?mn(e):dn(e)}function ap(e){throw e}function qr(e,t){var o=Ne.onStoppedNotification;o&&pt.setTimeout(function(){return o(e,t)})}var fp={closed:!0,next:Jr,error:ap,complete:Jr};function np(e){return ye(e?.lift)}function vo(e){return function(t){if(np(t))return t.lift(function(o){try{return e(o,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function xn(e,t,o,r,a){return new lp(e,t,o,r,a)}var lp=(function(e){_t(t,e);function t(o,r,a,f,n,l){var d=e.call(this,o)||this;return d.onFinalize=n,d.shouldUnsubscribe=l,d._next=r?function(s){try{r(s)}catch(u){o.error(u)}}:e.prototype._next,d._error=f?function(s){try{f(s)}catch(u){o.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=a?function(){try{a()}catch(s){o.error(s)}finally{this.unsubscribe()}}:e.prototype._complete,d}return t.prototype.unsubscribe=function(){var o;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((o=this.onFinalize)===null||o===void 0||o.call(this))}},t})(jr);var cn=bo(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function Xe(e,t){var o=typeof t=="object";return new Promise(function(r,a){var f=new zr({next:function(n){r(n),f.unsubscribe()},error:a,complete:function(){o?r(t.defaultValue):a(new cn)}});e.subscribe(f)})}function An(e,t,o,r,a){return function(f,n){var l=o,d=t,s=0;f.subscribe(xn(n,function(u){var i=s++;d=l?e(d,u,i):(l=!0,u),r&&n.next(d)},a&&(function(){l&&n.next(d),n.complete()})))}}function hn(e,t){return vo(An(e,t,arguments.length>=2,!1,!0))}var dp=function(e,t){return e.push(t),e};function $e(){return vo(function(e,t){hn(dp,[])(e).subscribe(t)})}function Ut(e){let t=[],o={},r=e.split(/\s*(;|\(|\)|,|:)\s*/);for(let a=0;a<r.length;a++){let f=r[a],n={};switch(f){case"(":o.children=[n],t.push(o),o=n;break;case",":t.at(-1)?.children.push(n),o=n;break;case")":o=t.pop();break;case":":break;default:{let l=r[a-1];l===")"||l==="("||l===","?o.name=f:l===":"&&(o.length=Number.parseFloat(f))}}}return o}function sp(e){return typeof e[0]=="string"}function mt(e){return sp(e)?e.map(t=>({id:t,label:t,color:void 0})):e}function gn(e){let t=e.indexOf(".");if(t===-1)return{assemblyName:e,chr:""};let o=e.indexOf(".",t+1);if(o===-1)return{assemblyName:e.slice(0,t),chr:e.slice(t+1)};let r=e.slice(t+1,o);return r.length>0&&!Number.isNaN(+r)?{assemblyName:e.slice(0,o),chr:e.slice(o+1)}:{assemblyName:e.slice(0,t),chr:e.slice(t+1)}}function Tn(e){let t=e.indexOf(".");return t===-1?{assemblyName:e,chr:""}:{assemblyName:e.slice(0,t),chr:e.slice(t+1)}}function Sn(e,t,o,r){let a;if(t&&(a=e[t],a)||o&&(a=e[o],a)||r&&(a=e[r],a))return a.seq}var Vt=class extends wn.BaseFeatureDataAdapter{setupP;async setup(){if(!this.getSubAdapter)throw new Error("no getSubAdapter available");return{adapter:(await this.getSubAdapter({...(0,yn.getSnapshot)(this.config),type:"BigBedAdapter"})).dataAdapter}}async setupPre(){return this.setupP||(this.setupP=this.setup().catch(t=>{throw this.setupP=void 0,t})),this.setupP}async getRefNames(){let{adapter:t}=await this.setup();return t.getRefNames()}async getHeader(){let{adapter:t}=await this.setup();return t.getHeader()}getFeatures(t,o){let{statusCallback:r=()=>{}}=o||{},a=/ +/;return(0,Rn.ObservableCreate)(async f=>{let{adapter:n}=await this.setup(),l=await(0,Jt.updateStatus)("Downloading alignments",r,()=>Xe(n.getFeatures(t).pipe($e())));await(0,Jt.updateStatus)("Processing alignments",r,()=>{for(let d of l){let u=d.get("mafBlock").split(";"),i=0;for(let w of u)w.startsWith("s")&&i++;let p=new Array(i),m={},h=0,c;for(let w of u)if(w.startsWith("s")){let T=w.split(a),g=T[6],x=T[1];p[h]=g,c===void 0&&(c=g);let{assemblyName:C,chr:y}=Tn(x);m[C]={chr:y,start:+T[2],srcSize:+T[3],strand:T[4]==="+"?1:-1,unknown:+T[5],seq:g},h++}f.next(new Jt.SimpleFeature({id:d.id(),data:{start:d.get("start"),end:d.get("end"),refName:d.get("refName"),seq:c,alignments:m}}))}}),f.complete()})}async getSamples(t){let o=this.getConf("nhLocation"),r=o.uri==="/path/to/my.nh"?void 0:await(0,Cn.openLocation)(o).readFile("utf8");return{samples:mt(this.getConf("samples")),tree:r?Ut(r):void 0}}freeResources(){}};var In=A(He());var up=(0,In.ConfigurationSchema)("BigMafAdapter",{samples:{type:"frozen",description:"string[] or {id:string,label:string,color?:string}[]",defaultValue:[]},bigBedLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bb",locationType:"UriLocation"}},nhLocation:{type:"fileLocation",description:"newick tree",defaultValue:{uri:"/path/to/my.nh",locationType:"UriLocation"}}},{explicitlyTyped:!0}),On=up;function Xr(e){return e.addAdapterType(()=>new En.AdapterType({name:"BigMafAdapter",AdapterClass:Vt,configSchema:On}))}var Ns=A(Le());var ce=A(Q()),Xd=A(Fe()),Ve=A(X()),$d=A(We()),Zd=A(re());var ko=A(Q()),kn=A(De()),ip=(0,kn.makeStyles)()({cursor:{pointerEvents:"none"}}),pp=({width:e,height:t,scrollTop:o,mouseX:r,mouseY:a})=>{let{classes:f}=ip();return ko.default.createElement("svg",{className:f.cursor,width:e,height:t,style:{position:"absolute",top:o}},ko.default.createElement("line",{x1:0,x2:e,y1:a,y2:a,stroke:"black"}),ko.default.createElement("line",{x1:r,x2:r,y1:0,y2:t,stroke:"black"}))},Mn=pp;var Ba=A(Q()),Bd=A(Fe());var wa=A(pe(),1);var I=A(Q(),1);function Mo(){return typeof window<"u"}function Ge(e){return $r(e)?(e.nodeName||"").toLowerCase():"#document"}function $(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ie(e){var t;return(t=($r(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function $r(e){return Mo()?e instanceof Node||e instanceof $(e).Node:!1}function q(e){return Mo()?e instanceof Element||e instanceof $(e).Element:!1}function ae(e){return Mo()?e instanceof HTMLElement||e instanceof $(e).HTMLElement:!1}function Kt(e){return!Mo()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof $(e).ShadowRoot}var mp=new Set(["inline","contents"]);function ct(e){let{overflow:t,overflowX:o,overflowY:r,display:a}=fe(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+o)&&!mp.has(a)}var xp=new Set(["table","td","th"]);function Ln(e){return xp.has(Ge(e))}var cp=[":popover-open",":modal"];function Yt(e){return cp.some(t=>{try{return e.matches(t)}catch{return!1}})}var Ap=["transform","translate","scale","rotate","perspective"],hp=["transform","translate","scale","rotate","perspective","filter"],gp=["paint","layout","strict","content"];function Po(e){let t=qt(),o=q(e)?fe(e):e;return Ap.some(r=>o[r]?o[r]!=="none":!1)||(o.containerType?o.containerType!=="normal":!1)||!t&&(o.backdropFilter?o.backdropFilter!=="none":!1)||!t&&(o.filter?o.filter!=="none":!1)||hp.some(r=>(o.willChange||"").includes(r))||gp.some(r=>(o.contain||"").includes(r))}function Nn(e){let t=Be(e);for(;ae(t)&&!_e(t);){if(Po(t))return t;if(Yt(t))return null;t=Be(t)}return null}function qt(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}var Tp=new Set(["html","body","#document"]);function _e(e){return Tp.has(Ge(e))}function fe(e){return $(e).getComputedStyle(e)}function jt(e){return q(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Be(e){if(Ge(e)==="html")return e;let t=e.assignedSlot||e.parentNode||Kt(e)&&e.host||Ie(e);return Kt(t)?t.host:t}function Hn(e){let t=Be(e);return _e(t)?e.ownerDocument?e.ownerDocument.body:e.body:ae(t)&&ct(t)?t:Hn(t)}function xt(e,t,o){var r;t===void 0&&(t=[]),o===void 0&&(o=!0);let a=Hn(e),f=a===((r=e.ownerDocument)==null?void 0:r.body),n=$(a);if(f){let l=Lo(n);return t.concat(n,n.visualViewport||[],ct(a)?a:[],l&&o?xt(l):[])}return t.concat(a,xt(a,[],o))}function Lo(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}var $t=A(Q(),1),Jn=A(Q(),1);var No=Math.min,Ze=Math.max,zt=Math.round;var Se=e=>({x:e,y:e});function Wn(e,t){return typeof e=="function"?e(t):e}function Ho(e){return e.split("-")[0]}function Zr(e){return e.split("-")[1]}function Gn(e){return e==="x"?"y":"x"}function _n(e){return e==="y"?"height":"width"}var Sp=new Set(["top","bottom"]);function Wo(e){return Sp.has(Ho(e))?"y":"x"}function Un(e){return Gn(Wo(e))}function Xt(e){let{x:t,y:o,width:r,height:a}=e;return{width:r,height:a,top:o,left:t,right:t+r,bottom:o+a,x:t,y:o}}function Vn(e,t){if(!e||!t)return!1;let o=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(o&&Kt(o)){let r=t;for(;r;){if(e===r)return!0;r=r.parentNode||r.host}}return!1}function Kn(e){return"composedPath"in e?e.composedPath()[0]:e.target}function Yn(e,t){let o=["mouse","pen"];return t||o.push("",void 0),o.includes(e)}var wp=typeof document<"u",Cp=function(){},Zt=wp?Jn.useLayoutEffect:Cp,Rp={...$t};var yp=Rp.useInsertionEffect,Bp=yp||(e=>e());function Go(e){let t=$t.useRef(()=>{});return Bp(()=>{t.current=e}),$t.useCallback(function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t.current==null?void 0:t.current(...r)},[])}var aa=A(pe(),1);var Tl=A(_o(),1);function jn(e,t,o){let{reference:r,floating:a}=e,f=Wo(t),n=Un(t),l=_n(n),d=Ho(t),s=f==="y",u=r.x+r.width/2-a.width/2,i=r.y+r.height/2-a.height/2,p=r[l]/2-a[l]/2,m;switch(d){case"top":m={x:u,y:r.y-a.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:i};break;case"left":m={x:r.x-a.width,y:i};break;default:m={x:r.x,y:r.y}}switch(Zr(t)){case"start":m[n]-=p*(o&&s?-1:1);break;case"end":m[n]+=p*(o&&s?-1:1);break}return m}var zn=async(e,t,o)=>{let{placement:r="bottom",strategy:a="absolute",middleware:f=[],platform:n}=o,l=f.filter(Boolean),d=await(n.isRTL==null?void 0:n.isRTL(t)),s=await n.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:i}=jn(s,r,d),p=r,m={},h=0;for(let c=0;c<l.length;c++){let{name:w,fn:T}=l[c],{x:g,y:x,data:C,reset:y}=await T({x:u,y:i,initialPlacement:r,placement:p,strategy:a,middlewareData:m,rects:s,platform:n,elements:{reference:e,floating:t}});u=g??u,i=x??i,m={...m,[w]:{...m[w],...C}},y&&h<=50&&(h++,typeof y=="object"&&(y.placement&&(p=y.placement),y.rects&&(s=y.rects===!0?await n.getElementRects({reference:e,floating:t,strategy:a}):y.rects),{x:u,y:i}=jn(s,p,d)),c=-1)}return{x:u,y:i,placement:p,strategy:a,middlewareData:m}};var Ip=new Set(["left","top"]);async function Op(e,t){let{placement:o,platform:r,elements:a}=e,f=await(r.isRTL==null?void 0:r.isRTL(a.floating)),n=Ho(o),l=Zr(o),d=Wo(o)==="y",s=Ip.has(n)?-1:1,u=f&&d?-1:1,i=Wn(t,e),{mainAxis:p,crossAxis:m,alignmentAxis:h}=typeof i=="number"?{mainAxis:i,crossAxis:0,alignmentAxis:null}:{mainAxis:i.mainAxis||0,crossAxis:i.crossAxis||0,alignmentAxis:i.alignmentAxis};return l&&typeof h=="number"&&(m=l==="end"?h*-1:h),d?{x:m*u,y:p*s}:{x:p*s,y:m*u}}var Xn=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var o,r;let{x:a,y:f,placement:n,middlewareData:l}=t,d=await Op(t,e);return n===((o=l.offset)==null?void 0:o.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:a+d.x,y:f+d.y,data:{...d,placement:n}}}}};function tl(e){let t=fe(e),o=parseFloat(t.width)||0,r=parseFloat(t.height)||0,a=ae(e),f=a?e.offsetWidth:o,n=a?e.offsetHeight:r,l=zt(o)!==f||zt(r)!==n;return l&&(o=f,r=n),{width:o,height:r,$:l}}function ol(e){return q(e)?e:e.contextElement}function At(e){let t=ol(e);if(!ae(t))return Se(1);let o=t.getBoundingClientRect(),{width:r,height:a,$:f}=tl(t),n=(f?zt(o.width):o.width)/r,l=(f?zt(o.height):o.height)/a;return(!n||!Number.isFinite(n))&&(n=1),(!l||!Number.isFinite(l))&&(l=1),{x:n,y:l}}var Ep=Se(0);function rl(e){let t=$(e);return!qt()||!t.visualViewport?Ep:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function bp(e,t,o){return t===void 0&&(t=!1),!o||t&&o!==$(e)?!1:t}function eo(e,t,o,r){t===void 0&&(t=!1),o===void 0&&(o=!1);let a=e.getBoundingClientRect(),f=ol(e),n=Se(1);t&&(r?q(r)&&(n=At(r)):n=At(e));let l=bp(f,o,r)?rl(f):Se(0),d=(a.left+l.x)/n.x,s=(a.top+l.y)/n.y,u=a.width/n.x,i=a.height/n.y;if(f){let p=$(f),m=r&&q(r)?$(r):r,h=p,c=Lo(h);for(;c&&r&&m!==h;){let w=At(c),T=c.getBoundingClientRect(),g=fe(c),x=T.left+(c.clientLeft+parseFloat(g.paddingLeft))*w.x,C=T.top+(c.clientTop+parseFloat(g.paddingTop))*w.y;d*=w.x,s*=w.y,u*=w.x,i*=w.y,d+=x,s+=C,h=$(c),c=Lo(h)}}return Xt({width:u,height:i,x:d,y:s})}function Uo(e,t){let o=jt(e).scrollLeft;return t?t.left+o:eo(Ie(e)).left+o}function al(e,t){let o=e.getBoundingClientRect(),r=o.left+t.scrollLeft-Uo(e,o),a=o.top+t.scrollTop;return{x:r,y:a}}function Qp(e){let{elements:t,rect:o,offsetParent:r,strategy:a}=e,f=a==="fixed",n=Ie(r),l=t?Yt(t.floating):!1;if(r===n||l&&f)return o;let d={scrollLeft:0,scrollTop:0},s=Se(1),u=Se(0),i=ae(r);if((i||!i&&!f)&&((Ge(r)!=="body"||ct(n))&&(d=jt(r)),ae(r))){let m=eo(r);s=At(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}let p=n&&!i&&!f?al(n,d):Se(0);return{width:o.width*s.x,height:o.height*s.y,x:o.x*s.x-d.scrollLeft*s.x+u.x+p.x,y:o.y*s.y-d.scrollTop*s.y+u.y+p.y}}function Fp(e){return Array.from(e.getClientRects())}function Dp(e){let t=Ie(e),o=jt(e),r=e.ownerDocument.body,a=Ze(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),f=Ze(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),n=-o.scrollLeft+Uo(e),l=-o.scrollTop;return fe(r).direction==="rtl"&&(n+=Ze(t.clientWidth,r.clientWidth)-a),{width:a,height:f,x:n,y:l}}var $n=25;function vp(e,t){let o=$(e),r=Ie(e),a=o.visualViewport,f=r.clientWidth,n=r.clientHeight,l=0,d=0;if(a){f=a.width,n=a.height;let u=qt();(!u||u&&t==="fixed")&&(l=a.offsetLeft,d=a.offsetTop)}let s=Uo(r);if(s<=0){let u=r.ownerDocument,i=u.body,p=getComputedStyle(i),m=u.compatMode==="CSS1Compat"&&parseFloat(p.marginLeft)+parseFloat(p.marginRight)||0,h=Math.abs(r.clientWidth-i.clientWidth-m);h<=$n&&(f-=h)}else s<=$n&&(f+=s);return{width:f,height:n,x:l,y:d}}var kp=new Set(["absolute","fixed"]);function Mp(e,t){let o=eo(e,!0,t==="fixed"),r=o.top+e.clientTop,a=o.left+e.clientLeft,f=ae(e)?At(e):Se(1),n=e.clientWidth*f.x,l=e.clientHeight*f.y,d=a*f.x,s=r*f.y;return{width:n,height:l,x:d,y:s}}function Zn(e,t,o){let r;if(t==="viewport")r=vp(e,o);else if(t==="document")r=Dp(Ie(e));else if(q(t))r=Mp(t,o);else{let a=rl(e);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Xt(r)}function fl(e,t){let o=Be(e);return o===t||!q(o)||_e(o)?!1:fe(o).position==="fixed"||fl(o,t)}function Pp(e,t){let o=t.get(e);if(o)return o;let r=xt(e,[],!1).filter(l=>q(l)&&Ge(l)!=="body"),a=null,f=fe(e).position==="fixed",n=f?Be(e):e;for(;q(n)&&!_e(n);){let l=fe(n),d=Po(n);!d&&l.position==="fixed"&&(a=null),(f?!d&&!a:!d&&l.position==="static"&&!!a&&kp.has(a.position)||ct(n)&&!d&&fl(e,n))?r=r.filter(u=>u!==n):a=l,n=Be(n)}return t.set(e,r),r}function Lp(e){let{element:t,boundary:o,rootBoundary:r,strategy:a}=e,n=[...o==="clippingAncestors"?Yt(t)?[]:Pp(t,this._c):[].concat(o),r],l=n[0],d=n.reduce((s,u)=>{let i=Zn(t,u,a);return s.top=Ze(i.top,s.top),s.right=No(i.right,s.right),s.bottom=No(i.bottom,s.bottom),s.left=Ze(i.left,s.left),s},Zn(t,l,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function Np(e){let{width:t,height:o}=tl(e);return{width:t,height:o}}function Hp(e,t,o){let r=ae(t),a=Ie(t),f=o==="fixed",n=eo(e,!0,f,t),l={scrollLeft:0,scrollTop:0},d=Se(0);function s(){d.x=Uo(a)}if(r||!r&&!f)if((Ge(t)!=="body"||ct(a))&&(l=jt(t)),r){let m=eo(t,!0,f,t);d.x=m.x+t.clientLeft,d.y=m.y+t.clientTop}else a&&s();f&&!r&&a&&s();let u=a&&!r&&!f?al(a,l):Se(0),i=n.left+l.scrollLeft-d.x-u.x,p=n.top+l.scrollTop-d.y-u.y;return{x:i,y:p,width:n.width,height:n.height}}function ea(e){return fe(e).position==="static"}function el(e,t){if(!ae(e)||fe(e).position==="fixed")return null;if(t)return t(e);let o=e.offsetParent;return Ie(e)===o&&(o=o.ownerDocument.body),o}function nl(e,t){let o=$(e);if(Yt(e))return o;if(!ae(e)){let a=Be(e);for(;a&&!_e(a);){if(q(a)&&!ea(a))return a;a=Be(a)}return o}let r=el(e,t);for(;r&&Ln(r)&&ea(r);)r=el(r,t);return r&&_e(r)&&ea(r)&&!Po(r)?o:r||Nn(e)||o}var Wp=async function(e){let t=this.getOffsetParent||nl,o=this.getDimensions,r=await o(e.floating);return{reference:Hp(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Gp(e){return fe(e).direction==="rtl"}var ll={convertOffsetParentRelativeRectToViewportRelativeRect:Qp,getDocumentElement:Ie,getClippingRect:Lp,getOffsetParent:nl,getElementRects:Wp,getClientRects:Fp,getDimensions:Np,getScale:At,isElement:q,isRTL:Gp};var dl=Xn;var ta=(e,t,o)=>{let r=new Map,a={platform:ll,...o},f={...a.platform,_c:r};return zn(e,t,{...a,platform:f})};var _=A(Q(),1),ul=A(Q(),1),il=A(_o(),1),_p=typeof document<"u",Up=function(){},Jo=_p?ul.useLayoutEffect:Up;function Vo(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let o,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(o=e.length,o!==t.length)return!1;for(r=o;r--!==0;)if(!Vo(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),o=a.length,o!==Object.keys(t).length)return!1;for(r=o;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=o;r--!==0;){let f=a[r];if(!(f==="_owner"&&e.$$typeof)&&!Vo(e[f],t[f]))return!1}return!0}return e!==e&&t!==t}function pl(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function sl(e,t){let o=pl(e);return Math.round(t*o)/o}function oa(e){let t=_.useRef(e);return Jo(()=>{t.current=e}),t}function ml(e){e===void 0&&(e={});let{placement:t="bottom",strategy:o="absolute",middleware:r=[],platform:a,elements:{reference:f,floating:n}={},transform:l=!0,whileElementsMounted:d,open:s}=e,[u,i]=_.useState({x:0,y:0,strategy:o,placement:t,middlewareData:{},isPositioned:!1}),[p,m]=_.useState(r);Vo(p,r)||m(r);let[h,c]=_.useState(null),[w,T]=_.useState(null),g=_.useCallback(Y=>{Y!==R.current&&(R.current=Y,c(Y))},[]),x=_.useCallback(Y=>{Y!==S.current&&(S.current=Y,T(Y))},[]),C=f||h,y=n||w,R=_.useRef(null),S=_.useRef(null),B=_.useRef(u),k=d!=null,E=oa(d),H=oa(a),ue=oa(s),ge=_.useCallback(()=>{if(!R.current||!S.current)return;let Y={placement:t,strategy:o,middleware:p};H.current&&(Y.platform=H.current),ta(R.current,S.current,Y).then(Oo=>{let dt={...Oo,isPositioned:ue.current!==!1};ie.current&&!Vo(B.current,dt)&&(B.current=dt,il.flushSync(()=>{i(dt)}))})},[p,t,o,H,ue]);Jo(()=>{s===!1&&B.current.isPositioned&&(B.current.isPositioned=!1,i(Y=>({...Y,isPositioned:!1})))},[s]);let ie=_.useRef(!1);Jo(()=>(ie.current=!0,()=>{ie.current=!1}),[]),Jo(()=>{if(C&&(R.current=C),y&&(S.current=y),C&&y){if(E.current)return E.current(C,y,ge);ge()}},[C,y,ge,E,k]);let ze=_.useMemo(()=>({reference:R,floating:S,setReference:g,setFloating:x}),[g,x]),Re=_.useMemo(()=>({reference:C,floating:y}),[C,y]),Gt=_.useMemo(()=>{let Y={position:o,left:0,top:0};if(!Re.floating)return Y;let Oo=sl(Re.floating,u.x),dt=sl(Re.floating,u.y);return l?{...Y,transform:"translate("+Oo+"px, "+dt+"px)",...pl(Re.floating)>=1.5&&{willChange:"transform"}}:{position:o,left:Oo,top:dt}},[o,l,Re.floating,u.x,u.y]);return _.useMemo(()=>({...u,update:ge,refs:ze,elements:Re,floatingStyles:Gt}),[u,ge,ze,Re,Gt])}var Ko=(e,t)=>({...dl(e),options:[e,t]});var Vp="data-floating-ui-focusable",xl="active",cl="selected",Kp="ArrowLeft",Yp="ArrowRight",qp="ArrowUp",jp="ArrowDown";var zp=[Kp,Yp],Xp=[qp,jp],jg=[...zp,...Xp];var $p={...I},Al=!1,Zp=0,hl=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Zp++;function em(){let[e,t]=I.useState(()=>Al?hl():void 0);return Zt(()=>{e==null&&t(hl())},[]),I.useEffect(()=>{Al=!0},[]),e}var tm=$p.useId,om=tm||em;function rm(){let e=new Map;return{emit(t,o){var r;(r=e.get(t))==null||r.forEach(a=>a(o))},on(t,o){e.has(t)||e.set(t,new Set),e.get(t).add(o)},off(t,o){var r;(r=e.get(t))==null||r.delete(o)}}}var am=I.createContext(null),fm=I.createContext(null),nm=()=>{var e;return((e=I.useContext(am))==null?void 0:e.id)||null},lm=()=>I.useContext(fm);function dm(e,t){let o=null,r=null,a=!1;return{contextElement:e||void 0,getBoundingClientRect(){var f;let n=e?.getBoundingClientRect()||{width:0,height:0,x:0,y:0},l=t.axis==="x"||t.axis==="both",d=t.axis==="y"||t.axis==="both",s=["mouseenter","mousemove"].includes(((f=t.dataRef.current.openEvent)==null?void 0:f.type)||"")&&t.pointerType!=="touch",u=n.width,i=n.height,p=n.x,m=n.y;return o==null&&t.x&&l&&(o=n.x-t.x),r==null&&t.y&&d&&(r=n.y-t.y),p-=o||0,m-=r||0,u=0,i=0,!a||s?(u=t.axis==="y"?n.width:0,i=t.axis==="x"?n.height:0,p=l&&t.x!=null?t.x:p,m=d&&t.y!=null?t.y:m):a&&!s&&(i=t.axis==="x"?n.height:i,u=t.axis==="y"?n.width:u),a=!0,{width:u,height:i,x:p,y:m,top:m,right:p+u,bottom:m+i,left:p}}}}function gl(e){return e!=null&&e.clientX!=null}function Sl(e,t){t===void 0&&(t={});let{open:o,dataRef:r,elements:{floating:a,domReference:f},refs:n}=e,{enabled:l=!0,axis:d="both",x:s=null,y:u=null}=t,i=I.useRef(!1),p=I.useRef(null),[m,h]=I.useState(),[c,w]=I.useState([]),T=Go((R,S)=>{i.current||r.current.openEvent&&!gl(r.current.openEvent)||n.setPositionReference(dm(f,{x:R,y:S,axis:d,dataRef:r,pointerType:m}))}),g=Go(R=>{s!=null||u!=null||(o?p.current||w([]):T(R.clientX,R.clientY))}),x=Yn(m)?a:o,C=I.useCallback(()=>{if(!x||!l||s!=null||u!=null)return;let R=$(a);function S(B){let k=Kn(B);Vn(a,k)?(R.removeEventListener("mousemove",S),p.current=null):T(B.clientX,B.clientY)}if(!r.current.openEvent||gl(r.current.openEvent)){R.addEventListener("mousemove",S);let B=()=>{R.removeEventListener("mousemove",S),p.current=null};return p.current=B,B}n.setPositionReference(f)},[x,l,s,u,a,r,n,f,T]);I.useEffect(()=>C(),[C,c]),I.useEffect(()=>{l&&!a&&(i.current=!1)},[l,a]),I.useEffect(()=>{!l&&o&&(i.current=!0)},[l,o]),Zt(()=>{l&&(s!=null||u!=null)&&(i.current=!1,T(s,u))},[l,s,u,T]);let y=I.useMemo(()=>{function R(S){let{pointerType:B}=S;h(B)}return{onPointerDown:R,onPointerEnter:R,onMouseMove:g,onMouseEnter:g}},[g]);return I.useMemo(()=>l?{reference:y}:{},[l,y])}function sm(e){let{open:t=!1,onOpenChange:o,elements:r}=e,a=om(),f=I.useRef({}),[n]=I.useState(()=>rm()),l=nm()!=null,[d,s]=I.useState(r.reference),u=Go((m,h,c)=>{f.current.openEvent=m?h:void 0,n.emit("openchange",{open:m,event:h,reason:c,nested:l}),o?.(m,h,c)}),i=I.useMemo(()=>({setPositionReference:s}),[]),p=I.useMemo(()=>({reference:d||r.reference||null,floating:r.floating||null,domReference:r.reference}),[d,r.reference,r.floating]);return I.useMemo(()=>({dataRef:f,open:t,onOpenChange:u,elements:p,events:n,floatingId:a,refs:i}),[t,u,p,n,a,i])}function wl(e){e===void 0&&(e={});let{nodeId:t}=e,o=sm({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||o,a=r.elements,[f,n]=I.useState(null),[l,d]=I.useState(null),u=a?.domReference||f,i=I.useRef(null),p=lm();Zt(()=>{u&&(i.current=u)},[u]);let m=ml({...e,elements:{...a,...l&&{reference:l}}}),h=I.useCallback(x=>{let C=q(x)?{getBoundingClientRect:()=>x.getBoundingClientRect(),getClientRects:()=>x.getClientRects(),contextElement:x}:x;d(C),m.refs.setReference(C)},[m.refs]),c=I.useCallback(x=>{(q(x)||x===null)&&(i.current=x,n(x)),(q(m.refs.reference.current)||m.refs.reference.current===null||x!==null&&!q(x))&&m.refs.setReference(x)},[m.refs]),w=I.useMemo(()=>({...m.refs,setReference:c,setPositionReference:h,domReference:i}),[m.refs,c,h]),T=I.useMemo(()=>({...m.elements,domReference:u}),[m.elements,u]),g=I.useMemo(()=>({...m,...r,refs:w,elements:T,nodeId:t}),[m,w,T,t,r]);return Zt(()=>{r.dataRef.current.floatingContext=g;let x=p?.nodesRef.current.find(C=>C.id===t);x&&(x.context=g)}),I.useMemo(()=>({...m,context:g,refs:w,elements:T}),[m,w,T,g])}function ra(e,t,o){let r=new Map,a=o==="item",f=e;if(a&&e){let{[xl]:n,[cl]:l,...d}=e;f=d}return{...o==="floating"&&{tabIndex:-1,[Vp]:""},...f,...t.map(n=>{let l=n?n[o]:null;return typeof l=="function"?e?l(e):null:l}).concat(e).reduce((n,l)=>(l&&Object.entries(l).forEach(d=>{let[s,u]=d;if(!(a&&[xl,cl].includes(s)))if(s.indexOf("on")===0){if(r.has(s)||r.set(s,[]),typeof u=="function"){var i;(i=r.get(s))==null||i.push(u),n[s]=function(){for(var p,m=arguments.length,h=new Array(m),c=0;c<m;c++)h[c]=arguments[c];return(p=r.get(s))==null?void 0:p.map(w=>w(...h)).find(w=>w!==void 0)}}}else n[s]=u}),n),{})}}function Cl(e){e===void 0&&(e=[]);let t=e.map(l=>l?.reference),o=e.map(l=>l?.floating),r=e.map(l=>l?.item),a=I.useCallback(l=>ra(l,e,"reference"),t),f=I.useCallback(l=>ra(l,e,"floating"),o),n=I.useCallback(l=>ra(l,e,"item"),r);return I.useMemo(()=>({getReferenceProps:a,getFloatingProps:f,getItemProps:n}),[a,f,n])}var Et=A(We(),1);var xe=A(Q()),uo=A(Q());var um=!1;function im(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function pm(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Rl=(function(){function e(o){var r=this;this._insertTag=function(a){var f;r.tags.length===0?r.insertionPoint?f=r.insertionPoint.nextSibling:r.prepend?f=r.container.firstChild:f=r.before:f=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,f),r.tags.push(a)},this.isSpeedy=o.speedy===void 0?!um:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(pm(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var f=im(a);try{f.insertRule(r,f.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e})();var j="-ms-",to="-moz-",D="-webkit-",Yo="comm",ht="rule",gt="decl";var yl="@import";var qo="@keyframes";var Bl="@layer";var Il=Math.abs,et=String.fromCharCode,Ol=Object.assign;function El(e,t){return W(e,0)^45?(((t<<2^W(e,0))<<2^W(e,1))<<2^W(e,2))<<2^W(e,3):0}function jo(e){return e.trim()}function fa(e,t){return(e=t.exec(e))?e[0]:e}function F(e,t,o){return e.replace(t,o)}function oo(e,t){return e.indexOf(t)}function W(e,t){return e.charCodeAt(t)|0}function Ue(e,t,o){return e.slice(t,o)}function ee(e){return e.length}function Tt(e){return e.length}function St(e,t){return t.push(e),e}function na(e,t){return e.map(t).join("")}var zo=1,wt=1,bl=0,te=0,U=0,Rt="";function ro(e,t,o,r,a,f,n){return{value:e,root:t,parent:o,type:r,props:a,children:f,line:zo,column:wt,length:n,return:""}}function yt(e,t){return Ol(ro("",null,null,"",null,null,0),e,{length:-e.length},t)}function Ql(){return U}function Fl(){return U=te>0?W(Rt,--te):0,wt--,U===10&&(wt=1,zo--),U}function oe(){return U=te<bl?W(Rt,te++):0,wt++,U===10&&(wt=1,zo++),U}function me(){return W(Rt,te)}function ao(){return te}function Bt(e,t){return Ue(Rt,e,t)}function Ct(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Xo(e){return zo=wt=1,bl=ee(Rt=e),te=0,[]}function $o(e){return Rt="",e}function It(e){return jo(Bt(te-1,la(e===91?e+2:e===40?e+1:e)))}function Dl(e){for(;(U=me())&&U<33;)oe();return Ct(e)>2||Ct(U)>3?"":" "}function vl(e,t){for(;--t&&oe()&&!(U<48||U>102||U>57&&U<65||U>70&&U<97););return Bt(e,ao()+(t<6&&me()==32&&oe()==32))}function la(e){for(;oe();)switch(U){case e:return te;case 34:case 39:e!==34&&e!==39&&la(U);break;case 40:e===41&&la(e);break;case 92:oe();break}return te}function kl(e,t){for(;oe()&&e+U!==57;)if(e+U===84&&me()===47)break;return"/*"+Bt(t,te-1)+"*"+et(e===47?e:oe())}function Ml(e){for(;!Ct(me());)oe();return Bt(e,te)}function Nl(e){return $o(Zo("",null,null,null,[""],e=Xo(e),0,[0],e))}function Zo(e,t,o,r,a,f,n,l,d){for(var s=0,u=0,i=n,p=0,m=0,h=0,c=1,w=1,T=1,g=0,x="",C=a,y=f,R=r,S=x;w;)switch(h=g,g=oe()){case 40:if(h!=108&&W(S,i-1)==58){oo(S+=F(It(g),"&","&\f"),"&\f")!=-1&&(T=-1);break}case 34:case 39:case 91:S+=It(g);break;case 9:case 10:case 13:case 32:S+=Dl(h);break;case 92:S+=vl(ao()-1,7);continue;case 47:switch(me()){case 42:case 47:St(mm(kl(oe(),ao()),t,o),d);break;default:S+="/"}break;case 123*c:l[s++]=ee(S)*T;case 125*c:case 59:case 0:switch(g){case 0:case 125:w=0;case 59+u:T==-1&&(S=F(S,/\f/g,"")),m>0&&ee(S)-i&&St(m>32?Ll(S+";",r,o,i-1):Ll(F(S," ","")+";",r,o,i-2),d);break;case 59:S+=";";default:if(St(R=Pl(S,t,o,s,u,a,l,x,C=[],y=[],i),f),g===123)if(u===0)Zo(S,t,R,R,C,f,i,l,y);else switch(p===99&&W(S,3)===110?100:p){case 100:case 108:case 109:case 115:Zo(e,R,R,r&&St(Pl(e,R,R,0,0,a,l,x,a,C=[],i),y),a,y,i,l,r?C:y);break;default:Zo(S,R,R,R,[""],y,0,l,y)}}s=u=m=0,c=T=1,x=S="",i=n;break;case 58:i=1+ee(S),m=h;default:if(c<1){if(g==123)--c;else if(g==125&&c++==0&&Fl()==125)continue}switch(S+=et(g),g*c){case 38:T=u>0?1:(S+="\f",-1);break;case 44:l[s++]=(ee(S)-1)*T,T=1;break;case 64:me()===45&&(S+=It(oe())),p=me(),u=i=ee(x=S+=Ml(ao())),g++;break;case 45:h===45&&ee(S)==2&&(c=0)}}return f}function Pl(e,t,o,r,a,f,n,l,d,s,u){for(var i=a-1,p=a===0?f:[""],m=Tt(p),h=0,c=0,w=0;h<r;++h)for(var T=0,g=Ue(e,i+1,i=Il(c=n[h])),x=e;T<m;++T)(x=jo(c>0?p[T]+" "+g:F(g,/&\f/g,p[T])))&&(d[w++]=x);return ro(e,t,o,a===0?ht:l,d,s,u)}function mm(e,t,o){return ro(e,t,o,Yo,et(Ql()),Ue(e,2,-2),0)}function Ll(e,t,o,r){return ro(e,t,o,gt,Ue(e,0,r),Ue(e,r+1,-1),r)}function tt(e,t){for(var o="",r=Tt(e),a=0;a<r;a++)o+=t(e[a],a,e,t)||"";return o}function Hl(e,t,o,r){switch(e.type){case Bl:if(e.children.length)break;case yl:case gt:return e.return=e.return||e.value;case Yo:return"";case qo:return e.return=e.value+"{"+tt(e.children,r)+"}";case ht:e.value=e.props.join(",")}return ee(o=tt(e.children,r))?e.return=e.value+"{"+o+"}":""}function Wl(e){var t=Tt(e);return function(o,r,a,f){for(var n="",l=0;l<t;l++)n+=e[l](o,r,a,f)||"";return n}}function Gl(e){return function(t){t.root||(t=t.return)&&e(t)}}function _l(e){var t=Object.create(null);return function(o){return t[o]===void 0&&(t[o]=e(o)),t[o]}}var xm=function(t,o,r){for(var a=0,f=0;a=f,f=me(),a===38&&f===12&&(o[r]=1),!Ct(f);)oe();return Bt(t,te)},cm=function(t,o){var r=-1,a=44;do switch(Ct(a)){case 0:a===38&&me()===12&&(o[r]=1),t[r]+=xm(te-1,o,r);break;case 2:t[r]+=It(a);break;case 4:if(a===44){t[++r]=me()===58?"&\f":"",o[r]=t[r].length;break}default:t[r]+=et(a)}while(a=oe());return t},Am=function(t,o){return $o(cm(Xo(t),o))},Ul=new WeakMap,hm=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var o=t.value,r=t.parent,a=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&o.charCodeAt(0)!==58&&!Ul.get(r))&&!a){Ul.set(t,!0);for(var f=[],n=Am(o,f),l=r.props,d=0,s=0;d<n.length;d++)for(var u=0;u<l.length;u++,s++)t.props[s]=f[d]?n[d].replace(/&\f/g,l[u]):l[u]+" "+n[d]}}},gm=function(t){if(t.type==="decl"){var o=t.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(t.return="",t.value="")}};function Jl(e,t){switch(El(e,t)){case 5103:return D+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return D+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return D+e+to+e+j+e+e;case 6828:case 4268:return D+e+j+e+e;case 6165:return D+e+j+"flex-"+e+e;case 5187:return D+e+F(e,/(\w+).+(:[^]+)/,D+"box-$1$2"+j+"flex-$1$2")+e;case 5443:return D+e+j+"flex-item-"+F(e,/flex-|-self/,"")+e;case 4675:return D+e+j+"flex-line-pack"+F(e,/align-content|flex-|-self/,"")+e;case 5548:return D+e+j+F(e,"shrink","negative")+e;case 5292:return D+e+j+F(e,"basis","preferred-size")+e;case 6060:return D+"box-"+F(e,"-grow","")+D+e+j+F(e,"grow","positive")+e;case 4554:return D+F(e,/([^-])(transform)/g,"$1"+D+"$2")+e;case 6187:return F(F(F(e,/(zoom-|grab)/,D+"$1"),/(image-set)/,D+"$1"),e,"")+e;case 5495:case 3959:return F(e,/(image-set\([^]*)/,D+"$1$`$1");case 4968:return F(F(e,/(.+:)(flex-)?(.*)/,D+"box-pack:$3"+j+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+D+e+e;case 4095:case 3583:case 4068:case 2532:return F(e,/(.+)-inline(.+)/,D+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ee(e)-1-t>6)switch(W(e,t+1)){case 109:if(W(e,t+4)!==45)break;case 102:return F(e,/(.+:)(.+)-([^]+)/,"$1"+D+"$2-$3$1"+to+(W(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~oo(e,"stretch")?Jl(F(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(W(e,t+1)!==115)break;case 6444:switch(W(e,ee(e)-3-(~oo(e,"!important")&&10))){case 107:return F(e,":",":"+D)+e;case 101:return F(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+D+(W(e,14)===45?"inline-":"")+"box$3$1"+D+"$2$3$1"+j+"$2box$3")+e}break;case 5936:switch(W(e,t+11)){case 114:return D+e+j+F(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return D+e+j+F(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return D+e+j+F(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return D+e+j+e+e}return e}var Tm=function(t,o,r,a){if(t.length>-1&&!t.return)switch(t.type){case gt:t.return=Jl(t.value,t.length);break;case qo:return tt([yt(t,{value:F(t.value,"@","@"+D)})],a);case ht:if(t.length)return na(t.props,function(f){switch(fa(f,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return tt([yt(t,{props:[F(f,/:(read-\w+)/,":"+to+"$1")]})],a);case"::placeholder":return tt([yt(t,{props:[F(f,/:(plac\w+)/,":"+D+"input-$1")]}),yt(t,{props:[F(f,/:(plac\w+)/,":"+to+"$1")]}),yt(t,{props:[F(f,/:(plac\w+)/,j+"input-$1")]})],a)}return""})}},Sm=[Tm],Vl=function(t){var o=t.key;if(o==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(c){var w=c.getAttribute("data-emotion");w.indexOf(" ")!==-1&&(document.head.appendChild(c),c.setAttribute("data-s",""))})}var a=t.stylisPlugins||Sm,f={},n,l=[];n=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(c){for(var w=c.getAttribute("data-emotion").split(" "),T=1;T<w.length;T++)f[w[T]]=!0;l.push(c)});var d,s=[hm,gm];{var u,i=[Hl,Gl(function(c){u.insert(c)})],p=Wl(s.concat(a,i)),m=function(w){return tt(Nl(w),p)};d=function(w,T,g,x){u=g,m(w?w+"{"+T.styles+"}":T.styles),x&&(h.inserted[T.name]=!0)}}var h={key:o,sheet:new Rl({key:o,container:n,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:f,registered:{},insert:d};return h.sheet.hydrate(l),h};var vm=!0;function fo(e,t,o){var r="";return o.split(" ").forEach(function(a){e[a]!==void 0?t.push(e[a]+";"):a&&(r+=a+" ")}),r}var ur=function(t,o,r){var a=t.key+"-"+o.name;(r===!1||vm===!1)&&t.registered[a]===void 0&&(t.registered[a]=o.styles)},no=function(t,o,r){ur(t,o,r);var a=t.key+"-"+o.name;if(t.inserted[o.name]===void 0){var f=o;do t.insert(o===f?"."+a:"",f,t.sheet,!0),f=f.next;while(f!==void 0)}};function rd(e){for(var t=0,o,r=0,a=e.length;a>=4;++r,a-=4)o=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,t=(o&65535)*1540483477+((o>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(a){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var ad={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var km=!1,Mm=/[A-Z]|^ms/g,Pm=/_EMO_([^_]+?)_([^]*?)_EMO_/g,dd=function(t){return t.charCodeAt(1)===45},fd=function(t){return t!=null&&typeof t!="boolean"},ma=_l(function(e){return dd(e)?e:e.replace(Mm,"-$&").toLowerCase()}),nd=function(t,o){switch(t){case"animation":case"animationName":if(typeof o=="string")return o.replace(Pm,function(r,a,f){return Oe={name:a,styles:f,next:Oe},a})}return ad[t]!==1&&!dd(t)&&typeof o=="number"&&o!==0?o+"px":o},Lm="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function lo(e,t,o){if(o==null)return"";var r=o;if(r.__emotion_styles!==void 0)return r;switch(typeof o){case"boolean":return"";case"object":{var a=o;if(a.anim===1)return Oe={name:a.name,styles:a.styles,next:Oe},a.name;var f=o;if(f.styles!==void 0){var n=f.next;if(n!==void 0)for(;n!==void 0;)Oe={name:n.name,styles:n.styles,next:Oe},n=n.next;var l=f.styles+";";return l}return Nm(e,t,o)}case"function":{if(e!==void 0){var d=Oe,s=o(e);return Oe=d,lo(e,t,s)}break}}var u=o;if(t==null)return u;var i=t[u];return i!==void 0?i:u}function Nm(e,t,o){var r="";if(Array.isArray(o))for(var a=0;a<o.length;a++)r+=lo(e,t,o[a])+";";else for(var f in o){var n=o[f];if(typeof n!="object"){var l=n;t!=null&&t[l]!==void 0?r+=f+"{"+t[l]+"}":fd(l)&&(r+=ma(f)+":"+nd(f,l)+";")}else{if(f==="NO_COMPONENT_SELECTOR"&&km)throw new Error(Lm);if(Array.isArray(n)&&typeof n[0]=="string"&&(t==null||t[n[0]]===void 0))for(var d=0;d<n.length;d++)fd(n[d])&&(r+=ma(f)+":"+nd(f,n[d])+";");else{var s=lo(e,t,n);switch(f){case"animation":case"animationName":{r+=ma(f)+":"+s+";";break}default:r+=f+"{"+s+"}"}}}}return r}var ld=/label:\s*([^\s;{]+)\s*(;|$)/g,Oe;function so(e,t,o){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Oe=void 0;var f=e[0];if(f==null||f.raw===void 0)r=!1,a+=lo(o,t,f);else{var n=f;a+=n[0]}for(var l=1;l<e.length;l++)if(a+=lo(o,t,e[l]),r){var d=f;a+=d[l]}ld.lastIndex=0;for(var s="",u;(u=ld.exec(a))!==null;)s+="-"+u[1];var i=rd(a)+s;return{name:i,styles:a,next:Oe}}var ir=A(Q()),Hm=function(t){return t()},Wm=ir.useInsertionEffect?ir.useInsertionEffect:!1,xa=Wm||Hm;var sd=!1,Aa=xe.createContext(typeof HTMLElement<"u"?Vl({key:"css"}):null),Gm=Aa.Provider,ha=function(){return(0,uo.useContext)(Aa)},ga=function(t){return(0,uo.forwardRef)(function(o,r){var a=(0,uo.useContext)(Aa);return t(o,a,r)})},Ta=xe.createContext({});var pr={}.hasOwnProperty,ca="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ud=function(t,o){var r={};for(var a in o)pr.call(o,a)&&(r[a]=o[a]);return r[ca]=t,r},_m=function(t){var o=t.cache,r=t.serialized,a=t.isStringTag;return ur(o,r,a),xa(function(){return no(o,r,a)}),null},Um=ga(function(e,t,o){var r=e.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var a=e[ca],f=[r],n="";typeof e.className=="string"?n=fo(t.registered,f,e.className):e.className!=null&&(n=e.className+" ");var l=so(f,void 0,xe.useContext(Ta));n+=t.key+"-"+l.name;var d={};for(var s in e)pr.call(e,s)&&s!=="css"&&s!==ca&&!sd&&(d[s]=e[s]);return d.className=n,o&&(d.ref=o),xe.createElement(xe.Fragment,null,xe.createElement(_m,{cache:t,serialized:l,isStringTag:typeof a=="string"}),xe.createElement(a,d))}),id=Um;var Ot=A(Q());var XT=A(od()),pd=function(t,o){var r=arguments;if(o==null||!pr.call(o,"css"))return Ot.createElement.apply(void 0,r);var a=r.length,f=new Array(a);f[0]=id,f[1]=ud(t,o);for(var n=2;n<a;n++)f[n]=r[n];return Ot.createElement.apply(null,f)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(pd||(pd={}));var Cd=A(xd(),1);var Sa=A(Q(),1);var hd=A(Q(),1);var mr=e=>{let t=e.length,o=0,r="";for(;o<t;o++){let a=e[o];if(a==null)continue;let f;switch(typeof a){case"boolean":break;case"object":{if(Array.isArray(a))f=mr(a);else{let n=a;f="";for(let l in n)n[l]&&l&&(f&&(f+=" "),f+=l)}break}default:f=a}f&&(r&&(r+=" "),r+=f)}return r};function cd(e){return e instanceof Object&&!("styles"in e)&&!("length"in e)&&!("__emotion_styles"in e)}var{createCssAndCx:Jm}=(()=>{function e(o,r,a){let f=[],n=fo(o,f,a);return f.length<2?a:n+r(f)}function t(o){let{cache:r}=o,a=(...n)=>{let l=so(n,r.registered);no(r,l,!1);let d=`${r.key}-${l.name}`;e:{let s=n[0];if(!cd(s))break e;Ad.saveClassNameCSSObjectMapping(r,d,s)}return d};return{css:a,cx:(...n)=>{let l=mr(n),d=Ad.fixClassName(r,l,a);return e(r.registered,a,d)}}}return{createCssAndCx:t}})();function gd(e){let{useCache:t}=e;function o(){let r=t(),{css:a,cx:f}=(0,hd.useMemo)(()=>Jm({cache:r}),[r]);return{css:a,cx:f}}return{useCssAndCx:o}}var Ad=(()=>{let e=new WeakMap;return{saveClassNameCSSObjectMapping:(t,o,r)=>{let a=e.get(t);a===void 0&&(a=new Map,e.set(t,a)),a.set(o,r)},fixClassName:(()=>{function t(o){let r=!1;return o.map(([a,f])=>{if(f===void 0)return a;let n;if(r)n={"&&":f};else{n=a;for(let l in f)if(l.startsWith("@media")){r=!0;break}}return n})}return(o,r,a)=>{if(!r.includes(" "))return r;let f=e.get(o);return mr(t(r.split(" ").map(n=>[n,f?.get(n)])).map(n=>typeof n=="string"?n:a(n)))}})()}})();function Td(e,t,o){if(!(t instanceof Object))return e;let r=Object.keys(t);if(r.length===0)return e;let a={};for(let f of Object.keys(e))a[f]=o(e[f],t[f]);for(let f of r){if(f in e)continue;let n=t[f];typeof n=="string"&&(a[f]=n)}return a}function Sd(e){if(!(e instanceof Object)||typeof e=="function")return e;let t=[];for(let o in e){let r=e[o],a=typeof r;if(!(a==="string"||a==="number"&&!isNaN(r)||a==="boolean"||r===void 0||r===null))return e;t.push(`${o}:${a}_${r}`)}return`xSqLiJdLMd9s${t.join("|")}`}var Vm=ha;function wd(e){let{useTheme:t}=e,{useCssAndCx:o}=gd({useCache:Vm});function r(){return function(a){let f=typeof a=="function"?a:()=>a;return function(l,d){let s=t(),{css:u,cx:i}=o(),p=(0,Sa.useMemo)(()=>{let w=f(s),T={};for(let g of Object.keys(w)){let x=w[g];T[g]=u(x)}return T},[u,s]),m=d?.props.classes,h=Sd(m);return{classes:(0,Sa.useMemo)(()=>m?Td(p,m,i):p,[p,h,i]),theme:s,css:u,cx:i}}}}return{makeStyles:r}}var{makeStyles:xr}=wd({useTheme:Cd.useTheme});function Km(e){return Math.round(e*1e5)/1e5}var Ym=xr()(e=>({tooltip:{position:"absolute",pointerEvents:"none",backgroundColor:(0,Et.alpha)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.fontSize,lineHeight:`${Km(14/10)}em`,maxWidth:300,wordWrap:"break-word"}}));function Ca({clientPoint:e,children:t,placement:o="right"}){let a=(0,Et.useTheme)().components?.MuiPopper,{classes:f}=Ym(),{refs:n,floatingStyles:l,context:d}=wl({placement:o,strategy:"fixed",middleware:[Ko(5)]}),s=Sl(d,e),{getFloatingProps:u}=Cl([s]);return(0,wa.jsx)(Et.Portal,{container:a?.defaultProps?.container,children:(0,wa.jsx)("div",{className:f.tooltip,ref:n.setFloating,style:{...l,zIndex:1e5,visibility:l.transform==="translate(0px, 0px)"?"hidden":void 0,pointerEvents:"none"},...u(),children:t})})}var Id=A(X()),Od=A(re());var bt=A(X());function cr(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ar(e,t){let o;if(t===void 0)for(let r of e)r!=null&&(o<r||o===void 0&&r>=r)&&(o=r);else{let r=-1;for(let a of e)(a=t(a,++r,e))!=null&&(o<a||o===void 0&&a>=a)&&(o=a)}return o}function Rd(e,t,o){let r=[];if(t)r.push(`Start: ${t.refName}:${(0,bt.toLocale)(t.coord)}`,`End: ${o.refName}:${(0,bt.toLocale)(o.coord)}`,`Length: ${(0,bt.getBpDisplayStr)(Math.abs(t.coord-o.coord))}`);else if(r.push(`Ref: ${o.refName}:${(0,bt.toLocale)(o.coord)}`),e){let{base:a,sampleLabel:f,pos:n,chr:l,isInsertion:d}=e,s=20,u=a.length,i=u>1?` ${u}bp`:"",p=a.length>s?a.slice(0,s)+"...":a,m=d?" Insertion":"";r.push(`Alt ${f}: ${l}:${n.toLocaleString("en-US")} (${p}${i}${m})`)}return r.filter(a=>!!a).join("<br/>")}function Ra(e){return(e.data.length||0)+(e.children&&Ar(e.children,Ra)||0)}function ya(e,t,o){let r=t+Math.max(e.data.length||0,0);if(e.len=r*o,e.children)for(let a of e.children)ya(a,r,o)}function yd(e){let t=new Map;function o(r){if(!r.children||r.children.length===0){let f=[r.data.name];return t.set(r,f),f}let a=[];for(let f of r.children)for(let n of o(f))a.push(n);return t.set(r,a),a}return o(e),t}var qm=(0,Od.observer)(function({model:e,mouseX:t,origMouseX:o}){let{hoveredInfo:r}=e,a=(0,Id.getContainingView)(e),f=o?a.pxToBp(o):void 0,n=a.pxToBp(t);return r?Ba.default.createElement(Ca,null,Ba.default.createElement(Bd.SanitizedHTML,{html:Rd(r,f,n)})):null}),Ed=qm;var hr=A(Q()),bd=A(re()),jm=(0,bd.observer)(function({model:t,view:o,height:r}){let{msaHighlights:a}=t;if(a.length===0)return null;let{offsetPx:f}=o,n=o.displayedRegions[0];return n?hr.default.createElement(hr.default.Fragment,null,a.map((l,d)=>{if(l.refName!==n.refName)return null;let s=(l.start-n.start)/o.bpPerPx-f,u=(l.end-n.start)/o.bpPerPx-f,i=Math.max(u-s,2);return hr.default.createElement("div",{key:d,style:{position:"absolute",left:s,top:0,width:i,height:r,backgroundColor:"rgba(255, 165, 0, 0.4)",border:"1px solid rgba(255, 165, 0, 0.8)",pointerEvents:"none"}})})):null}),Qd=jm;Qa();var Z=A(Q()),jd=3;function zd(e){let[t,o]=(0,Z.useState)(!1),[r,a]=(0,Z.useState)(),[f,n]=(0,Z.useState)(),[l,d]=(0,Z.useState)(!1),[s,u]=(0,Z.useState)(),[i,p]=(0,Z.useState)(),[m,h]=(0,Z.useState)(),c=(0,Z.useCallback)(()=>{d(!1),a(void 0),n(void 0)},[]),w=(0,Z.useCallback)(R=>{if(R.shiftKey)return;let B=e.current?.getBoundingClientRect()?.left||0,k=R.clientX-B;d(!1),o(!0),a(k),n(k),R.stopPropagation()},[e]),T=(0,Z.useCallback)(R=>{let S=e.current?.getBoundingClientRect(),B=S?.top||0,k=S?.left||0,E=R.clientX-k,H=R.clientY-B;p(H),u(E),t&&n(E)},[e,t]),g=(0,Z.useCallback)(R=>{t&&r!==void 0&&f!==void 0&&(Math.abs(f-r)>jd?(h({coord:[R.clientX,R.clientY],dragEndX:R.clientX,dragStartX:r}),d(!0)):c()),o(!1)},[t,r,f,c]),x=(0,Z.useCallback)(()=>{p(void 0),u(void 0),o(!1)},[]);(0,Z.useEffect)(()=>{let R=B=>{B.key==="Escape"&&l&&c()},S=B=>{e.current&&!e.current.contains(B.target)&&l&&c()};return document.addEventListener("keydown",R),document.addEventListener("click",S),()=>{document.removeEventListener("keydown",R),document.removeEventListener("click",S)}},[e,l,c]);let y=(r!==void 0&&f!==void 0?Math.abs(f-r):0)>jd;return{isDragging:t&&y,dragStartX:r,dragEndX:f,showSelectionBox:l,mouseX:s,mouseY:i,contextCoord:m,setContextCoord:h,handleMouseDown:w,handleMouseMove:T,handleMouseUp:g,handleMouseLeave:x,clearSelectionBox:c}}var ox=(0,Zd.observer)(function(e){let{model:t}=e,{pluginManager:o}=(0,Ve.getEnv)(t),{height:r,scrollTop:a,samples:f}=t,n=(0,ce.useRef)(null),l=(0,$d.useTheme)(),d=(0,Ve.getSession)(t),s=o.getPlugin("LinearGenomeViewPlugin"),{BaseLinearDisplayComponent:u}=s.exports,{isDragging:i,dragStartX:p,dragEndX:m,showSelectionBox:h,mouseX:c,mouseY:w,contextCoord:T,setContextCoord:g,handleMouseDown:x,handleMouseMove:C,handleMouseUp:y,handleMouseLeave:R,clearSelectionBox:S}=zd(n),B=(0,Ve.getContainingView)(t),{width:k}=B;return ce.default.createElement("div",{ref:n,onMouseDown:x,onMouseMove:C,onMouseUp:y,onDoubleClick:()=>{h&&S()},onMouseLeave:R},ce.default.createElement(u,{...e}),t.showSidebar?ce.default.createElement(gr,{model:t}):null,ce.default.createElement(Qd,{model:t,view:B,height:r}),w!==void 0&&c!==void 0&&f&&!T?ce.default.createElement("div",{style:{position:"relative"}},ce.default.createElement(Mn,{width:k,height:r,scrollTop:a,mouseX:c,mouseY:w}),ce.default.createElement(Ed,{model:t,mouseX:c,origMouseX:i?p:void 0})):null,(i||h)&&p!==void 0&&m!==void 0?ce.default.createElement("div",{style:{position:"absolute",left:Math.min(p,m),top:0,width:Math.abs(m-p),height:r,backgroundColor:"rgba(0, 0, 255, 0.2)",border:"1px solid rgba(0, 0, 255, 0.5)",pointerEvents:"none"}}):null,ce.default.createElement(Xd.Menu,{open:!!T,onMenuItemClick:(E,H)=>{H(),g(void 0)},onClose:()=>{g(void 0)},slotProps:{transition:{onExit:()=>{g(void 0)}}},anchorReference:"anchorPosition",anchorPosition:T?{top:T.coord[1],left:T.coord[0]}:void 0,style:{zIndex:l.zIndex.tooltip},menuItems:[{label:"View subsequence",onClick:()=>{if(!T)return;let{refName:E,assemblyName:H}=B.displayedRegions[0],[ue,ge]=[Math.min(T.dragStartX,T.dragEndX),Math.max(T.dragStartX,T.dragEndX)];if((0,Ve.isSessionModelWithWidgets)(d)){let ie=d.addWidget("MafSequenceWidget","mafSequence",{adapterConfig:t.adapterConfig,samples:t.samples,regions:[{refName:E,start:B.pxToBp(ue).coord-1,end:B.pxToBp(ge).coord,assemblyName:H}],connectedViewId:B.id});d.showWidget(ie)}g(void 0)}}]}))}),es=ox;var ts=A(He());function Fa(e){let t=e.getPlugin("LinearGenomeViewPlugin"),{baseLinearDisplayConfigSchema:o}=t.exports;return(0,ts.ConfigurationSchema)("LinearMafDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:o,explicitlyTyped:!0})}var Ms=A(Q()),Tr=A(He()),z=A(X()),Ps=A(rs()),Ke=A(Te());function rx(e,t){return e.parent===t.parent?1:2}function ax(e){return e.reduce(fx,0)/e.length}function fx(e,t){return e+t.x}function nx(e){return 1+e.reduce(lx,0)}function lx(e,t){return Math.max(e,t.y)}function dx(e){for(var t;t=e.children;)e=t[0];return e}function sx(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Da(){var e=rx,t=1,o=1,r=!1;function a(f){var n,l=0;f.eachAfter(function(p){var m=p.children;m?(p.x=ax(m),p.y=nx(m)):(p.x=n?l+=e(p,n):0,p.y=0,n=p)});var d=dx(f),s=sx(f),u=d.x-e(d,s)/2,i=s.x+e(s,d)/2;return f.eachAfter(r?function(p){p.x=(p.x-f.x)*t,p.y=(f.y-p.y)*o}:function(p){p.x=(p.x-u)/(i-u)*t,p.y=(1-(f.y?p.y/f.y:1))*o})}return a.separation=function(f){return arguments.length?(e=f,a):e},a.size=function(f){return arguments.length?(r=!1,t=+f[0],o=+f[1],a):r?null:[t,o]},a.nodeSize=function(f){return arguments.length?(r=!0,t=+f[0],o=+f[1],a):r?[t,o]:null},a}function ux(e){var t=0,o=e.children,r=o&&o.length;if(!r)t=1;else for(;--r>=0;)t+=o[r].value;e.value=t}function as(){return this.eachAfter(ux)}function fs(e,t){let o=-1;for(let r of this)e.call(t,r,++o,this);return this}function ns(e,t){for(var o=this,r=[o],a,f,n=-1;o=r.pop();)if(e.call(t,o,++n,this),a=o.children)for(f=a.length-1;f>=0;--f)r.push(a[f]);return this}function ls(e,t){for(var o=this,r=[o],a=[],f,n,l,d=-1;o=r.pop();)if(a.push(o),f=o.children)for(n=0,l=f.length;n<l;++n)r.push(f[n]);for(;o=a.pop();)e.call(t,o,++d,this);return this}function ds(e,t){let o=-1;for(let r of this)if(e.call(t,r,++o,this))return r}function ss(e){return this.eachAfter(function(t){for(var o=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)o+=r[a].value;t.value=o})}function us(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function is(e){for(var t=this,o=ix(t,e),r=[t];t!==o;)t=t.parent,r.push(t);for(var a=r.length;e!==o;)r.splice(a,0,e),e=e.parent;return r}function ix(e,t){if(e===t)return e;var o=e.ancestors(),r=t.ancestors(),a=null;for(e=o.pop(),t=r.pop();e===t;)a=e,e=o.pop(),t=r.pop();return a}function ps(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function ms(){return Array.from(this)}function xs(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function cs(){var e=this,t=[];return e.each(function(o){o!==e&&t.push({source:o.parent,target:o})}),t}function*As(){var e=this,t,o=[e],r,a,f;do for(t=o.reverse(),o=[];e=t.pop();)if(yield e,r=e.children)for(a=0,f=r.length;a<f;++a)o.push(r[a]);while(o.length)}function Qt(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=xx)):t===void 0&&(t=mx);for(var o=new io(e),r,a=[o],f,n,l,d;r=a.pop();)if((n=t(r.data))&&(d=(n=Array.from(n)).length))for(r.children=n,l=d-1;l>=0;--l)a.push(f=n[l]=new io(n[l])),f.parent=r,f.depth=r.depth+1;return o.eachBefore(Ax)}function px(){return Qt(this).eachBefore(cx)}function mx(e){return e.children}function xx(e){return Array.isArray(e)?e[1]:null}function cx(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ax(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function io(e){this.data=e,this.depth=this.height=0,this.parent=null}io.prototype=Qt.prototype={constructor:io,count:as,each:fs,eachAfter:ls,eachBefore:ns,find:ds,sum:ss,sort:us,path:is,ancestors:ps,descendants:ms,leaves:xs,links:cs,copy:px,[Symbol.iterator]:As};var va=A(gs()),Ls=A(Oa());var Os=15,Es=.8,bs=!1,Qs=!0,Fs=!1,Ds=80,vs=!0,ks=!0,wx=(0,Ms.lazy)(()=>Promise.resolve().then(()=>(Rs(),Cs)));function ka(e,t){let o=t.getPlugin("LinearGenomeViewPlugin"),{BaseLinearDisplay:r}=o.exports;return Ke.types.compose("LinearMafDisplay",r,Ke.types.model({type:Ke.types.literal("LinearMafDisplay"),configuration:(0,Tr.ConfigurationReference)(e),rowHeight:Os,rowProportion:Es,showAllLetters:bs,mismatchRendering:Qs,showBranchLen:Fs,treeAreaWidth:Ds,showAsUpperCase:vs,showSidebar:ks})).volatile(()=>({hoveredInfo:void 0,prefersOffset:!0,volatileSamples:void 0,volatileTree:void 0,highlightedRowNames:void 0,hoveredTreeNode:void 0})).actions(a=>({setHoveredInfo(f){a.hoveredInfo=f},setRowHeight(f){a.rowHeight=f},setRowProportion(f){a.rowProportion=f},setShowAllLetters(f){a.showAllLetters=f},setMismatchRendering(f){a.mismatchRendering=f},setSamples({samples:f,tree:n}){(0,va.default)(f,a.volatileSamples)||(a.volatileSamples=f),(0,va.default)(n,a.volatileTree)||(a.volatileTree=n)},setShowAsUpperCase(f){a.showAsUpperCase=f},setTreeAreaWidth(f){a.treeAreaWidth=f},setShowSidebar(f){a.showSidebar=f},setHighlightedRowNames(f,n){a.highlightedRowNames=f,a.hoveredTreeNode=n},showInsertionSequenceDialog(f){let{sequence:n,sampleLabel:l,chr:d,pos:s}=f,u=(0,z.getSession)(a),i=u.addWidget("BaseFeatureWidget","baseFeature",{featureData:{uniqueId:`insertion-${d}-${s}-${l}`,type:"insertion",refName:d,start:s,end:s+1,sample:l,insertionLength:n.length,sequence:a.showAsUpperCase?n.toUpperCase():n.toLowerCase()},view:(0,z.getContainingView)(a),track:(0,z.getContainingTrack)(a)});u.showWidget(i)}})).views(a=>({get rendererTypeName(){return"LinearMafRenderer"},get rendererConfig(){let n=(0,Tr.getConf)(a,["renderer"])||{};return a.rendererType.configSchema.create({...n,type:"LinearMafRenderer"},(0,z.getEnv)(a))}})).views(a=>({get root(){return a.volatileTree?Qt(a.volatileTree,f=>f.children).sum(f=>f.children?.length?0:1).sort((f,n)=>cr(f.data.length||1,n.data.length||1)):void 0}})).views(a=>({get hierarchy(){let f=a.root;if(f){let n=a.treeAreaWidth;Da().size([this.totalHeight-a.rowHeight,n]).separation(()=>1)(f);for(let d of f.descendants())d.x=d.x+a.rowHeight/2;return f.data.length=0,ya(f,0,n/Ra(f)),f}else return},get samples(){if(this.rowNames){let f=a.volatileSamples?Object.fromEntries(a.volatileSamples.map(n=>[n.id,n])):void 0;return mt(this.rowNames).map(n=>({...n,label:f?.[n.id]?.label||n.label,color:f?.[n.id]?.color||n.color}))}else return a.volatileSamples},get totalHeight(){return this.samples?this.samples.length*a.rowHeight:1},get leaves(){return a.root?.leaves()},get leafMap(){return new Map(this.leaves?.map(f=>[f.data.name,f]))},get nodeDescendantNames(){return this.hierarchy?yd(this.hierarchy):new Map},get rowNames(){return this.leaves?.map(f=>f.data.name)}})).views(a=>{let{trackMenuItems:f,renderProps:n}=a;return{get treeWidth(){return a.hierarchy?a.treeAreaWidth:0},renderProps(){let{showAllLetters:l,rendererConfig:d,samples:s,rowHeight:u,rowProportion:i,mismatchRendering:p,showAsUpperCase:m}=a,h=n();return{...h,notReady:!a.volatileSamples&&!a.volatileTree||h.notReady,config:d,samples:s,rowHeight:u,rowProportion:i,showAllLetters:l,mismatchRendering:p,showAsUpperCase:m}},trackMenuItems(){return[...f(),{label:"Set feature height",type:"subMenu",subMenu:[{label:"Normal",onClick:()=>{a.setRowHeight(15),a.setRowProportion(.8)}},{label:"Compact",onClick:()=>{a.setRowHeight(8),a.setRowProportion(.9)}},{label:"Manually set height",onClick:()=>{(0,z.getSession)(a).queueDialog(l=>[wx,{model:a,handleClose:l}])}}]},{label:"Use upper-case",type:"checkbox",checked:a.showAsUpperCase,onClick:()=>{a.setShowAsUpperCase(!a.showAsUpperCase)}},{label:"Show all letters",type:"checkbox",checked:a.showAllLetters,onClick:()=>{a.setShowAllLetters(!a.showAllLetters)}},{label:"Draw mismatches as single color",type:"checkbox",checked:!a.mismatchRendering,onClick:()=>{a.setMismatchRendering(!a.mismatchRendering)}},{label:"Show sidebar",type:"checkbox",checked:a.showSidebar,onClick:()=>{a.setShowSidebar(!a.showSidebar)}}]}}}).views(a=>({get msaHighlights(){let f=(0,z.getSession)(a),n=(0,z.getContainingView)(a),l=[];for(let d of f.views)if(d.type==="MsaView"&&d.connectedViewId===n.id){let s=d;if(s.connectedHighlights)for(let u of s.connectedHighlights)l.push(u)}return l},get svgFontSize(){return Math.min(Math.max(a.rowHeight,8),14)},get canDisplayLabel(){return a.rowHeight>=7},get labelWidth(){return(0,z.max)(a.samples?.map(n=>(0,z.measureText)(n.label,this.svgFontSize)).map(n=>this.canDisplayLabel?n:20)||[],0)},get sidebarWidth(){return a.showSidebar?this.labelWidth+5+a.treeWidth:0}})).actions(a=>({afterCreate(){(0,Ke.addDisposer)(a,(0,Ls.autorun)(async()=>{try{let{rpcManager:f}=(0,z.getSession)(a),n=(0,Ps.getRpcSessionId)(a);a.setSamples(await f.call(n,"MafGetSamples",{sessionId:n,adapterConfig:a.adapterConfig,statusCallback:l=>{(0,Ke.isAlive)(a)&&a.setStatusMessage(l)}}))}catch(f){console.error(f),(0,z.getSession)(a).notifyError(`${f}`,f)}}))}})).actions(a=>{let{renderSvg:f}=a;return{async renderSvg(n){let{renderSvg:l}=await Promise.resolve().then(()=>(Is(),Bs));return l(a,n,f)}}}).postProcessSnapshot(a=>{let{rowHeight:f,rowProportion:n,showAllLetters:l,mismatchRendering:d,showBranchLen:s,treeAreaWidth:u,showAsUpperCase:i,showSidebar:p,...m}=a;return{...m,...f!==Os?{rowHeight:f}:{},...n!==Es?{rowProportion:n}:{},...l!==bs?{showAllLetters:l}:{},...d!==Qs?{mismatchRendering:d}:{},...s!==Fs?{showBranchLen:s}:{},...u!==Ds?{treeAreaWidth:u}:{},...i!==vs?{showAsUpperCase:i}:{},...p!==ks?{showSidebar:p}:{}}})}function Ma(e){e.addDisplayType(()=>{let t=Fa(e),o=ka(t,e);return new Ns.DisplayType({name:"LinearMafDisplay",configSchema:t,stateModel:o,ReactComponent:es,viewType:"LinearGenomeView",trackType:"MafTrack",displayName:"MAF display"})})}var ru=A(Le()),wr=A(X());var tu=A(Fe());var po=class{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,o){let r=this.length++;for(;r>0;){let a=r-1>>1,f=this.values[a];if(o>=f)break;this.ids[r]=this.ids[a],this.values[r]=f,r=a}this.ids[r]=t,this.values[r]=o}pop(){if(this.length===0)return;let t=this.ids,o=this.values,r=t[0],a=--this.length;if(a>0){let f=t[a],n=o[a],l=0,d=a>>1;for(;l<d;){let s=(l<<1)+1,u=s+1,i=s+(+(u<a)&+(o[u]<o[s]));if(o[i]>=n)break;t[l]=t[i],o[l]=o[i],l=i}t[l]=f,o[l]=n}return r}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}};var Hs=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Pa=3,ot=class e{static from(t,o=0){if(o%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");let[r,a]=new Uint8Array(t,o+0,2);if(r!==251)throw new Error("Data does not appear to be in a Flatbush format.");let f=a>>4;if(f!==Pa)throw new Error(`Got v${f} data when expected v${Pa}.`);let n=Hs[a&15];if(!n)throw new Error("Unrecognized array type.");let[l]=new Uint16Array(t,o+2,1),[d]=new Uint32Array(t,o+4,1);return new e(d,l,n,void 0,t,o)}constructor(t,o=16,r=Float64Array,a=ArrayBuffer,f,n=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.byteOffset=n;let l=t,d=l;this._levelBounds=[l*4];do l=Math.ceil(l/this.nodeSize),d+=l,this._levelBounds.push(d*4);while(l!==1);this.ArrayType=r,this.IndexArrayType=d<16384?Uint16Array:Uint32Array;let s=Hs.indexOf(r),u=d*4*r.BYTES_PER_ELEMENT;if(s<0)throw new Error(`Unexpected typed array class: ${r}.`);if(f)this.data=f,this._boxes=new r(f,n+8,d*4),this._indices=new this.IndexArrayType(f,n+8+u,d),this._pos=d*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{let i=this.data=new a(8+u+d*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new r(i,8,d*4),this._indices=new this.IndexArrayType(i,8+u,d),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(i,0,2).set([251,(Pa<<4)+s]),new Uint16Array(i,2,1)[0]=o,new Uint32Array(i,4,1)[0]=t}this._queue=new po}add(t,o,r=t,a=o){let f=this._pos>>2,n=this._boxes;return this._indices[f]=f,n[this._pos++]=t,n[this._pos++]=o,n[this._pos++]=r,n[this._pos++]=a,t<this.minX&&(this.minX=t),o<this.minY&&(this.minY=o),r>this.maxX&&(this.maxX=r),a>this.maxY&&(this.maxY=a),f}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);let t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}let o=this.maxX-this.minX||1,r=this.maxY-this.minY||1,a=new Uint32Array(this.numItems),f=65535;for(let n=0,l=0;n<this.numItems;n++){let d=t[l++],s=t[l++],u=t[l++],i=t[l++],p=Math.floor(f*((d+u)/2-this.minX)/o),m=Math.floor(f*((s+i)/2-this.minY)/r);a[n]=Rx(p,m)}La(a,t,this._indices,0,this.numItems-1,this.nodeSize);for(let n=0,l=0;n<this._levelBounds.length-1;n++){let d=this._levelBounds[n];for(;l<d;){let s=l,u=t[l++],i=t[l++],p=t[l++],m=t[l++];for(let h=1;h<this.nodeSize&&l<d;h++)u=Math.min(u,t[l++]),i=Math.min(i,t[l++]),p=Math.max(p,t[l++]),m=Math.max(m,t[l++]);this._indices[this._pos>>2]=s,t[this._pos++]=u,t[this._pos++]=i,t[this._pos++]=p,t[this._pos++]=m}}}search(t,o,r,a,f){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let n=this._boxes.length-4,l=[],d=[];for(;n!==void 0;){let s=Math.min(n+this.nodeSize*4,Ws(n,this._levelBounds));for(let u=n;u<s;u+=4){let i=this._boxes[u];if(r<i)continue;let p=this._boxes[u+1];if(a<p)continue;let m=this._boxes[u+2];if(t>m)continue;let h=this._boxes[u+3];if(o>h)continue;let c=this._indices[u>>2]|0;n>=this.numItems*4?l.push(c):(f===void 0||f(c,i,p,m,h))&&d.push(c)}n=l.pop()}return d}neighbors(t,o,r=1/0,a=1/0,f){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let n=this._boxes.length-4,l=this._queue,d=[],s=a*a;e:for(;n!==void 0;){let u=Math.min(n+this.nodeSize*4,Ws(n,this._levelBounds));for(let i=n;i<u;i+=4){let p=this._indices[i>>2]|0,m=this._boxes[i],h=this._boxes[i+1],c=this._boxes[i+2],w=this._boxes[i+3],T=t<m?m-t:t>c?t-c:0,g=o<h?h-o:o>w?o-w:0,x=T*T+g*g;x>s||(n>=this.numItems*4?l.push(p<<1,x):(f===void 0||f(p))&&l.push((p<<1)+1,x))}for(;l.length&&l.peek()&1;)if(l.peekValue()>s||(d.push(l.pop()>>1),d.length===r))break e;n=l.length?l.pop()>>1:void 0}return l.clear(),d}};function Ws(e,t){let o=0,r=t.length-1;for(;o<r;){let a=o+r>>1;t[a]>e?r=a:o=a+1}return t[o]}function La(e,t,o,r,a,f){if(Math.floor(r/f)>=Math.floor(a/f))return;let n=e[r],l=e[r+a>>1],d=e[a],s=d,u=Math.max(n,l);d>u?s=u:u===n?s=Math.max(l,d):u===l&&(s=Math.max(n,d));let i=r-1,p=a+1;for(;;){do i++;while(e[i]<s);do p--;while(e[p]>s);if(i>=p)break;Cx(e,t,o,i,p)}La(e,t,o,r,p,f),La(e,t,o,p+1,a,f)}function Cx(e,t,o,r,a){let f=e[r];e[r]=e[a],e[a]=f;let n=4*r,l=4*a,d=t[n],s=t[n+1],u=t[n+2],i=t[n+3];t[n]=t[l],t[n+1]=t[l+1],t[n+2]=t[l+2],t[n+3]=t[l+3],t[l]=d,t[l+1]=s,t[l+2]=u,t[l+3]=i;let p=o[r];o[r]=o[a],o[a]=p}function Rx(e,t){let o=e^t,r=65535^o,a=65535^(e|t),f=e&(t^65535),n=o|r>>1,l=o>>1^o,d=a>>1^r&f>>1^a,s=o&a>>1^f>>1^f;o=n,r=l,a=d,f=s,n=o&o>>2^r&r>>2,l=o&r>>2^r&(o^r)>>2,d^=o&a>>2^r&f>>2,s^=r&a>>2^(o^r)&f>>2,o=n,r=l,a=d,f=s,n=o&o>>4^r&r>>4,l=o&r>>4^r&(o^r)>>4,d^=o&a>>4^r&f>>4,s^=r&a>>4^(o^r)&f>>4,o=n,r=l,a=d,f=s,d^=o&a>>8^r&f>>8,s^=r&a>>8^(o^r)&f>>8,o=d^d>>1,r=s^s>>1;let u=e^t,i=r|65535^(u|o);return u=(u|u<<8)&16711935,u=(u|u<<4)&252645135,u=(u|u<<2)&858993459,u=(u|u<<1)&1431655765,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,(i<<1|u)>>>0}var Gs="bold 10px Courier New,monospace";function mo(e,t,o=!1){return o?!0:Math.abs(e-t.lastInsertedX)>.5*Math.max(1,t.bpPerPx)}function xo(e,t,o,r,a,f){e.spatialIndex.push(f),e.spatialIndexCoords.push(t,o,r,a),e.lastInsertedX=t}function _s(e,t,o,r,a){let{ctx:f,scale:n}=e,l=e.rowHeight/2;f.beginPath(),f.fillStyle="black";for(let d=0,s=0,u=t.length;d<u;d++)if(o[d]!=="-"){if(t[d]==="-"){let i=r+n*s;f.moveTo(i,a+l),f.lineTo(i+n+.4,a+l)}s++}f.stroke()}var Na=A(X());function Us(e){return Object.fromEntries(Object.entries(Ha(e)).map(([t,o])=>[t,e.palette.getContrastText(o)]))}function Ha(e){let{bases:t}=e.palette;return{a:t.A.main,c:t.C.main,g:t.G.main,t:t.T.main}}function he(e,t,o,r,a,f,n){t+r<0||t>f||(n&&(e.fillStyle=n),e.fillRect(t,o,r,a))}function Js(){let e=(0,Na.measureText)("A"),t=(0,Na.measureText)("M")-2;return{charWidth:e,charHeight:t}}function Vs(e,t,o,r,a){if(e.showAllLetters)return;let{ctx:f,scale:n,h:l,canvasWidth:d}=e;f.fillStyle="lightgrey";for(let s=0,u=0,i=t.length;s<i;s++)if(o[s]!=="-"){let p=t[s];if(o[s]===p&&p!==" "){let m=r+n*u;he(f,m,a,n+.4,l,d)}u++}}function Ks(e,t,o,r,a,f,n,l){let{ctx:d,scale:s,h:u,canvasWidth:i,showAllLetters:p,mismatchRendering:m,colorForBase:h}=e;for(let c=0,w=0,T=t.length;c<T;c++){let g=t[c];if(o[c]!=="-"){if(g!=="-"){let x=r+s*w;o[c]!==g&&g!==" "?(he(d,x,a,s+.4,u,i,m?h[g]??"black":"orange"),mo(x,e)&&xo(e,x,a,x+e.scale+.4,a+e.h,{pos:w+n,chr:l,base:g,rowIndex:f})):p&&(he(d,x,a,s+.4,u,i,m?h[g]??"black":"lightblue"),mo(x,e)&&xo(e,x,a,x+e.scale+.4,a+e.h,{pos:w+n,chr:l,base:g,rowIndex:f}))}w++}}}function Ix(e,t){return t?e.toUpperCase():e}function Ys(e,t,o,r,a,f){let{ctx:n,scale:l,hp2:d,rowHeight:s,showAllLetters:u,mismatchRendering:i,contrastForBase:p,showAsUpperCase:m,charHeight:h}=e;if(l>=10){for(let c=0,w=0,T=t.length;c<T;c++)if(r[c]!=="-"){let g=a+l*w,x=(l-10)/2+1,C=t[c];(u||r[c]!==C)&&C!=="-"&&(n.fillStyle=i?p[C]??"white":"black",s>h&&n.fillText(Ix(o[c]||"",m),g+x,d+f+3)),w++}}}var Xs=A(X());function $s(e,t,o,r,a,f,n,l,d){let{ctx:s,scale:u,h:i,canvasWidth:p,rowHeight:m,charHeight:h}=e;for(let c=0,w=0,T=t.length;c<T;c++){let g="";for(;o[c]==="-";)t[c]!=="-"&&t[c]!==" "&&(g+=t[c]),c++;if(g.length>0){let x=r+u*w-1,C,y;if(g.length>10){let S=`${g.length}`;if(f>10)C=x-1,y=2,he(s,C,a,y,i,p,"purple");else if(i>h){let B=(0,Xs.measureText)(S,10),k=2;C=x-B/2-k,y=B+2*k,he(s,C,a,y,i,p,"purple"),s.fillStyle="white",s.fillText(S,x-B/2,a+i*7/8)}else{let B=2;C=x-B,y=2*B,he(s,C,a,y,i,p,"purple")}}else{C=x,y=1,he(s,C,a,y,i,p,"purple");let S=2;C=x-S,y=1+2*S,f<.2&&m>5&&(he(s,x-2,a,5,1,p),he(s,x-2,a+i-1,5,1,p))}let R=g.length>10;mo(C,e,!0)&&xo(e,C,a,C+y,a+e.h,{pos:w+l,chr:d,base:g,rowIndex:n,isInsertion:!0,isLargeInsertion:R})}w++}}var Zs=A(X());function eu(e,t,o,r,a){let[f]=(0,Zs.featureSpanPx)(e,t,o),n=e.get("alignments"),l=e.get("seq").toLowerCase();for(let[d,s]of Object.entries(n)){let u=r.get(d);if(u===void 0)continue;let i=s.seq,p=i.toLowerCase(),m=a.offset+a.rowHeight*u;_s(a,p,l,f,m),Vs(a,p,l,f,m),Ks(a,p,l,f,m,u,s.start,s.chr),Ys(a,p,i,l,f,m),$s(a,p,l,f,m,o,u,s.start,s.chr)}}function ou({ctx:e,renderArgs:t}){let{regions:o,bpPerPx:r,rowHeight:a,showAllLetters:f,theme:n,mismatchRendering:l,samples:d,rowProportion:s,features:u,showAsUpperCase:i}=t,p=o[0],m=(p.end-p.start)/r,h=a*s,c=(0,tu.createJBrowseTheme)(n),w=Ha(c),T=Us(c),g=new Map(d.map((E,H)=>[E.id,H])),x=1/r,C=h/2,y=(a-h)/2,{charWidth:R,charHeight:S}=Js();e.font=Gs;let B={ctx:e,scale:x,bpPerPx:r,canvasWidth:m,rowHeight:a,h,hp2:C,offset:y,colorForBase:w,contrastForBase:T,showAllLetters:f,mismatchRendering:l,showAsUpperCase:i,charWidth:R,charHeight:S,spatialIndex:[],spatialIndexCoords:[],lastInsertedX:-1/0};for(let E of u.values())eu(E,p,r,g,B);let k=new ot(B.spatialIndex.length||1);if(B.spatialIndex.length===0)k.add(0,0,1,1);else for(let E=0,H=B.spatialIndexCoords.length;E<H;E+=4)k.add(B.spatialIndexCoords[E],B.spatialIndexCoords[E+1],B.spatialIndexCoords[E+2],B.spatialIndexCoords[E+3]);return k.finish(),{flatbush:k.data,items:B.spatialIndex,samples:d}}var co=class extends ru.FeatureRendererType{getExpandedRegion(t){let{start:o,end:r}=t,a=1;return{...t,start:Math.floor(Math.max(o-a,0)),end:Math.ceil(r+a)}}async render(t){let{statusCallback:o=()=>{},regions:r,bpPerPx:a,samples:f,rowHeight:n}=t,l=r[0],d=f.length*n+100,s=(l.end-l.start)/a,u=await this.getFeatures(t),i=await(0,wr.updateStatus)("Rendering alignment",o,()=>(0,wr.renderToAbstractCanvas)(s,d,t,m=>ou({ctx:m,renderArgs:{...t,features:u}})));return{...await super.render({...t,...i,width:s,height:d}),...i,features:new Map,width:s,height:d,containsNoTransferables:!0}}};var we=A(Q()),au=A(Fe());var fu=A(re()),Qx=(0,fu.observer)(function(e){let{items:t,displayModel:o,height:r,samples:a,flatbush:f}=e,n=(0,we.useRef)(null),l=(0,we.useMemo)(()=>ot.from(f),[f]),[d,s]=(0,we.useState)(!1),u=(0,we.useCallback)((i,p)=>{let m=0,h=0;if(n.current){let C=n.current.getBoundingClientRect();m=i-C.left,h=p-C.top}let c=l.search(m,h,m+1,h+1);if(c.length===0)return;let T=c.find(C=>t[C]?.isInsertion)??c[0],g=T!==void 0?t[T]:void 0;if(!g)return;let x=a[g.rowIndex];return{...g,sampleId:x?.id??"unknown",sampleLabel:x?.label||x?.id||"unknown"}},[l,t,a]);return we.default.createElement("div",{ref:n,onClick:i=>{let p=u(i.clientX,i.clientY);p?.isInsertion&&o.showInsertionSequenceDialog?.({sequence:p.base,sampleLabel:p.sampleLabel,chr:p.chr,pos:p.pos})},onMouseMove:i=>{let p=u(i.clientX,i.clientY);o.setHoveredInfo?.(p),o.setHighlightedRowNames?.(p?.sampleId?[p.sampleId]:void 0),s(!!p?.isInsertion)},onMouseLeave:()=>{o.setHoveredInfo?.(void 0),o.setHighlightedRowNames?.(void 0),s(!1)},style:{overflow:"visible",position:"relative",height:r,cursor:d?"pointer":"default"}},we.default.createElement(au.PrerenderedCanvas,{...e,style:{position:"absolute",left:0}}))}),nu=Qx;var lu=A(He());var Fx=(0,lu.ConfigurationSchema)("LinearMafRenderer",{},{explicitlyTyped:!0}),du=Fx;function Ga(e){e.addRendererType(()=>new co({name:"LinearMafRenderer",ReactComponent:nu,configSchema:du,pluginManager:e}))}var iu=A(Le()),pu=A(Te());var b=A(Q()),ke=A(Fe()),Ft=A(X()),su=A(Te()),L=A(We()),uu=A(De()),Dx=(0,uu.makeStyles)()(e=>({textbox:{width:"100%"},paper:{margin:e.spacing(),padding:e.spacing()},submit:{marginTop:25,marginBottom:100,display:"block"}}));function _a({model:e}){let{classes:t}=Dx(),[o,r]=(0,b.useState)(""),[a,f]=(0,b.useState)(),[n,l]=(0,b.useState)(),[d,s]=(0,b.useState)(),[u,i]=(0,b.useState)(),[p,m]=(0,b.useState)("MAF track"),[h,c]=(0,b.useState)("BigMafAdapter"),[w,T]=(0,b.useState)("TBI"),g=(0,su.getRoot)(e);return b.default.createElement(L.Paper,{className:t.paper},b.default.createElement(L.Paper,null,u?b.default.createElement(ke.ErrorMessage,{error:u}):null,b.default.createElement(L.FormControl,null,b.default.createElement(L.FormLabel,null,"File type"),b.default.createElement(L.RadioGroup,{value:h,onChange:x=>{c(x.target.value)}},["BigMafAdapter","MafTabixAdapter"].map(x=>b.default.createElement(L.FormControlLabel,{key:x,value:x,control:b.default.createElement(L.Radio,null),checked:h===x,label:x})))),h==="BigMafAdapter"?b.default.createElement(ke.FileSelector,{location:a,name:"Path to bigMaf",rootModel:g,setLocation:x=>{f(x)}}):h==="MafTabixAdapter"?b.default.createElement(b.default.Fragment,null,b.default.createElement(L.FormControl,null,b.default.createElement(L.FormLabel,null,"Index type"),b.default.createElement(L.RadioGroup,{value:h,onChange:x=>{T(x.target.value)}},["TBI","CSI"].map(x=>b.default.createElement(L.FormControlLabel,{key:x,value:x,control:b.default.createElement(L.Radio,null),checked:w===x,label:x})))),b.default.createElement(ke.FileSelector,{location:a,name:"Path to MAF tabix",rootModel:g,setLocation:x=>{f(x)}}),b.default.createElement(ke.FileSelector,{location:n,name:"Path to MAF tabix index",rootModel:g,setLocation:x=>{l(x)}})):b.default.createElement(b.default.Fragment,null,b.default.createElement(ke.FileSelector,{location:a,name:"Path to TAF.gz (Bgzipped TAF)",rootModel:g,setLocation:x=>{f(x)}}),b.default.createElement(ke.FileSelector,{location:n,name:"Path to TAF.gz.tai (TAF index)",rootModel:g,setLocation:x=>{l(x)}}))),b.default.createElement("div",null,b.default.createElement(ke.FileSelector,{location:d,name:"Path to newick tree (.nh)",rootModel:g,setLocation:x=>{s(x)}}),b.default.createElement(L.TextField,{multiline:!0,rows:10,value:o,onChange:x=>{r(x.target.value)},helperText:"Sample names (optional if .nh supplied, required if not)",placeholder:"Enter sample names from the MAF file, one per line, or JSON formatted array of samples",variant:"outlined",fullWidth:!0})),b.default.createElement(L.TextField,{value:p,helperText:"Track name",onChange:x=>{m(x.target.value)}}),b.default.createElement(L.Button,{variant:"contained",className:t.submit,onClick:()=>{try{let x=(0,Ft.getSession)(e),C=[];try{C=JSON.parse(o)}catch{C=o.split(/\n|\r\n|\r/)}let y=[`${p.toLowerCase().replaceAll(" ","_")}-${Date.now()}`,x.adminMode?"":"-sessionTrack"].join("");(0,Ft.isSessionWithAddTracks)(x)&&(x.addTrackConf({trackId:y,type:"MafTrack",name:p,assemblyNames:[e.assembly],adapter:h==="BigMafAdapter"?{type:h,bigBedLocation:a,samples:C,nhLocation:d}:h==="MafTabixAdapter"?{type:h,bedGzLocation:a,nhLocation:d,index:{indexType:w,location:n},samples:C}:{type:h,tafGzLocation:a,taiLocation:n,nhLocation:d,samples:C}}),e.view?.showTrack(y)),e.clearData(),(0,Ft.isSessionModelWithWidgets)(x)&&x.hideWidget(e)}catch(x){i(x)}}},"Submit"))}function Ua(e){e.addAddTrackWorkflowType(()=>new iu.AddTrackWorkflowType({name:"MAF track",ReactComponent:_a,stateModel:pu.types.model({})}))}var Rf=A(Q(),1);var at={};at.d=(e,t)=>{for(var o in t)at.o(t,o)&&!at.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})};at.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);at.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var Au={};at.r(Au);at.d(Au,{ChunkSliceResult:()=>vt,DecompressResult:()=>kt,__wbg_Error_8c4e43fe74559d73:()=>Px,__wbg___wbindgen_throw_be289d5034ed271b:()=>Lx,__wbg_set_wasm:()=>Jx,decompress_all:()=>vx,decompress_block:()=>kx,decompress_chunk_slice:()=>Mx});var vt=class e{static __wrap(t){t=t>>>0;let o=Object.create(e.prototype);return o.__wbg_ptr=t,mu.register(o,o.__wbg_ptr,o),o}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,mu.unregister(this),t}free(){let t=this.__destroy_into_raw();O.__wbg_chunksliceresult_free(t,0)}get buffer(){try{let a=O.__wbindgen_add_to_stack_pointer(-16);O.chunksliceresult_buffer(a,this.__wbg_ptr);var t=K().getInt32(a+0,!0),o=K().getInt32(a+4,!0),r=Va(t,o).slice();return O.__wbindgen_export(t,o*1,1),r}finally{O.__wbindgen_add_to_stack_pointer(16)}}get cpositions(){try{let a=O.__wbindgen_add_to_stack_pointer(-16);O.chunksliceresult_cpositions(a,this.__wbg_ptr);var t=K().getInt32(a+0,!0),o=K().getInt32(a+4,!0),r=cu(t,o).slice();return O.__wbindgen_export(t,o*8,8),r}finally{O.__wbindgen_add_to_stack_pointer(16)}}get dpositions(){try{let a=O.__wbindgen_add_to_stack_pointer(-16);O.chunksliceresult_dpositions(a,this.__wbg_ptr);var t=K().getInt32(a+0,!0),o=K().getInt32(a+4,!0),r=cu(t,o).slice();return O.__wbindgen_export(t,o*8,8),r}finally{O.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(vt.prototype[Symbol.dispose]=vt.prototype.free);var kt=class e{static __wrap(t){t=t>>>0;let o=Object.create(e.prototype);return o.__wbg_ptr=t,xu.register(o,o.__wbg_ptr,o),o}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,xu.unregister(this),t}free(){let t=this.__destroy_into_raw();O.__wbg_decompressresult_free(t,0)}get bytes_read(){return O.decompressresult_bytes_read(this.__wbg_ptr)>>>0}get data(){try{let a=O.__wbindgen_add_to_stack_pointer(-16);O.decompressresult_data(a,this.__wbg_ptr);var t=K().getInt32(a+0,!0),o=K().getInt32(a+4,!0),r=Va(t,o).slice();return O.__wbindgen_export(t,o*1,1),r}finally{O.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(kt.prototype[Symbol.dispose]=kt.prototype.free);function vx(e){try{let n=O.__wbindgen_add_to_stack_pointer(-16),l=Ya(e,O.__wbindgen_export2),d=Br;O.decompress_all(n,l,d);var t=K().getInt32(n+0,!0),o=K().getInt32(n+4,!0),r=K().getInt32(n+8,!0),a=K().getInt32(n+12,!0);if(a)throw qa(r);var f=Va(t,o).slice();return O.__wbindgen_export(t,o*1,1),f}finally{O.__wbindgen_add_to_stack_pointer(16)}}function kx(e){try{let a=O.__wbindgen_add_to_stack_pointer(-16),f=Ya(e,O.__wbindgen_export2),n=Br;O.decompress_block(a,f,n);var t=K().getInt32(a+0,!0),o=K().getInt32(a+4,!0),r=K().getInt32(a+8,!0);if(r)throw qa(o);return kt.__wrap(t)}finally{O.__wbindgen_add_to_stack_pointer(16)}}function Mx(e,t,o,r,a){try{let d=O.__wbindgen_add_to_stack_pointer(-16),s=Ya(e,O.__wbindgen_export2),u=Br;O.decompress_chunk_slice(d,s,u,t,o,r,a);var f=K().getInt32(d+0,!0),n=K().getInt32(d+4,!0),l=K().getInt32(d+8,!0);if(l)throw qa(n);return vt.__wrap(f)}finally{O.__wbindgen_add_to_stack_pointer(16)}}function Px(e,t){let o=Error(hu(e,t));return Nx(o)}function Lx(e,t){throw new Error(hu(e,t))}var mu=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>O.__wbg_chunksliceresult_free(e>>>0,1)),xu=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>O.__wbg_decompressresult_free(e>>>0,1));function Nx(e){Ao===Me.length&&Me.push(Me.length+1);let t=Ao;return Ao=Me[t],Me[t]=e,t}function Hx(e){e<132||(Me[e]=Ao,Ao=e)}function cu(e,t){return e=e>>>0,Wx().subarray(e/8,e/8+t)}function Va(e,t){return e=e>>>0,Ka().subarray(e/1,e/1+t)}var Dt=null;function K(){return(Dt===null||Dt.buffer.detached===!0||Dt.buffer.detached===void 0&&Dt.buffer!==O.memory.buffer)&&(Dt=new DataView(O.memory.buffer)),Dt}var Cr=null;function Wx(){return(Cr===null||Cr.byteLength===0)&&(Cr=new Float64Array(O.memory.buffer)),Cr}function hu(e,t){return e=e>>>0,Ux(e,t)}var Rr=null;function Ka(){return(Rr===null||Rr.byteLength===0)&&(Rr=new Uint8Array(O.memory.buffer)),Rr}function Gx(e){return Me[e]}var Me=new Array(128).fill(void 0);Me.push(void 0,null,!0,!1);var Ao=Me.length;function Ya(e,t){let o=t(e.length*1,1)>>>0;return Ka().set(e,o/1),Br=e.length,o}function qa(e){let t=Gx(e);return Hx(e),t}var yr=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});yr.decode();var _x=2146435072,Ja=0;function Ux(e,t){return Ja+=t,Ja>=_x&&(yr=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),yr.decode(),Ja=t),yr.decode(Ka().subarray(e,e+t))}var Br=0,O;function Jx(e){O=e}var be=A(Te(),1),wc=A(_o(),1),Cc=A(Su(),1);var Vx={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function wu(e){return Vx[e]}function Or(e,t,o){return Math.max(t,Math.min(o,e))}function Ce(e,t=0){let o=10**t;return Math.round(e*o)/o}function Cu(e){let t=/^#([0-9a-f]{3,8})$/i.exec(e);if(!t)return null;let o=t[1];return o.length===3?{r:parseInt(o[0]+o[0],16),g:parseInt(o[1]+o[1],16),b:parseInt(o[2]+o[2],16),a:1}:o.length===4?{r:parseInt(o[0]+o[0],16),g:parseInt(o[1]+o[1],16),b:parseInt(o[2]+o[2],16),a:parseInt(o[3]+o[3],16)/255}:o.length===6?{r:parseInt(o.slice(0,2),16),g:parseInt(o.slice(2,4),16),b:parseInt(o.slice(4,6),16),a:1}:o.length===8?{r:parseInt(o.slice(0,2),16),g:parseInt(o.slice(2,4),16),b:parseInt(o.slice(4,6),16),a:parseInt(o.slice(6,8),16)/255}:null}function Kx(e){let t=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([\d.]+)\s*)?\)$/i.exec(e);return t?{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10),a:t[4]?parseFloat(t[4]):1}:null}function Yx(e){let t=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%\s*(?:,\s*([\d.]+)\s*)?\)$/i.exec(e);if(t){let o=parseFloat(t[1]),r=parseFloat(t[2])/100,a=parseFloat(t[3])/100,f=t[4]?parseFloat(t[4]):1;return{...Er(o,r,a),a:f}}return null}function Er(e,t,o){e=(e%360+360)%360;let r=(1-Math.abs(2*o-1))*t,a=r*(1-Math.abs(e/60%2-1)),f=o-r/2,n=0,l=0,d=0;return e<60?(n=r,l=a):e<120?(n=a,l=r):e<180?(l=r,d=a):e<240?(l=a,d=r):e<300?(n=a,d=r):(n=r,d=a),{r:Math.round((n+f)*255),g:Math.round((l+f)*255),b:Math.round((d+f)*255)}}function Ir(e,t,o){e/=255,t/=255,o/=255;let r=Math.max(e,t,o),a=Math.min(e,t,o),f=(r+a)/2;if(r===a)return{h:0,s:0,l:f};let n=r-a,l=f>.5?n/(2-r-a):n/(r+a),d=0;return r===e?d=((t-o)/n+(t<o?6:0))/6:r===t?d=((o-e)/n+2)/6:d=((e-t)/n+4)/6,{h:d*360,s:l,l:f}}function ja(e){if(typeof e=="object"){let{h:n,s:l,l:d}=e;return{...Er(n,l/100,d/100),a:1}}let t=e.trim().toLowerCase(),o=wu(t);if(o)return Cu(o);if(t==="transparent")return{r:0,g:0,b:0,a:0};let r=Cu(t);if(r)return r;let a=Kx(t);if(a)return a;let f=Yx(t);return f||{r:0,g:0,b:0,a:1}}function ft(e){return Math.round(Or(e,0,255)).toString(16).padStart(2,"0")}function ho(e){return{alpha(o){return o===void 0?e.a:ho({...e,a:Or(o,0,1)})},toHex(){let{r:o,g:r,b:a,a:f}=e;return f<1?`#${ft(o)}${ft(r)}${ft(a)}${ft(f*255)}`:`#${ft(o)}${ft(r)}${ft(a)}`},toRgbString(){let{r:o,g:r,b:a,a:f}=e;return f<1?`rgba(${Math.round(o)}, ${Math.round(r)}, ${Math.round(a)}, ${Ce(f,3)})`:`rgb(${Math.round(o)}, ${Math.round(r)}, ${Math.round(a)})`},toHsl(){let{h:o,s:r,l:a}=Ir(e.r,e.g,e.b);return{h:Ce(o,1),s:Ce(r*100,1),l:Ce(a*100,1),a:e.a}},toHslString(){let{h:o,s:r,l:a}=Ir(e.r,e.g,e.b);return e.a<1?`hsla(${Ce(o,1)}, ${Ce(r*100,1)}%, ${Ce(a*100,1)}%, ${Ce(e.a,3)})`:`hsl(${Ce(o,1)}, ${Ce(r*100,1)}%, ${Ce(a*100,1)}%)`},mix(o,r=.5){let a=ja(typeof o=="string"?o:o.toHex()),f=e.r+(a.r-e.r)*r,n=e.g+(a.g-e.g)*r,l=e.b+(a.b-e.b)*r,d=e.a+(a.a-e.a)*r;return ho({r:f,g:n,b:l,a:d})},darken(o=.1){let{h:r,s:a,l:f}=Ir(e.r,e.g,e.b),n=Or(f-o,0,1),l=Er(r,a,n);return ho({...l,a:e.a})},lighten(o=.1){let{h:r,s:a,l:f}=Ir(e.r,e.g,e.b),n=Or(f+o,0,1),l=Er(r,a,n);return ho({...l,a:e.a})}}}function Ru(e){return ho(ja(e))}var Tc=A(Te(),1);var qx=/^-?(?:(?:[0-9]*\.[0-9]+)|[0-9]+)$/,yu=/^[a-zA-Z--_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF$][a-zA-Z--0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF$]*$/,jx=/\\\\/,zx=/^\s*$/,Xx=["`(?:[^`\\\\]|\\\\.)*`",String.raw`'(?:(?:\\')|[^'])*'`,String.raw`"(?:(?:\\")|[^"])*"`,String.raw`\s+`,String.raw`\btrue\b`,String.raw`\bfalse\b`],$x=["[a-zA-Z\u0430-\u044F\u0410-\u042F_\xC0-\xD6\xD8-\xF6\xF8-\xFF\\$][a-zA-Z0-9\u0430-\u044F\u0410-\u042F_\xC0-\xD6\xD8-\xF6\xF8-\xFF\\$]*",String.raw`(?:(?:[0-9]*\.[0-9]+)|[0-9]+)`],Zx=new Set(["binaryOp","unaryOp","openParen","openBracket","question","colon"]),za=class{constructor(t){this._escQuoteRegexCache=new Map,this._grammar=t}getElements(t){let o=this._getSplitRegex();return t.split(o).filter(Boolean)}getTokens(t){let o=[],r=!1;for(let a=0;a<t.length;a++)this._isWhitespace(t[a])?o.length&&(o[o.length-1].raw+=t[a]):t[a]==="-"&&this._isNegative(o)?r=!0:(r&&(t[a]="-"+t[a],r=!1),o.push(this._createToken(t[a])));return r&&o.push(this._createToken("-")),o}tokenize(t){let o=this.getElements(t);return this.getTokens(o)}_createToken(t){let o={type:"literal",value:t,raw:t};if(t.startsWith("`"))return o.type="templateString",o.value=this._parseTemplateString(t),o;if(t.startsWith('"')||t.startsWith("'"))o.value=this._unquote(t);else if(qx.exec(t))o.value=parseFloat(t);else if(t==="true"||t==="false")o.value=t==="true";else if(this._grammar.elements[t])o.type=this._grammar.elements[t].type;else if(yu.exec(t))o.type="identifier";else throw new Error(`Invalid expression token: ${t}`);return o}_escapeRegExp(t){return t=t.replaceAll(/[.*+?^${}()|[\]\\]/g,String.raw`\$&`),yu.exec(t)&&(t=String.raw`\b`+t+String.raw`\b`),t}_getSplitRegex(){if(!this._splitRegex){let t=Object.keys(this._grammar.elements).sort((o,r)=>r.length-o.length).map(o=>this._escapeRegExp(o));this._splitRegex=new RegExp("("+[Xx.join("|"),t.join("|"),$x.join("|")].join("|")+")")}return this._splitRegex}_isNegative(t){return t.length?Zx.has(t[t.length-1].type):!0}_isWhitespace(t){return!!zx.exec(t)}_unquote(t){let o=t[0],r=this._escQuoteRegexCache.get(o);return r||(r=new RegExp("\\\\"+o,"g"),this._escQuoteRegexCache.set(o,r)),t.slice(1,-1).replace(r,o).replace(jx,"\\")}_parseTemplateString(t){let o=[],r=1,a=1;for(;r<t.length-1;){if(t[r]==="\\"){r+=2;continue}if(t[r]==="$"&&t[r+1]==="{"){r>a&&o.push({type:"static",value:t.slice(a,r)});let f=1,n=r+2;for(r+=2;r<t.length&&f>0;){if(t[r]==="\\"){r+=2;continue}t[r]==="{"&&f++,t[r]==="}"&&f--,r++}if(f!==0)throw new Error(`Unclosed interpolation in template string: ${t}`);o.push({type:"interpolation",value:t.slice(n,r-1)}),a=r}else r++}return r>a&&o.push({type:"static",value:t.slice(a,r)}),o}_unescapeTemplateString(t){return t.replaceAll("\\`","`").replaceAll(String.raw`\$`,"$").replaceAll("\\\\","\\")}},Xa=za;var $a={};st($a,{ArrayLiteral:()=>tc,AssignmentExpression:()=>pc,BinaryExpression:()=>oc,ConditionalExpression:()=>rc,FilterExpression:()=>ac,FunctionCall:()=>sc,Identifier:()=>fc,Literal:()=>nc,ObjectLiteral:()=>dc,SequenceExpression:()=>ic,TemplateLiteral:()=>lc,UnaryExpression:()=>uc});var ec={functions:"Jexl Function"};function tc(e){return this.evalArray(e.value)}function oc(e){let t=this._grammar.elements[e.operator];if(t.evalOnDemand){let a=f=>({eval:()=>this.eval(f)});return t.evalOnDemand(a(e.left),a(e.right))}let o=this.eval(e.left),r=this.eval(e.right);return t.eval(o,r)}function rc(e){let t=this.eval(e.test);return t?e.consequent?this.eval(e.consequent):t:this.eval(e.alternate)}function ac(e){let t=this.eval(e.subject);if(e.relative)throw new Error("Relative filter expressions are not supported");let o=this.eval(e.expr);return t?.[o]}function fc(e){if(!e.from)return(e.relative?this._relContext:this._context)[e.value];let t=this.eval(e.from);return t==null?void 0:(Array.isArray(t)?t[0]:t)?.[e.value]}function nc(e){return e.value}function lc(e){return e.parts.map(o=>{if(o.type==="static")return o.value;let r=this.eval(o.value);return r==null?"":String(r)}).join("")}function dc(e){return this.evalMap(e.value)}function sc(e){let t=ec[e.pool];if(!t)throw new Error(`Corrupt AST: Pool '${e.pool}' not found`);let r=this._grammar[e.pool]?.[e.name];if(!r)throw new Error(`${t} ${e.name} is not defined.`);let a=this.evalArray(e.args||[]);return r(...a)}function uc(e){let t=this.eval(e.right);return this._grammar.elements[e.operator].eval(t)}function ic(e){let t;for(let o of e.expressions)t=this.eval(o);return t}function pc(e){let t=this.eval(e.right),o=e.left.value;return this._context[o]=t,t}var Za=class{constructor(t,o,r){this._grammar=t,this._context=o||{},this._relContext=r||this._context}eval(t){return $a[t.type].call(this,t)}evalArray(t){return t.map(o=>this.eval(o))}evalMap(t){let o=Object.entries(t),r=o.map(([a,f])=>this.eval(f));return Object.fromEntries(o.map(([a],f)=>[a,r[f]]))}},Bu=Za;var Qr={};st(Qr,{argVal:()=>ef,arrayStart:()=>tf,arrayVal:()=>of,binaryOp:()=>mc,dot:()=>xc,filter:()=>rf,functionCall:()=>af,identifier:()=>cc,literal:()=>Ac,objKey:()=>br,objStart:()=>ff,objVal:()=>nf,semicolon:()=>pf,subExpression:()=>lf,templateString:()=>hc,ternaryEnd:()=>df,ternaryMid:()=>sf,ternaryStart:()=>Mt,transform:()=>uf,unaryOp:()=>gc});function ef(e){e&&this._cursor.args.push(e)}function tf(){this._placeAtCursor({type:"ArrayLiteral",value:[]})}function of(e){e&&this._cursor.value.push(e)}function mc(e){if(e.value==="="){if(this._cursor?.type!=="Identifier")throw new Error("Left side of assignment must be a variable name");let a={type:"AssignmentExpression",operator:"=",left:this._cursor};this._cursor=this._cursor._parent,this._placeAtCursor(a);return}let t=this._grammar.elements[e.value].precedence||0,o=this._cursor?._parent;for(;o&&o.operator&&this._grammar.elements[o.operator].precedence>=t;)this._cursor=o,o=o._parent;let r={type:"BinaryExpression",operator:e.value,left:this._cursor};this._setParent(this._cursor,r),this._cursor=o,this._placeAtCursor(r)}function xc(){let e=t=>t.type==="BinaryExpression"&&t.right;this._nextIdentEncapsulate=this._cursor&&this._cursor.type!=="UnaryExpression"&&(this._cursor.type!=="BinaryExpression"||e(this._cursor)),this._nextIdentRelative=!this._cursor||!this._nextIdentEncapsulate,this._nextIdentRelative&&(this._relative=!0)}function rf(e){this._placeBeforeCursor({type:"FilterExpression",expr:e,relative:this._subParser.isRelative(),subject:this._cursor})}function af(){this._placeBeforeCursor({type:"FunctionCall",name:this._cursor.value,args:[],pool:"functions"})}function cc(e){let t={type:"Identifier",value:e.value};this._nextIdentEncapsulate?(t.from=this._cursor,this._placeBeforeCursor(t),this._nextIdentEncapsulate=!1):(this._nextIdentRelative&&(t.relative=!0,this._nextIdentRelative=!1),this._placeAtCursor(t))}function Ac(e){this._placeAtCursor({type:"Literal",value:e.value})}function hc(e){let t=[];for(let o of e.value)if(o.type==="static")t.push({type:"static",value:this._lexer._unescapeTemplateString(o.value)});else{let r=this._lexer.tokenize(o.value),a=new this.constructor(this._grammar,this._lexer);a.addTokens(r);let f=a.complete();if(!f)throw new Error("Empty interpolation in template string");t.push({type:"expression",value:f})}this._placeAtCursor({type:"TemplateLiteral",parts:t})}function br(e){this._curObjKey=e.value}function ff(){this._placeAtCursor({type:"ObjectLiteral",value:{}})}function nf(e){this._cursor.value[this._curObjKey]=e}function lf(e){this._placeAtCursor(e)}function df(e){this._cursor.alternate=e}function sf(e){this._cursor.consequent=e}function Mt(){this._tree={type:"ConditionalExpression",test:this._tree},this._cursor=this._tree}function uf(e){this._placeBeforeCursor({type:"FunctionCall",name:e.value,args:[this._cursor],pool:"transforms"})}function gc(e){this._placeAtCursor({type:"UnaryExpression",operator:e.value})}function pf(){this._sequenceExpressions?this._sequenceExpressions.push(this._tree):this._sequenceExpressions=[this._tree],this._tree=null,this._cursor=null,this._state="expectOperand"}var go={expectOperand:{tokenTypes:{literal:{toState:"expectBinOp"},templateString:{toState:"expectBinOp"},identifier:{toState:"identifier"},unaryOp:{},openParen:{toState:"subExpression"},openCurl:{toState:"expectObjKey",handler:ff},dot:{toState:"traverse"},openBracket:{toState:"arrayVal",handler:tf}}},expectBinOp:{tokenTypes:{binaryOp:{toState:"expectOperand"},pipe:{toState:"expectTransform"},dot:{toState:"traverse"},question:{toState:"ternaryMid",handler:Mt},semicolon:{handler:pf}},completable:!0},expectTransform:{tokenTypes:{identifier:{toState:"postTransform",handler:uf}}},expectObjKey:{tokenTypes:{literal:{toState:"expectKeyValSep",handler:br},identifier:{toState:"expectKeyValSep",handler:br},closeCurl:{toState:"expectBinOp"}}},expectKeyValSep:{tokenTypes:{colon:{toState:"objVal"}}},postTransform:{tokenTypes:{openParen:{toState:"argVal"},binaryOp:{toState:"expectOperand"},dot:{toState:"traverse"},openBracket:{toState:"filter"},pipe:{toState:"expectTransform"},question:{toState:"ternaryMid",handler:Mt}},completable:!0},postArgs:{tokenTypes:{binaryOp:{toState:"expectOperand"},dot:{toState:"traverse"},openBracket:{toState:"filter"},pipe:{toState:"expectTransform"},question:{toState:"ternaryMid",handler:Mt}},completable:!0},identifier:{tokenTypes:{binaryOp:{toState:"expectOperand"},dot:{toState:"traverse"},openBracket:{toState:"filter"},openParen:{toState:"argVal",handler:af},pipe:{toState:"expectTransform"},question:{toState:"ternaryMid",handler:Mt}},completable:!0},traverse:{tokenTypes:{identifier:{toState:"identifier"}}},filter:{subHandler:rf,endStates:{closeBracket:"identifier"}},subExpression:{subHandler:lf,endStates:{closeParen:"expectBinOp"}},argVal:{subHandler:ef,endStates:{comma:"argVal",closeParen:"postArgs"}},objVal:{subHandler:nf,endStates:{comma:"expectObjKey",closeCurl:"expectBinOp"}},arrayVal:{subHandler:of,endStates:{comma:"arrayVal",closeBracket:"expectBinOp"}},ternaryMid:{subHandler:sf,endStates:{colon:"ternaryEnd"}},ternaryEnd:{subHandler:df,completable:!0}};var mf=class e{constructor(t,o,r,a){this._grammar=t,this._lexer=o,this._state="expectOperand",this._tree=null,this._exprStr=r||"",this._relative=!1,this._stopMap=a||{}}addToken(t){if(this._state==="complete")throw new Error("Cannot add a new token to a completed Parser");let o=go[this._state],r=this._exprStr;if(this._exprStr+=t.raw,o.subHandler){this._subParser||this._startSubExpression(r);let a=this._subParser.addToken(t);if(a){if(this._endSubExpression(),this._parentStop)return a;this._state=a}}else if(o.tokenTypes?.[t.type]){let a=o.tokenTypes[t.type],f=Qr[t.type];a.handler&&(f=a.handler),f&&f.call(this,t),a.toState&&(this._state=a.toState)}else{if(this._stopMap[t.type])return this._stopMap[t.type];throw new Error(`Token ${t.raw} (${t.type}) unexpected in expression: ${this._exprStr}`)}return!1}addTokens(t){t.forEach(o=>this.addToken(o))}complete(){if(this._cursor&&!go[this._state].completable)throw new Error(`Unexpected end of expression: ${this._exprStr}`);if(this._subParser&&this._endSubExpression(),this._sequenceExpressions){this._sequenceExpressions.push(this._tree);let t={type:"SequenceExpression",expressions:this._sequenceExpressions};return this._state="complete",t}return this._state="complete",this._cursor?this._tree:null}isRelative(){return this._relative}_endSubExpression(){go[this._state].subHandler.call(this,this._subParser.complete()),this._subParser=void 0}_placeAtCursor(t){this._cursor?(this._cursor.right=t,this._setParent(t,this._cursor)):this._tree=t,this._cursor=t}_placeBeforeCursor(t){this._cursor=this._cursor?._parent,this._placeAtCursor(t)}_setParent(t,o){Object.defineProperty(t,"_parent",{value:o,writable:!0})}_startSubExpression(t){let o=go[this._state].endStates;o||(this._parentStop=!0,o=this._stopMap),this._subParser=new e(this._grammar,this._lexer,t,o)}},Iu=mf;var xf=class{constructor(t,o){this._grammar=t,this._exprStr=o,this._ast=null}compile(){let t=new Xa(this._grammar),o=new Iu(this._grammar,t),r=t.tokenize(this._exprStr);return o.addTokens(r),this._ast=o.complete(),this}eval(t={}){let o=this._getAst();return new Bu(this._grammar,t).eval(o)}_getAst(){return this._ast||this.compile(),this._ast}},cf=xf;var Af=()=>({elements:{".":{type:"dot"},"[":{type:"openBracket"},"]":{type:"closeBracket"},"{":{type:"openCurl"},"}":{type:"closeCurl"},":":{type:"colon"},",":{type:"comma"},"(":{type:"openParen"},")":{type:"closeParen"},"?":{type:"question"},";":{type:"semicolon"},"+":{type:"binaryOp",precedence:30,eval:(e,t)=>e+t},"-":{type:"binaryOp",precedence:30,eval:(e,t)=>e-t},"*":{type:"binaryOp",precedence:40,eval:(e,t)=>e*t},"/":{type:"binaryOp",precedence:40,eval:(e,t)=>e/t},"//":{type:"binaryOp",precedence:40,eval:(e,t)=>Math.floor(e/t)},"%":{type:"binaryOp",precedence:50,eval:(e,t)=>e%t},"^":{type:"binaryOp",precedence:50,eval:(e,t)=>Math.pow(e,t)},"==":{type:"binaryOp",precedence:20,eval:(e,t)=>e==t},"!=":{type:"binaryOp",precedence:20,eval:(e,t)=>e!=t},">":{type:"binaryOp",precedence:20,eval:(e,t)=>e>t},">=":{type:"binaryOp",precedence:20,eval:(e,t)=>e>=t},"<":{type:"binaryOp",precedence:20,eval:(e,t)=>e<t},"<=":{type:"binaryOp",precedence:20,eval:(e,t)=>e<=t},"&&":{type:"binaryOp",precedence:10,evalOnDemand:(e,t)=>{let o=e.eval();return o&&t.eval()}},"||":{type:"binaryOp",precedence:10,evalOnDemand:(e,t)=>{let o=e.eval();return o||t.eval()}},in:{type:"binaryOp",precedence:20,eval:(e,t)=>typeof t=="string"||Array.isArray(t)?t.includes(e):!1},"!":{type:"unaryOp",precedence:1/0,eval:e=>!e},"=":{type:"binaryOp",precedence:2,eval:(e,t)=>{throw new Error("Assignment handled specially")}}},functions:{}});var Pt=class{constructor(){this._grammar=Af(),this.expr=this.expr.bind(this)}addBinaryOp(t,o,r,a){this._addGrammarElement(t,{type:"binaryOp",precedence:o,[a?"evalOnDemand":"eval"]:r})}addFunction(t,o){this._grammar.functions[t]=o}addFunctions(t){Object.assign(this._grammar.functions,t)}addUnaryOp(t,o){this._addGrammarElement(t,{type:"unaryOp",weight:1/0,eval:o})}compile(t){return this.createExpression(t).compile()}createExpression(t){return new cf(this._grammar,t)}getFunction(t){return this._grammar.functions[t]}eval(t,o={}){return this.createExpression(t).eval(o)}expr(t,...o){let r="";for(let a=0;a<t.length;a++)r+=t[a],a<o.length&&(r+=o[a]);return this.createExpression(r)}removeOp(t){let o=this._grammar.elements[t];o&&(o.type==="binaryOp"||o.type==="unaryOp")&&Reflect.deleteProperty(this._grammar.elements,t)}_addGrammarElement(t,o){this._grammar.elements[t]=o}},QR=new Pt;function hf(){let e=new Pt;return e.addFunction("get",(t,o)=>t.get(o)),e.addFunction("parent",t=>t.parent?.()),e.addFunction("id",t=>t.id()),e.addFunction("cast",t=>t),e.addFunction("log",t=>(console.log(t),t)),e.addFunction("max",Math.max),e.addFunction("min",Math.min),e.addFunction("sqrt",Math.sqrt),e.addFunction("ceil",Math.ceil),e.addFunction("floor",Math.floor),e.addFunction("round",Math.round),e.addFunction("abs",Math.abs),e.addFunction("log10",Math.log10),e.addFunction("parseInt",Number.parseInt),e.addFunction("parseFloat",Number.parseFloat),e.addFunction("split",(t,o)=>t.split(o)),e.addFunction("join",(t,...o)=>[...o].filter(r=>!!r).join(t)),e.addFunction("charAt",(t,o)=>t.charAt(o)),e.addFunction("charCodeAt",(t,o)=>t.charCodeAt(o)),e.addFunction("codePointAt",(t,o)=>t.codePointAt(o)),e.addFunction("includes",(t,o)=>t.includes(o)),e.addFunction("startsWith",(t,o,r)=>t.startsWith(o,r)),e.addFunction("endsWith",(t,o,r)=>t.endsWith(o,r)),e.addFunction("padEnd",(t,o,r)=>t.padEnd(o,r)),e.addFunction("padStart",(t,o,r)=>t.padStart(o,r)),e.addFunction("repeat",(t,o)=>t.repeat(o)),e.addFunction("replace",(t,o,r)=>t.replace(o,r)),e.addFunction("replaceAll",(t,o,r)=>t.replaceAll(o,r)),e.addFunction("slice",(t,o,r)=>t.slice(o,r)),e.addFunction("startsWith",(t,o,r)=>t.startsWith(o,r)),e.addFunction("substring",(t,o,r)=>t.substring(o,r)),e.addFunction("toLowerCase",t=>t.toLowerCase()),e.addFunction("toUpperCase",t=>t.toUpperCase()),e.addFunction("jsonParse",t=>JSON.parse(t)),e.addFunction("trim",t=>t.trim()),e.addFunction("trimEnd",t=>t.trimEnd()),e.addFunction("trimStart",t=>t.trimStart()),e.addFunction("getTag",(t,o)=>{let r=t.get("tags");return r?r[o]:t.get(o)}),e.addBinaryOp("&",15,(t,o)=>t&o),e}var gf={};function Ou(e,t){let o=`nosig|${e}`;if(!gf[o]){if(!e.startsWith("jexl:"))throw new Error("string does not appear to be in jexl format");let a=e.split("jexl:")[1],f=t?t.compile(a):hf().compile(a);gf[o]=f}return gf[o]}function Tf(e){return typeof e=="object"&&e!==null&&"findAppropriateInternetAccount"in e}function Sf(e){return typeof e=="object"&&e!==null&&"uri"in e&&!!e.uri}function wf(e){return typeof e=="object"&&e!==null&&"handleId"in e&&!!e.handleId}var Fr=class extends Error{message;internetAccountId;constructor(t,o){super(t),this.message=t,this.internetAccountId=o,this.name="RetryError"}};function Eu(e){return e instanceof Error&&(e.name==="AuthNeededError"||e.url!==void 0)}function bu(e){return typeof e=="object"&&e!==null&&"__rpcResult"in e&&e.__rpcResult}var Dr=A(Te(),1);var Qu={};function Cf(){return Qu}function Fu(e){Qu=e}var Sc={};function Du(e){return Sc[e]}var YR=180/Math.PI,qR=Math.PI/180;function Rc(e,t){if((0,be.isStateTreeNode)(t)&&!(0,be.isAlive)(t))return t;if(e?.[t.refName]){t=(0,be.isStateTreeNode)(t)?{...(0,be.getSnapshot)(t)}:{...t};let o=e[t.refName];if(o)return{...t,refName:o,originalRefName:t.refName}}return t}async function vu(e,t){let{regions:o=[],adapterConfig:r}=t;if(!t.sessionId)throw new Error("sessionId is required");let a=o.map(n=>n.assemblyName),f=Object.fromEntries(await Promise.all([...new Set(a)].map(async n=>[n,await e.getRefNameMapForAdapter(r,n,t)])));return{...t,regions:o.map((n,l)=>Rc(f[a[l]],n))}}var jR=/electron/i.test(typeof navigator<"u"?navigator.userAgent:"");var zR=typeof jest>"u"?typeof window<"u"&&window.requestIdleCallback?window.requestIdleCallback:e=>setTimeout(()=>{e()},1):e=>{e()};function yf(e){let t=0;if(e.length===0)return t;for(let o=0;o<e.length;o++){let r=e.charCodeAt(o);t=(t<<5)-t+r,t|=0}return t}function Bf(e,t="",o=5e3){let r=[e];for(;r.length;){let a=r.pop();for(let[f,n]of Object.entries(a)){if(t.length>o)return yf(t);typeof n=="object"&&n!==null?r.push(n):f==="locationType"&&n==="FileHandleLocation"?t+=`${f}-BlobLocation`:f==="handleId"?t+=`blobId-fh-blob-${n}`:t+=`${f}-${n}`}}return`adp-${yf(t)}`}function ku(e={}){return`${Bf(e)}`}var Mu={};async function yc(e,t,o){let r=o?.type;if(!r)throw new Error(`could not determine adapter type from adapter config snapshot ${JSON.stringify(o)}`);let a=e.getAdapterType(r);if(!a)throw new Error(`unknown data adapter type ${r}`);let f=a.configSchema.create(o,{pluginManager:e}),n=To.bind(null,e,t),l=await a.getAdapterClass();return{dataAdapter:new l(f,n,e),sessionIds:new Set([t])}}async function To(e,t,o){let r=ku(o);Mu[r]??=yc(e,t,o);let a=await Mu[r];return a.sessionIds.add(t),a}var So=class{name;maybeDisplayName;constructor(t){this.name=t?.name||"UNKNOWN",this.maybeDisplayName=t?.displayName}get displayName(){return this.maybeDisplayName||this.name}};var Bc=Symbol("mapObjectSkip"),Lu=e=>typeof e=="object"&&e!==null,Pu=e=>{if(!Lu(e)||e instanceof RegExp||e instanceof Error||e instanceof Date||e instanceof Map||e instanceof Set||e instanceof WeakMap||e instanceof WeakSet||e instanceof Promise||e instanceof ArrayBuffer||e instanceof DataView||ArrayBuffer.isView(e)||globalThis.Blob&&e instanceof globalThis.Blob)return!1;let t=e;return!(typeof t.$$typeof=="symbol"||typeof t.asymmetricMatch=="function")},Ic=(e,t)=>{if(t){let o=Object.keys(e),r=Object.getOwnPropertySymbols(e).filter(a=>Object.getOwnPropertyDescriptor(e,a)?.enumerable);return[...o,...r]}return Object.keys(e)},If=(e,t,o,r=new WeakMap)=>{let{target:a={},deep:f=!1,includeSymbols:n=!1}=o??{},l={deep:f,includeSymbols:n};if(r.has(e))return r.get(e);r.set(e,a);let d=s=>s.map(u=>Pu(u)?If(u,t,l,r):u);if(Array.isArray(e))return d(e);for(let s of Ic(e,l.includeSymbols)){let u=e[s],i=t(s,u,e);if(i===Bc)continue;if(!Array.isArray(i))throw new TypeError(`Mapper must return an array or mapObjectSkip, got ${i===null?"null":typeof i}`);if(i.length<2)throw new TypeError(`Mapper must return an array with at least 2 elements [key, value], got ${i.length} elements`);let[p,m,{shouldRecurse:h=!0}={}]=i;if(p!=="__proto__"){l.deep&&h&&Pu(m)&&(m=Array.isArray(m)?d(m):If(m,t,l,r));try{a[p]=m}catch(c){if(c instanceof TypeError&&c.message.includes("read only"))continue;throw c}}}return a};function Of(e,t,o){if(!Lu(e))throw new TypeError(`Expected an object, got \`${e}\` (${typeof e})`);if(Array.isArray(e))throw new TypeError("Expected an object, got an array");return If(e,(a,f)=>t(a,f,e),o)}function Oc(e,t,o=new WeakSet){let r=f=>{let n=Du(f.handleId);if(!n)throw new Error(`File not in cache for handleId: ${f.handleId}. The file "${f.name}" may need to be reopened.`);let l=`fh-blob-${f.handleId}`;return t[l]=n,{locationType:"BlobLocation",name:f.name,blobId:l}},a=f=>{if(!(!f||typeof f!="object"||o.has(f)))if(o.add(f),Array.isArray(f))for(let n=0;n<f.length;n++){let l=f[n];wf(l)?f[n]=r(l):a(l)}else{let n=f;for(let l of Object.keys(n)){let d=n[l];wf(d)?n[l]=r(d):a(d)}}};a(e)}var wo=class e extends So{pluginManager;constructor(t){super(),this.pluginManager=t}async serializeArguments(t,o){return await this.augmentLocationObjects(t,o),{...t,blobMap:Cf()}}async serializeNewAuthArguments(t,o){let r=this.pluginManager.rootModel;if(!Tf(r)||t.internetAccountPreAuthorization)return t;let a=r.findAppropriateInternetAccount(t);return a&&(t.internetAccountPreAuthorization=await a.getPreAuthorizationInformation(t)),t}async deserializeArguments(t,o){return t.blobMap&&Fu(t.blobMap),t}async executeDirect(t){}supportsDirectExecution(){return this.executeDirect!==e.prototype.executeDirect}async serializeReturn(t,o,r){return t}async deserializeReturn(t,o,r){let a;try{a=await t}catch(f){if(Eu(f)){let n=this.pluginManager.rootModel?.createEphemeralInternetAccount(`HTTPBasicInternetAccount-${new URL(f.url).origin}`,{},f.url);throw new Fr("Retrying with created internet account",n.internetAccountId)}throw f}return bu(a)?a.value:a}async augmentLocationObjects(t,o){let r=this.pluginManager.rootModel,a=[],f=Cf(),{renderingProps:n,...l}=t;if(Oc(l,f),Of(l,(d,s)=>{if(Sf(s)&&a.push(s),Array.isArray(s))for(let u of s)Sf(u)&&a.push(u);return[d,s]},{deep:!0}),Tf(r)&&r.internetAccounts.length===0)return t;for(let d of a)await this.serializeNewAuthArguments(d,o);return t}};var Co=class e{filterChain;constructor({filters:t,jexl:o}){this.filterChain=t.map(r=>r.trim()).filter(r=>!!r).map(r=>{if(typeof r=="string")return{expr:Ou(r,o),string:r};throw new Error(`invalid inputFilter string "${r}"`)})}passes(...t){for(let o of this.filterChain)if(!o.expr.eval({feature:t[0]}))return!1;return!0}toJSON(){return{filters:this.filterChain.map(t=>t.string)}}static fromJSON(t){return new e(t)}};var nt=class extends wo{async deserializeArguments(t,o){return{...await super.deserializeArguments(t,o),filters:t.filters?new Co({filters:t.filters,jexl:this.pluginManager.jexl}):void 0}}async serializeArguments(t,o){let a=this.pluginManager.rootModel?.session?.assemblyManager;if(!a)throw new Error("no assembly manager");let f=await vu(a,{...t,filters:t.filters?.toJSON().filters});return super.serializeArguments(f,o)}};var Ro=class extends nt{name="MafGetSamples";async execute(t,o){let r=this.pluginManager,a=await this.deserializeArguments(t,o),{regions:f,adapterConfig:n,sessionId:l}=a,{dataAdapter:d}=await To(r,l,n);return d.getSamples(f,a)}};function Ef(e){e.addRpcMethod(()=>new Ro(e))}function Nu({regions:e,showAllLetters:t,samples:o,features:r,includeInsertions:a}){let f=e[0],n=new Map(o.map((u,i)=>[u.id,i])),l=f.end-f.start,d=o.map(()=>new Array(l).fill("-")),s=new Map;for(let u of r.values()){let i=u.get("start"),p=u.get("alignments"),m=u.get("seq");for(let[h,c]of Object.entries(p)){let w=c.seq,T=n.get(h);if(T===void 0)continue;let g=d[T];for(let x=0,C=0,y=w.length;x<y;x++)if(m[x]!=="-"){let R=w[x],S=i+C-f.start;S>=0&&S<l&&(R==="-"?g[S]="-":R!==" "&&(t?g[S]=R:m[x]===R?g[S]=".":g[S]=R)),C++}else if(a){let R="";for(;x<w.length&&m[x]==="-";){let S=w[x];R+=S!=="-"&&S!==" "?S:"-",x++}if(x--,R.length>0){let S=i+C-f.start;if(S>=0&&S<=l){let B=s.get(S)||[];B.push({sequence:R,sampleIndex:T}),s.set(S,B)}}}}}return a&&s.size>0?Ec(d,s,o.length):d.map(u=>u.join(""))}function Ec(e,t,o){let r=[...t.keys()].sort((a,f)=>f-a);for(let a of r){let f=t.get(a),n=0;for(let d of f)d.sequence.length>n&&(n=d.sequence.length);let l=new Map;for(let d of f)l.set(d.sampleIndex,d.sequence);for(let d=0;d<o;d++){let s=e[d],u=l.get(d);if(u){let i=u.padEnd(n,"-");s.splice(a,0,...i.split(""))}else{let i=new Array(n).fill("-");s.splice(a,0,...i)}}}return e.map(a=>a.join(""))}var yo=class extends nt{name="MafGetSequences";async execute(t,o){let r=await this.deserializeArguments(t,o),{samples:a,regions:f,adapterConfig:n,sessionId:l,showAllLetters:d,includeInsertions:s}=r,u=(await To(this.pluginManager,l,n)).dataAdapter,i=await Xe(u.getFeatures(f[0],r).pipe($e()));return Nu({features:new Map(i.map(p=>[p.id(),p])),samples:a,regions:f,showAllLetters:d,includeInsertions:s})}};function bf(e){e.addRpcMethod(()=>new yo(e))}var Ni=A(Q()),Hi=A(Wu());var Vu=A(Q());var vr=A(Q()),Gu=A(X());var _u=A(re()),Uu=A(De()),bc=(0,Uu.makeStyles)()(e=>({highlight:{height:"100%",position:"absolute",background:Ru(e.palette.primary.main).alpha(.4).toRgbString(),borderLeft:`2px solid ${e.palette.primary.main}`,borderRight:`2px solid ${e.palette.primary.main}`,pointerEvents:"none",zIndex:10}})),Qc=(0,_u.observer)(function({model:t}){let{classes:o}=bc(),r=(0,Gu.getSession)(t),{assemblyManager:a}=r,f="widgets"in r?r.widgets:void 0;if(!f)return null;let n=[];for(let[,l]of f){let d=l;if(d.type==="MafSequenceWidget"&&d.connectedViewId===t.id){let s=l,{hoverHighlight:u}=s;if(u){let{refName:i,start:p,end:m,assemblyName:h}=u,w=a.get(h)?.getCanonicalRefName(i)??i,T=t.bpToPx({refName:w,coord:p}),g=t.bpToPx({refName:w,coord:m});if(T&&g){let x=Math.min(T.offsetPx,g.offsetPx)-t.offsetPx,C=Math.max(Math.abs(g.offsetPx-T.offsetPx),3);n.push(vr.default.createElement("div",{key:`maf-hover-${s.id}`,className:o.highlight,style:{left:x,width:C}}))}}}}return vr.default.createElement(vr.default.Fragment,null,n)}),Ju=Qc;function Qf(e){e.addToExtensionPoint("LinearGenomeView-TracksContainerComponent",(t,o)=>{let r=o.model;return[...t,Vu.default.createElement(Ju,{key:"maf-sequence-hover-highlight",model:r})]})}var Ku=A(He()),Yu=(0,Ku.ConfigurationSchema)("MafSequenceWidget",{});var Pe=A(Te());function qu(){return Pe.types.model("MafSequenceWidget",{id:Pe.types.identifier,type:Pe.types.literal("MafSequenceWidget"),adapterConfig:Pe.types.frozen(void 0),samples:Pe.types.frozen(void 0),regions:Pe.types.frozen(void 0),connectedViewId:Pe.types.maybe(Pe.types.string)}).volatile(()=>({hoverHighlight:void 0})).actions(e=>({setHoverHighlight(t){e.hoverHighlight=t}}))}function Vf(e){e.addWidgetType(()=>new Hi.default({name:"MafSequenceWidget",heading:"MAF Sequence",configSchema:Yu,stateModel:qu(),ReactComponent:(0,Ni.lazy)(()=>Promise.resolve().then(()=>(Li(),Pi)))})),Qf(e)}var Vi=A(Le());var Wi=A(Nr()),Wt=A(X()),Gi=A(Hr()),_i=A(Wr()),Ui=A(Te());var Io=class extends Wi.BaseFeatureDataAdapter{setupP;async setupPre(){if(!this.getSubAdapter)throw new Error("no getSubAdapter available");return{adapter:(await this.getSubAdapter({...(0,Ui.getSnapshot)(this.config),type:"BedTabixAdapter"})).dataAdapter}}async setupPre2(){return this.setupP||(this.setupP=this.setupPre().catch(t=>{throw this.setupP=void 0,t})),this.setupP}async setup(t){let{statusCallback:o=()=>{}}=t||{};return(0,Wt.updateStatus)("Downloading index",o,()=>this.setupPre2())}async getRefNames(t){let{adapter:o}=await this.setup(t);return o.getRefNames()}async getHeader(t){let{adapter:o}=await this.setup(t);return o.getHeader()}getFeatures(t,o){let{statusCallback:r=()=>{}}=o||{};return(0,_i.ObservableCreate)(async a=>{let{adapter:f}=await this.setup(o),n=await(0,Wt.updateStatus)("Downloading alignments",r,()=>Xe(f.getFeatures(t).pipe($e())));await(0,Wt.updateStatus)("Processing alignments",r,()=>{let l="",d=this.getConf("refAssemblyName");for(let s of n){let u=s.get("field5").split(","),i={},p=u.length;for(let m=0;m<p;m++){let c=u[m].split(":"),[w,T,g,x,C,y]=c;if(!w||!y)continue;let{assemblyName:R,chr:S}=gn(w);R&&(l||(l=R),i[R]={chr:S,start:+T,srcSize:+g,strand:x==="-"?-1:1,unknown:+C,seq:y})}a.next(new Wt.SimpleFeature({id:s.id(),data:{start:s.get("start"),end:s.get("end"),refName:s.get("refName"),name:s.get("name"),score:s.get("score"),alignments:i,seq:Sn(i,d,t.assemblyName,l)}}))}}),a.complete()})}async getSamples(t){let o=this.getConf("nhLocation"),r=o.uri==="/path/to/my.nh"?void 0:await(0,Gi.openLocation)(o).readFile("utf8");return{samples:mt(this.getConf("samples")),tree:r?Ut(r):void 0}}freeResources(){}};var Kf=A(He());var Nc=(0,Kf.ConfigurationSchema)("MafTabixAdapter",{samples:{type:"frozen",description:"string[] or {id:string,label:string,color?:string}[]",defaultValue:[]},bedGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz.tbi",locationType:"UriLocation"}},refAssemblyName:{type:"string",defaultValue:""},index:(0,Kf.ConfigurationSchema)("Index",{location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz.tbi"}},indexType:{type:"string",defaultValue:"TBI"}}),nhLocation:{type:"fileLocation",description:"newick tree",defaultValue:{uri:"/path/to/my.nh",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,...e.nhUri?{nhLocation:{uri:e.nhUri,baseUri:e.baseUri}}:{},bedGzLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.tbi`,baseUri:e.baseUri}}}:e}),Ji=Nc;function Yf(e){return e.addAdapterType(()=>new Vi.AdapterType({name:"MafTabixAdapter",AdapterClass:Io,configSchema:Ji}))}var Pr=A(Le());var Ki=A(He()),Yi=A(Le());function qf(e){return(0,Ki.ConfigurationSchema)("MafTrack",{},{baseConfiguration:(0,Yi.createBaseTrackConfig)(e),explicitIdentifier:"trackId"})}function jf(e){return e.addTrackType(()=>{let t=qf(e);return new Pr.TrackType({name:"MafTrack",configSchema:t,displayName:"MAF track",stateModel:(0,Pr.createBaseTrackModel)(e,"MafTrack",t)})})}var Lr=class extends qi.default{name="MafViewerPlugin";version=Zf;install(t){Xr(t),jf(t),Ma(t),Ga(t),Yf(t),Ua(t),bf(t),Ef(t),Vf(t)}configure(t){}};return ep(Hc);})();
/*! Bundled license information:

react-is/cjs/react-is.production.min.js:
  (** @license React v16.13.1
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
//# sourceMappingURL=jbrowse-plugin-mafviewer.umd.production.min.js.map
